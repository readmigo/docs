# åŒè¯­é˜…è¯»ç³»ç»Ÿæ¶æ„

## æ¦‚è¿°

æœ¬æ–‡æ¡£å…¨é¢æè¿° ReadMigo åŒè¯­é˜…è¯»ç³»ç»Ÿçš„æŠ€æœ¯æ¶æ„ã€æ•°æ®æµã€å®¢æˆ·ç«¯é›†æˆæ–¹æ¡ˆåŠè§„æ¨¡åŒ–åˆ†æã€‚

---

## ä¸€ã€ç³»ç»Ÿæ¶æ„

### 1.1 æ•´ä½“æ¶æ„

```mermaid
graph TB
    subgraph Processing["æ•°æ®å¤„ç†å±‚"]
        EN["EN EPUB<br>(åŸæ–‡)"]
        ZH["ZH EPUB<br>(è¯‘æœ¬)"]
        ECDICT["ECDICT<br>(è¯å…¸)"]
        BP["Bilingual Pipeline<br>EPUB Parser / Semantic Aligner<br>Tokenizer / Vocabulary Linker"]
        NLP["NLP Service<br>(SpaCy + Sentence Transformers)"]

        EN & ZH --> BP
        ECDICT --> BP
        BP --> NLP
    end

    subgraph Storage["æ•°æ®å­˜å‚¨å±‚"]
        PG["PostgreSQL (Neon)<br>BilingualBook -> BilingualParagraph -> ParagraphToken<br>BilingualBook -> Book -> Chapter<br>ParagraphToken -> Vocabulary"]
        R2S["Cloudflare R2<br>books/{book-id}/book.epub"]
    end

    subgraph APILayer["API å±‚"]
        API1["GET /books/:bookId/bilingual"]
        API2["GET /books/:bookId/bilingual/chapters/:order"]
        API3["GET /books/:bookId/bilingual/vocabulary"]
    end

    subgraph iOS["iOS å®¢æˆ·ç«¯"]
        Reader["BilingualReaderView<br>EN Paragraph / ZH Paragraph / Vocab Popup"]
        Engine["EPUB Reader Engine<br>ReadiumKit"]
    end

    Processing --> Storage --> APILayer --> iOS
```

### 1.2 æ•°æ®æµ

```mermaid
graph TB
    subgraph Step1["1. EPUB è§£æ"]
        EN_EPUB["EN.epub"] --> EN_P["è‹±æ–‡ç« èŠ‚/æ®µè½"]
        ZH_EPUB["ZH.epub"] --> ZH_P["ä¸­æ–‡ç« èŠ‚/æ®µè½"]
    end

    subgraph Step2["2. è¯­ä¹‰å¯¹é½ (Semantic Alignment)"]
        EN_P2["EN Paragraphs"] <-->|"Score: 0.85~0.92"| ZH_P2["ZH Paragraphs"]
    end

    subgraph Step3["3. åˆ†è¯ (Tokenization via SpaCy)"]
        Text["åŸæ–‡å¥å­"] --> Tokens["åˆ†è¯ç»“æœ<br>åœè¯ / è¯æ±‡ åˆ†ç±»"]
    end

    subgraph Step4["4. è¯æ±‡å…³è” (Vocabulary Linking)"]
        Token["Token"] --> Vocab["Vocabulary<br>word, phonetic<br>definition, definition_zh"]
    end

    subgraph Step5["5. æ•°æ®åº“å­˜å‚¨"]
        BP["BilingualParagraph"] --> PT["ParagraphToken"] --> V["Vocabulary"]
    end

    Step1 --> Step2 --> Step3 --> Step4 --> Step5
```

- å¯¹é½ç®—æ³•: paraphrase-multilingual-MiniLM-L12-v2
- å¯¹é½æ–¹æ³•: ä½™å¼¦ç›¸ä¼¼åº¦ + è´ªå¿ƒåŒ¹é…

---

## äºŒã€iOS å®¢æˆ·ç«¯é›†æˆ

### 2.1 æ•°æ®è·å–ç­–ç•¥

```mermaid
graph TB
    Open["ç”¨æˆ·æ‰“å¼€ä¹¦ç±"]
    Open --> Meta["1. è·å–ä¹¦ç±å…ƒæ•°æ®<br>GET /books/:id/bilingual<br>è¿”å›: bilingualBookId, status, chapters"]
    Meta --> EPUB["2. åŠ è½½ EPUB (è‹±æ–‡åŸæ–‡)<br>Download from R2: books/{id}/book.epub<br>ReadiumKit è´Ÿè´£æ’ç‰ˆæ¸²æŸ“"]
    EPUB --> Chapter["3. æŒ‰éœ€åŠ è½½ç« èŠ‚åŒè¯­æ•°æ®<br>GET /books/:id/bilingual/chapters/:order<br>ç”¨æˆ·ç¿»åˆ°æ–°ç« èŠ‚æ—¶è§¦å‘<br>æ”¯æŒé¢„åŠ è½½ä¸‹ä¸€ç« "]
    Chapter --> Cache["4. æœ¬åœ°ç¼“å­˜<br>ç« èŠ‚æ•°æ®ç¼“å­˜åˆ° CoreData<br>è¯æ±‡æ•°æ®å…¨å±€ç¼“å­˜<br>æ”¯æŒç¦»çº¿é˜…è¯»"]
```

### 2.2 API å“åº”æ•°æ®ç»“æ„

```
GET /books/:bookId/bilingual/chapters/:order å“åº”:

{
  "chapter": {
    "order": 2,
    "title": "Chapter II",
    "originalTitle": "Father and Son"
  },
  "paragraphs": [
    {
      "paragraphOrder": 1,
      "originalText": "On the 24th of February, 1815...",
      "translatedText": "1815å¹´2æœˆ24æ—¥...",
      "tokens": [
        {
          "text": "On",
          "tokenOrder": 1,
          "tokenType": "WORD",
          "isStopWord": true,
          "vocabularyId": null
        },
        {
          "text": "the",
          "tokenOrder": 2,
          "tokenType": "WORD",
          "isStopWord": true,
          "vocabularyId": null
        },
        {
          "text": "February",
          "tokenOrder": 5,
          "tokenType": "WORD",
          "isStopWord": false,
          "vocabularyId": "vocab-123"
        }
      ]
    }
  ],
  "vocabularyMap": {
    "vocab-123": {
      "word": "February",
      "phonetic": "/Ëˆfebrueri/",
      "definition": "the second month of the year",
      "definitionZh": "äºŒæœˆ"
    }
  }
}
```

### 2.3 ä¸ EPUB åŸæ–‡é…åˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  EPUB + åŒè¯­æ•°æ®åä½œ                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      é˜…è¯»å™¨ç•Œé¢                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                          â”‚                                  â”‚
â”‚    è‹±æ–‡åŸæ–‡ (EPUB)       â”‚     ä¸­æ–‡è¯‘æ–‡ (API)               â”‚
â”‚    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”‚
â”‚                          â”‚                                  â”‚
â”‚    Rendered by           â”‚     Rendered by                  â”‚
â”‚    ReadiumKit            â”‚     SwiftUI                      â”‚
â”‚                          â”‚                                  â”‚
â”‚    On the 24th of        â”‚     1815å¹´2æœˆ24æ—¥ï¼Œ              â”‚
â”‚    [February], 1815,     â”‚     åœ£æ¯å±±ä¸Šçš„ç­æœ›å°             â”‚
â”‚    the [look-out] of     â”‚     å‘å‡ºä¿¡å·...                  â”‚
â”‚    Notre-Dame de la      â”‚                                  â”‚
â”‚    Garde [signalled]...  â”‚                                  â”‚
â”‚         â†“                â”‚                                  â”‚
â”‚    ç‚¹å‡»å•è¯å¼¹å‡ºé‡Šä¹‰       â”‚                                  â”‚
â”‚                          â”‚                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                       è¯æ±‡é‡Šä¹‰é¢æ¿                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  look-out  /ËˆlÊŠk.aÊŠt/                           ğŸ”Š     â”‚ â”‚
â”‚  â”‚  n. ç­æœ›å°ï¼Œè§‚å¯Ÿå“¨                                      â”‚ â”‚
â”‚  â”‚  n. ç­æœ›å‘˜ï¼Œæ”¾å“¨çš„äºº                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

åä½œæ–¹å¼:
â”œâ”€â”€ EPUB æä¾›: åŸæ–‡æ’ç‰ˆã€ç¿»é¡µã€è¿›åº¦å®šä½
â”œâ”€â”€ API æä¾›: ç¿»è¯‘ã€åˆ†è¯ã€è¯æ±‡æ•°æ®
â””â”€â”€ åŒæ­¥æœºåˆ¶: é€šè¿‡ç« èŠ‚ order åŒ¹é… EPUB ç« èŠ‚ä¸ API æ•°æ®
```

### 2.4 ç¿»è¯‘äº¤äº’æ”¯æŒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç”¨æˆ·äº¤äº’æµç¨‹                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. æ®µè½çº§ç¿»è¯‘æ˜¾ç¤º
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ æ˜¾ç¤ºæ¨¡å¼:                                   â”‚
   â”‚ â”œâ”€â”€ ä»…è‹±æ–‡ (é»˜è®¤)                           â”‚
   â”‚ â”œâ”€â”€ è‹±ä¸­å¯¹ç…§ (å·¦å³/ä¸Šä¸‹)                    â”‚
   â”‚ â””â”€â”€ ä»…ä¸­æ–‡                                  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. ç‚¹è¯æŸ¥ä¹‰
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ç”¨æˆ·ç‚¹å‡»å•è¯ "signalled"                    â”‚
   â”‚           â”‚                                â”‚
   â”‚           â–¼                                â”‚
   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
   â”‚ â”‚ signalled â†’ signal (è¯å…ƒè¿˜åŸ)        â”‚  â”‚
   â”‚ â”‚                                      â”‚  â”‚
   â”‚ â”‚ signal /ËˆsÉªÉ¡.nÉ™l/              ğŸ”Š   â”‚  â”‚
   â”‚ â”‚ v. å‘ä¿¡å·ï¼Œç¤ºæ„                      â”‚  â”‚
   â”‚ â”‚ n. ä¿¡å·ï¼Œæš—å·                        â”‚  â”‚
   â”‚ â”‚                                      â”‚  â”‚
   â”‚ â”‚ [æ·»åŠ åˆ°ç”Ÿè¯æœ¬] [å¤åˆ¶]                â”‚  â”‚
   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. ç”Ÿè¯æœ¬æ”¶è—
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ æ”¶è—å•è¯æ—¶ä¿å­˜:                             â”‚
   â”‚ â”œâ”€â”€ å•è¯åŸå½¢ (lemma)                       â”‚
   â”‚ â”œâ”€â”€ åŸæ–‡ä¸Šä¸‹æ–‡                             â”‚
   â”‚ â”œâ”€â”€ æ‰€åœ¨ä¹¦ç±/ç« èŠ‚                          â”‚
   â”‚ â””â”€â”€ æ”¶è—æ—¶é—´                               â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¸‰ã€æ•°æ®åº“å­˜å‚¨

### 3.1 æ•°æ®æ¨¡å‹å…³ç³»

```mermaid
erDiagram
    Book ||--|| BilingualBook : "1:1"
    Book ||--o{ Chapter : "1:N"
    BilingualBook ||--o{ BilingualParagraph : "1:N"
    BilingualParagraph ||--o{ ParagraphToken : "1:N"
    ParagraphToken }o--|| Vocabulary : "N:1"
    Chapter }o--|| Vocabulary : "references"
```

### 3.2 è¡¨ç»“æ„

| è¡¨å | ä¸»è¦å­—æ®µ | è¯´æ˜ |
|------|----------|------|
| BilingualBook | id, englishBookId, status, dataVersion | åŒè¯­ä¹¦ç±å…ƒæ•°æ® |
| BilingualParagraph | id, bilingualBookId, chapterId, originalText, translatedText, alignmentScore | å¯¹é½çš„æ®µè½ |
| ParagraphToken | id, paragraphId, text, lemma, pos, isStopWord, vocabularyId | åˆ†è¯ç»“æœ |
| Vocabulary | id, word, phonetic, definition, definitionZh, frequencyRank | è¯æ±‡è¡¨ |

### 3.3 æ•°æ®ç¤ºä¾‹

**BilingualParagraph ç¤ºä¾‹:**

| å­—æ®µ | å€¼ |
|------|-----|
| id | `bp_001` |
| bilingualBookId | `bb_monte_cristo` |
| chapterId | `ch_002` |
| chapterOrder | 2 |
| paragraphOrder | 1 |
| originalText | `On the 24th of February, 1815, the look-out of Notre-Dame de la Garde signalled the three-master, the Pharaon, from Smyrna, Trieste, and Naples.` |
| translatedText | `1815å¹´2æœˆ24æ—¥ï¼Œåœ£æ¯å±±ä¸Šçš„ç­æœ›å°å‘å‡ºä¿¡å·ï¼Œä¸‰æ¡…å¸†èˆ¹æ³•è€å·ä»å£«éº¦æ‹¿ã€çš„é‡Œé›…æ–¯ç‰¹å’Œé‚£ä¸å‹’æ–¯é©¶æ¥ã€‚` |
| alignmentScore | 0.72 |
| alignmentMethod | `semantic` |

**ParagraphToken ç¤ºä¾‹:**

| å­—æ®µ | å€¼ |
|------|-----|
| id | `pt_001` |
| paragraphId | `bp_001` |
| tokenOrder | 10 |
| text | `look-out` |
| startOffset | 42 |
| endOffset | 50 |
| tokenType | `WORD` |
| lemma | `look-out` |
| pos | `NOUN` |
| isStopWord | false |
| vocabularyId | `vocab_lookout` |

**Vocabulary ç¤ºä¾‹:**

| å­—æ®µ | å€¼ |
|------|-----|
| id | `vocab_lookout` |
| word | `look-out` |
| phonetic | `/ËˆlÊŠk.aÊŠt/` |
| partOfSpeech | `n.` |
| definition | `a place from which to watch for danger` |
| definitionZh | `ç­æœ›å°ï¼Œè§‚å¯Ÿå“¨` |
| frequencyRank | 15234 |
| cefrLevel | `B2` |
| source | `ecdict` |

---

## å››ã€å­˜å‚¨ç©ºé—´åˆ†æ

### 4.1 å•ä¹¦æ•°æ®é‡ (ä»¥ã€ŠåŸºç£å±±ä¼¯çˆµã€‹ä¸ºä¾‹)

| æ•°æ®é¡¹ | æ•°é‡ | å¹³å‡å¤§å° | æ€»å¤§å° |
|--------|------|----------|--------|
| ç« èŠ‚æ•° | 117 | - | - |
| BilingualParagraph | 14,679 | 500 bytes | 7.3 MB |
| ParagraphToken | 588,600 | 80 bytes | 47.1 MB |
| Vocabulary (å…³è”) | ~8,500 | 300 bytes | 2.5 MB |
| **æ•°æ®åº“æ€»è®¡** | - | - | **~57 MB** |

### 4.2 å¤„ç†æ—¶é—´

| é˜¶æ®µ | æ—¶é—´ |
|------|------|
| EPUB è§£æ | 5 ç§’ |
| è¯­ä¹‰å¯¹é½ | 20 åˆ†é’Ÿ |
| åˆ†è¯ (SpaCy) | 25 åˆ†é’Ÿ |
| è¯æ±‡å…³è” | 5 åˆ†é’Ÿ |
| æ•°æ®åº“å†™å…¥ (æ‰¹é‡ä¼˜åŒ–å) | 10 åˆ†é’Ÿ |
| **æ€»è®¡** | **~60 åˆ†é’Ÿ** |

### 4.3 API å“åº”å¤§å°

| æ¥å£ | å“åº”å¤§å° (Gzip) |
|------|-----------------|
| GET /bilingual (å…ƒæ•°æ®) | ~2 KB |
| GET /chapters/:order | 50-150 KB |
| GET /vocabulary?chapters=1,2,3 | 30-80 KB |

---

## äº”ã€10 ä¸‡æœ¬ä¹¦è§„æ¨¡åˆ†æ

### 5.1 å¯è¡Œæ€§è¯„ä¼°

| ç»´åº¦ | åˆ†æ | å¯è¡Œæ€§ |
|------|------|--------|
| **ä¸­æ–‡è¯‘æœ¬è·å–** | å…¬ç‰ˆä¹¦ä¸­æ–‡è¯‘æœ¬è¦†ç›–ç‡çº¦ 30-40% | éƒ¨åˆ†å¯è¡Œ |
| **å¤„ç†æ—¶é—´** | å•ä¹¦ 60 åˆ†é’Ÿ Ã— 100,000 = 6,944 å¤© (ä¸²è¡Œ) | éœ€å¹¶è¡Œ |
| **å­˜å‚¨æˆæœ¬** | 57 MB Ã— 100,000 = 5.7 TB | å¯æ§ |
| **API æ€§èƒ½** | æŒ‰ç« èŠ‚æ‡’åŠ è½½ï¼Œå•æ¬¡è¯·æ±‚ <200KB | å¯è¡Œ |

### 5.2 ä¸­æ–‡è¯‘æœ¬æ¥æºåˆ†æ

| æ¥æº | è¦†ç›–ç‡ | è´¨é‡ | ç‰ˆæƒé£é™© |
|------|--------|------|----------|
| å¥½è¯» (haodoo.net) | ~800 æœ¬ | é«˜ | éœ€éªŒè¯ |
| Gutenberg ä¸­æ–‡ç‰ˆ | ~50 æœ¬ | é«˜ | æ— é£é™© |
| AI ç¿»è¯‘ | 100% | ä¸­ç­‰ | æ— é£é™© |
| äººå·¥ç¿»è¯‘é‡‡è´­ | å¯é€‰ | æœ€é«˜ | éœ€æˆæƒ |

**æ¨èç­–ç•¥:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ä¸­æ–‡æ¥æºåˆ†å±‚ç­–ç•¥                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¼˜å…ˆçº§ 1: å¥½è¯»/Gutenberg ç°æœ‰è¯‘æœ¬
â”œâ”€â”€ è¦†ç›–: ~850 æœ¬
â”œâ”€â”€ ç‰¹ç‚¹: ç¿»è¯‘è´¨é‡é«˜ã€ç»è¿‡æ ¡å¯¹
â””â”€â”€ å¤„ç†: ç¹ç®€è½¬æ¢ + è´¨é‡æ£€æŸ¥

ä¼˜å…ˆçº§ 2: AI ç¿»è¯‘ (DeepL/GPT-4)
â”œâ”€â”€ è¦†ç›–: å‰©ä½™æ‰€æœ‰
â”œâ”€â”€ ç‰¹ç‚¹: æˆæœ¬å¯æ§ã€é€Ÿåº¦å¿«
â”œâ”€â”€ å¤„ç†: è‡ªåŠ¨ç¿»è¯‘ + äººå·¥æŠ½æ£€
â””â”€â”€ æˆæœ¬: ~$0.50/æœ¬ (çº¦ 50 ä¸‡å­—)

ä¼˜å…ˆçº§ 3: ä¸æä¾›åŒè¯­
â”œâ”€â”€ æ ‡è®°ä¸º "ä»…è‹±æ–‡"
â””â”€â”€ ç”¨æˆ·å¯ä½¿ç”¨å³æ—¶ç¿»è¯‘åŠŸèƒ½
```

### 5.3 å­˜å‚¨æˆæœ¬é¢„ä¼°

| è§„æ¨¡ | æ•°æ®åº“å­˜å‚¨ | Neon æˆæœ¬ | R2 æˆæœ¬ |
|------|------------|-----------|---------|
| 1,000 æœ¬ | 57 GB | $25/æœˆ | ~$5/æœˆ |
| 10,000 æœ¬ | 570 GB | $150/æœˆ | ~$50/æœˆ |
| 100,000 æœ¬ | 5.7 TB | $800/æœˆ | ~$500/æœˆ |

### 5.4 å¤„ç†æ€§èƒ½ä¼˜åŒ–

| ä¼˜åŒ–é¡¹ | æ•ˆæœ |
|--------|------|
| å¹¶è¡Œå¤„ç† (3 Worker) | å¤„ç†æ—¶é—´ Ã· 3 |
| æ‰¹é‡å†™å…¥ (BatchWriter) | æ•°æ®åº“å†™å…¥æé€Ÿ 10x |
| åµŒå…¥å‘é‡ç¼“å­˜ | è¯­ä¹‰å¯¹é½æé€Ÿ 2x |
| å…±äº«è¯æ±‡è¡¨ | å‡å°‘è¯æ±‡å¤„ç† 50% |

**å¤„ç†æ—¶é—´ä¼°ç®— (å¹¶è¡Œä¼˜åŒ–å):**

| è§„æ¨¡ | ä¸²è¡Œæ—¶é—´ | å¹¶è¡Œæ—¶é—´ (3 Worker) |
|------|----------|---------------------|
| 241 æœ¬ (å½“å‰) | 10 å¤© | 3.5 å¤© |
| 1,000 æœ¬ | 42 å¤© | 14 å¤© |
| 10,000 æœ¬ | 417 å¤© | 139 å¤© |
| 100,000 æœ¬ | 11.4 å¹´ | 3.8 å¹´ |

**å¤§è§„æ¨¡å¤„ç†å»ºè®®:**
- å¢åŠ  Worker æ•°é‡ (10-20 å¹¶è¡Œ)
- ä½¿ç”¨äº‘å‡½æ•°æŒ‰éœ€æ‰©å±•
- åˆ†æ‰¹å¤„ç†ï¼Œæ¯æ‰¹ 1,000 æœ¬

### 5.5 API æ€§èƒ½

| æŒ‡æ ‡ | å½“å‰è®¾è®¡ | 10 ä¸‡æœ¬æ—¶é¢„ä¼° |
|------|----------|---------------|
| æ•°æ®åº“æŸ¥è¯¢ | æŒ‰ç« èŠ‚ç´¢å¼• | æ— å˜åŒ– |
| ç¼“å­˜å‘½ä¸­ | Redis ç¼“å­˜çƒ­é—¨ä¹¦ | 95% å‘½ä¸­ |
| å†·å¯åŠ¨å»¶è¿Ÿ | 50-100ms | 100-200ms |
| è¯æ±‡è¡¨å¤§å° | 340 ä¸‡è¯ | 340 ä¸‡è¯ (å…±äº«) |

### 5.6 æˆæœ¬æ€»ç»“

| æˆæœ¬é¡¹ | 10 ä¸‡æœ¬ä¸€æ¬¡æ€§ | 10 ä¸‡æœ¬æœˆåº¦ |
|--------|---------------|-------------|
| å¤„ç†è®¡ç®— | ~$500 (äº‘æœåŠ¡å™¨) | - |
| AI ç¿»è¯‘ | ~$50,000 | - |
| æ•°æ®åº“å­˜å‚¨ | - | $800/æœˆ |
| R2 å­˜å‚¨ | - | $500/æœˆ |
| API æµé‡ | - | $200/æœˆ |
| **æ€»è®¡** | **~$50,500** | **~$1,500/æœˆ** |

---

## å…­ã€æŠ€æœ¯æ ˆæ¸…å•

| ç»„ä»¶ | æŠ€æœ¯é€‰å‹ | è¯´æ˜ |
|------|----------|------|
| EPUB è§£æ | epub.js (Node) | æå–ç« èŠ‚/æ®µè½ |
| è¯­ä¹‰å¯¹é½ | sentence-transformers | paraphrase-multilingual-MiniLM-L12-v2 |
| åˆ†è¯ | SpaCy | en_core_web_sm æ¨¡å‹ |
| è¯æ±‡è¡¨ | ECDICT | 340 ä¸‡è¯æ¡ |
| æ•°æ®åº“ | PostgreSQL (Neon) | äº‘æ‰˜ç®¡ |
| æ–‡ä»¶å­˜å‚¨ | Cloudflare R2 | EPUB åŸæ–‡ |
| API æ¡†æ¶ | NestJS | TypeScript |
| iOS å®¢æˆ·ç«¯ | SwiftUI + ReadiumKit | åŸç”Ÿå¼€å‘ |

---

## ä¸ƒã€ç›¸å…³æ–‡æ¡£

| æ–‡æ¡£ | è¯´æ˜ |
|------|------|
| [åŒè¯­é˜…è¯»æ•°æ®é¢„å¤„ç†åˆ†æ](../pipeline/bilingual-data-preprocessing.md) | æ•°æ®ç»“æ„è®¾è®¡ |
| [åŒè¯­æ®µè½è¯­ä¹‰å¯¹é½å®æˆ˜æŒ‡å—](../pipeline/bilingual-semantic-alignment.md) | å¯¹é½ç®—æ³•å®ç° |
| [åŒè¯­æ‰¹é‡å¤„ç†æ‰§è¡Œè®¡åˆ’](../pipeline/bilingual-batch-processing.md) | æ‰¹å¤„ç†æ–¹æ¡ˆ |
| [ç³»ç»Ÿæ¶æ„](./system-architecture.md) | æ•´ä½“ç³»ç»Ÿæ¶æ„ |
| [æ•°æ®åº“è®¾è®¡](../api/database-design.md) | æ•°æ®æ¨¡å‹ |

# 用户指南

## 快速入门

### 启动应用

1. 打开终端
2. 进入项目目录
3. 运行启动命令

| 环境 | 命令 |
|------|------|
| 本地开发 | `pnpm dev` |
| 调试环境 | `pnpm dev:debug` |
| 预发布 | `pnpm dev:staging` |
| 生产环境 | `pnpm dev:production` |

4. 访问 http://localhost:3001

## 主要功能

### 1. 书籍列表

```
┌──────────────────────────────────────────────────────────────────┐
│  书籍列表                                              [搜索...]  │
├──────────────────────────────────────────────────────────────────┤
│                                                                   │
│  状态筛选: [全部] [待校正] [校正中] [已完成]                      │
│                                                                   │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │ 📚 Pride and Prejudice                                      │ │
│  │    Jane Austen | 12 章节 | 120,000 字                       │ │
│  │    ⏳ 待校正                                    [开始校正]  │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                   │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │ 📚 1984                                                      │ │
│  │    George Orwell | 24 章节 | 88,000 字                      │ │
│  │    🔄 校正中 (50%)                               [继续校正] │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                   │
└──────────────────────────────────────────────────────────────────┘
```

**操作说明:**

| 操作 | 说明 |
|------|------|
| 搜索 | 输入书名或作者进行搜索 |
| 状态筛选 | 点击状态标签筛选书籍 |
| 开始校正 | 点击进入校正编辑器 |

### 2. 校正编辑器

```
┌─────────────────────────────────────────────────────────────────────────┐
│  ← Pride and Prejudice              进度: 2/12 章         [保存] [发布] │
├────────┬────────────────────────────────────────────┬───────────────────┤
│        │                                            │                   │
│ 章节   │  修复列表            HTML 编辑器          │   📱 预览        │
│ 列表   │                                            │                   │
│        │  ┌──────────────┐  ┌──────────────────┐  │  ┌─────────────┐  │
│ Ch 1 ✓ │  │ ✓ 清理空段落 │  │ <h2>Chapter 3    │  │  │ Chapter 3   │  │
│ Ch 2 ✓ │  │   Line 5     │  │ </h2>            │  │  │             │  │
│ Ch 3 ◐ │  │              │  │ <p>It is a       │  │  │ It is a     │  │
│ Ch 4   │  └──────────────┘  │ truth...         │  │  │ truth...    │  │
│ Ch 5   │                    │                  │  │  │             │  │
│ ...    │  ┌──────────────┐  └──────────────────┘  │  └─────────────┘  │
│        │  │ ⚠ 合并段落   │                        │                   │
│        │  │   Line 15    │                        │  主题: ◐ ◑ ◒      │
│        │  │              │                        │                   │
│        │  │ [确认][回滚] │                        │                   │
│        │  └──────────────┘                        │                   │
│        │                                            │                   │
└────────┴────────────────────────────────────────────┴───────────────────┘
```

**界面说明:**

| 区域 | 功能 |
|------|------|
| 章节列表 | 显示所有章节，点击切换 |
| 修复列表 | 显示该章节的所有修复项 |
| HTML 编辑器 | 编辑章节内容 |
| 预览 | 模拟手机显示效果 |

**修复项状态:**

| 标识 | 状态 | 说明 |
|------|------|------|
| ✓ 绿色 | 自动应用 | 系统自动应用的高置信度修复 |
| ⚠ 黄色 | 待确认 | 需要人工确认的修复 |
| 💡 蓝色 | 建议 | 低置信度建议，供参考 |
| ✎ 紫色 | 手动修复 | 人工添加的修复 |

**修复操作:**

| 操作 | 说明 |
|------|------|
| 确认 | 接受修复，应用到内容 |
| 回滚 | 撤销修复，恢复原内容 |
| 编辑 | 修改修复内容 |
| 展开 | 查看修复详情 |

### 3. 手机预览

```
┌─────────────────────────────────────┐
│          📱 预览                    │
├─────────────────────────────────────┤
│                                     │
│  ┌─────────────────────────────┐   │
│  │  ╭───────────────────────╮  │   │
│  │  │                       │  │   │
│  │  │    Chapter 3          │  │   │
│  │  │                       │  │   │
│  │  │    It is a truth      │  │   │
│  │  │    universally        │  │   │
│  │  │    acknowledged...    │  │   │
│  │  │                       │  │   │
│  │  │                       │  │   │
│  │  ╰───────────────────────╯  │   │
│  └─────────────────────────────┘   │
│                                     │
│  主题切换: [亮色] [护眼] [暗色]     │
│                                     │
└─────────────────────────────────────┘
```

**主题说明:**

| 主题 | 特点 |
|------|------|
| 亮色 | 白色背景，黑色文字 |
| 护眼 | 米黄色背景，降低眼睛疲劳 |
| 暗色 | 深色背景，夜间阅读 |

### 4. 规则管理

```
┌──────────────────────────────────────────────────────────────────┐
│  规则管理                                           [+ 新建规则] │
├──────────────────────────────────────────────────────────────────┤
│                                                                   │
│  来源筛选: [全部] [内置] [学习] [自定义]                         │
│  类型筛选: [全部类型 ▼]                            [搜索...]     │
│                                                                   │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │ 🔵 清理空段落                          内置  cleanup        │ │
│  │    删除文档中的空段落标签                                   │ │
│  │    选择器: p:empty | 置信度: 98% | 应用: 1234次            │ │
│  │                                               [开] [✏] [🗑] │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                   │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │ 🔵 修复嵌套标签                        学习  structure      │ │
│  │    修复错误嵌套的HTML标签                                   │ │
│  │    选择器: p > p | 置信度: 95% | 应用: 567次               │ │
│  │    学习自 3 本书籍                                         │ │
│  │                                               [开] [✏] [🗑] │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                   │
└──────────────────────────────────────────────────────────────────┘
```

**规则操作:**

| 操作 | 图标 | 说明 |
|------|------|------|
| 启用/禁用 | 开关 | 控制规则是否生效 |
| 编辑 | ✏ | 修改规则配置 |
| 删除 | 🗑 | 删除自定义规则（内置规则不可删除）|

### 5. 学习报告

```
┌──────────────────────────────────────────────────────────────────┐
│  学习报告                                                         │
├──────────────────────────────────────────────────────────────────┤
│                                                                   │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐            │
│  │   12    │  │    5    │  │    4    │  │    3    │            │
│  │ 总模式  │  │ 待审核  │  │ 已批准  │  │ 已拒绝  │            │
│  └─────────┘  └─────────┘  └─────────┘  └─────────┘            │
│                                                                   │
│  状态: [全部] [待审核] [已批准] [已拒绝]                         │
│                                                                   │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │ ⏳ REMOVE  p:empty                                          │ │
│  │    出现 156 次 | 涉及 12 本书 | 置信度: 96%                 │ │
│  │                                                             │ │
│  │    样本预览:                                                │ │
│  │    • Pride and Prejudice: <p></p>                          │ │
│  │    • 1984: <p></p>                                         │ │
│  │    • Jane Eyre: <p></p>                                    │ │
│  │                                                             │ │
│  │                                          [✓ 批准] [✗ 拒绝] │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                   │
└──────────────────────────────────────────────────────────────────┘
```

**审批操作:**

| 操作 | 结果 |
|------|------|
| 批准 | 模式转化为规则，开始应用 |
| 拒绝 | 模式被标记为无效，不再提示 |

## 常见工作流程

### 校正新书籍

```
1. 进入书籍列表
       ↓
2. 选择待校正书籍
       ↓
3. 逐章处理修复项
   • 确认自动修复
   • 审核待确认项
   • 处理建议项
       ↓
4. 预览检查效果
       ↓
5. 保存更改
       ↓
6. 完成所有章节后批准发布
```

### 审批学习模式

```
1. 进入学习报告
       ↓
2. 查看待审核模式
       ↓
3. 检查样本数据
   • 出现次数
   • 涉及书籍
   • 置信度
       ↓
4. 决定批准或拒绝
       ↓
5. 批准后模式自动转为规则
```

### 迁移规则到生产

```
1. 在非生产环境测试规则
       ↓
2. 进入规则迁移页面
       ↓
3. 选择要导出的规则
       ↓
4. 选择目标环境为 Production
       ↓
5. 提交导出申请
       ↓
6. 等待管理员审批
       ↓
7. 审批通过后规则自动导入
```

## 快捷键

| 快捷键 | 功能 |
|--------|------|
| Ctrl/Cmd + S | 保存当前更改 |
| Ctrl/Cmd + Z | 撤销 |
| Ctrl/Cmd + Shift + Z | 重做 |
| Ctrl/Cmd + Enter | 确认当前修复项 |
| Esc | 取消当前操作 |

## 注意事项

### 生产环境操作

- 发布书籍需要输入 "CONFIRM" 确认
- 删除规则会显示警告提示
- 批量操作需要额外确认

### 数据安全

- 所有更改都会记录日志
- 可随时回滚到之前的版本
- 不同环境数据完全隔离

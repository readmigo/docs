# 书籍管理

## 概述

书籍管理是 Dashboard 的核心功能模块，提供完整的书籍 CRUD 操作、上下架控制、难度设置等功能。

## 路由配置

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         路由信息                                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  路径                组件              说明                                  │
│  ─────────────────────────────────────────────────────────────────          │
│  /books              BookList          书籍列表                              │
│  /books/create       BookCreate        创建书籍                              │
│  /books/:id          BookShow          书籍详情                              │
│  /books/:id/edit     BookEdit          编辑书籍                              │
│                                                                             │
│  权限:                                                                       │
│  ─────────────────────────────────────────────────────────────────          │
│  查看: 所有角色                                                              │
│  创建/编辑: Super Admin, Content Manager                                    │
│  删除: Super Admin                                                          │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 列表视图

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         书籍列表                                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │  筛选: [状态 ▼] [难度 ▼] [分类 ▼] [来源 ▼]  🔍 搜索...  [+ 创建]   │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │ ☐ │ 封面 │ 书名           │ 作者    │ 难度   │ 状态   │ 阅读量│操作│    │
│  │───┼──────┼────────────────┼─────────┼────────┼────────┼───────┼────│    │
│  │ ☐ │ [📕] │Pride & Preju...│ Austen  │ 中级   │ ✅上架 │ 12,345│[⋮]│    │
│  │ ☐ │ [📗] │Great Expecta...│ Dickens │ 高级   │ ✅上架 │ 8,901 │[⋮]│    │
│  │ ☐ │ [📘] │1984            │ Orwell  │ 中级   │ ⚠️草稿 │ 0     │[⋮]│    │
│  │ ☐ │ [📙] │Animal Farm     │ Orwell  │ 初级   │ ❌下架 │ 5,678 │[⋮]│    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                             │
│  [< 上一页]  第 1 页，共 12 页  [下一页 >]     每页 25 条                    │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 筛选条件

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         筛选选项                                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  状态筛选:                                                                   │
│  ─────────────────────────────────────────────────────────────────          │
│  • published    已上架                                                      │
│  • draft        草稿                                                        │
│  • unpublished  已下架                                                      │
│  • pending      待审核                                                      │
│                                                                             │
│  难度筛选:                                                                   │
│  ─────────────────────────────────────────────────────────────────          │
│  • beginner     初级 (Lexile 200-600)                                       │
│  • intermediate 中级 (Lexile 600-1000)                                      │
│  • advanced     高级 (Lexile 1000+)                                         │
│                                                                             │
│  分类筛选:                                                                   │
│  ─────────────────────────────────────────────────────────────────          │
│  • 动态加载自 /categories 接口                                              │
│  • 支持多选                                                                  │
│                                                                             │
│  来源筛选:                                                                   │
│  ─────────────────────────────────────────────────────────────────          │
│  • gutenberg    古腾堡项目                                                  │
│  • manual       手动上传                                                    │
│  • import       批量导入                                                    │
│                                                                             │
│  搜索:                                                                       │
│  ─────────────────────────────────────────────────────────────────          │
│  • 支持书名、作者名模糊搜索                                                  │
│  • 输入后延迟 300ms 触发搜索                                                │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 书籍详情

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         详情视图                                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │  [< 返回列表]                               [编辑] [上架/下架] [删除]│    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                             │
│  ┌────────────┐  ┌───────────────────────────────────────────────────┐     │
│  │            │  │  Pride and Prejudice                              │     │
│  │   [封面]   │  │  ─────────────────────────────────────────────    │     │
│  │            │  │                                                    │     │
│  │            │  │  作者: Jane Austen                                 │     │
│  │            │  │  分类: Classic Fiction                            │     │
│  │            │  │  难度: 中级 (Lexile: 850)                          │     │
│  │            │  │  状态: ✅ 已上架                                   │     │
│  │            │  │  语言: English                                    │     │
│  │            │  │  字数: 122,189                                    │     │
│  │            │  │  章节: 61                                         │     │
│  │            │  │                                                    │     │
│  └────────────┘  └───────────────────────────────────────────────────┘     │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │  简介                                                                │    │
│  │  ─────────────────────────────────────────────────────────────────  │    │
│  │  A classic novel about the Bennet family in rural England...        │    │
│  │  The story follows the main character Elizabeth Bennet...           │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │  阅读统计                                                            │    │
│  │  ─────────────────────────────────────────────────────────────────  │    │
│  │  总阅读量: 12,345    收藏数: 567    评分: 4.5 ⭐                     │    │
│  │  平均阅读时长: 8.5小时    完读率: 23%                                │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 创建/编辑表单

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         表单字段                                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  基本信息                                                                    │
│  ─────────────────────────────────────────────────────────────────          │
│  书名 *              TextInput       必填                                   │
│  作者 *              ReferenceInput  关联 authors                           │
│  分类                ReferenceInput  关联 categories，多选                  │
│  简介                RichTextInput   富文本                                 │
│                                                                             │
│  难度设置                                                                    │
│  ─────────────────────────────────────────────────────────────────          │
│  难度等级            SelectInput     beginner/intermediate/advanced         │
│  Lexile 值           NumberInput     可选，手动指定                         │
│                                                                             │
│  EPUB 文件                                                                   │
│  ─────────────────────────────────────────────────────────────────          │
│  EPUB 文件           FileInput       .epub 格式                             │
│  封面图片            ImageInput      .jpg/.png 格式                         │
│                                                                             │
│  发布设置                                                                    │
│  ─────────────────────────────────────────────────────────────────          │
│  状态                SelectInput     draft/published/unpublished            │
│  上架时间            DateTimeInput   可选，定时上架                         │
│                                                                             │
│  元数据                                                                      │
│  ─────────────────────────────────────────────────────────────────          │
│  ISBN               TextInput       可选                                    │
│  出版年份            NumberInput     可选                                   │
│  语言               SelectInput     en/zh-Hans/zh-Hant                     │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 批量操作

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         批量操作                                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  选中多本书籍后可执行:                                                       │
│  ─────────────────────────────────────────────────────────────────          │
│  • 批量上架: 将选中书籍状态改为 published                                   │
│  • 批量下架: 将选中书籍状态改为 unpublished                                 │
│  • 批量删除: 删除选中书籍 (需要 Super Admin 权限)                           │
│  • 批量修改分类: 为选中书籍添加/移除分类                                    │
│                                                                             │
│  操作确认:                                                                   │
│  ─────────────────────────────────────────────────────────────────          │
│  • 删除操作需要二次确认                                                      │
│  • 显示即将影响的书籍数量                                                    │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## API 接口

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         API 端点                                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  GET    /api/v1/admin/books                                                 │
│  ─────────────────────────────────────────────────────────────────          │
│  参数: page, limit, sort, order, status, difficulty, categoryId, q          │
│  返回: { items: [...], total: number }                                      │
│                                                                             │
│  GET    /api/v1/admin/books/:id                                             │
│  ─────────────────────────────────────────────────────────────────          │
│  返回: { id, title, author, ... }                                           │
│                                                                             │
│  POST   /api/v1/admin/books                                                 │
│  ─────────────────────────────────────────────────────────────────          │
│  Body: { title, authorId, categoryIds, description, ... }                   │
│  返回: 创建的书籍对象                                                       │
│                                                                             │
│  PATCH  /api/v1/admin/books/:id                                             │
│  ─────────────────────────────────────────────────────────────────          │
│  Body: { 要更新的字段 }                                                     │
│  返回: 更新后的书籍对象                                                     │
│                                                                             │
│  DELETE /api/v1/admin/books/:id                                             │
│  ─────────────────────────────────────────────────────────────────          │
│  返回: 删除确认                                                             │
│                                                                             │
│  POST   /api/v1/admin/books/:id/publish                                     │
│  ─────────────────────────────────────────────────────────────────          │
│  上架书籍                                                                    │
│                                                                             │
│  POST   /api/v1/admin/books/:id/unpublish                                   │
│  ─────────────────────────────────────────────────────────────────          │
│  下架书籍                                                                    │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

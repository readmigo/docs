# Dashboard 国际化

## 概述

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         国际化架构                                           │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  技术方案:                                                                   │
│  ─────────────────────────────────────────────────────────────────          │
│  • React Admin 内置 i18n 支持                                               │
│  • ra-i18n-polyglot 作为 i18n 提供者                                        │
│  • 基于 locale 的翻译文件                                                   │
│                                                                             │
│  支持语言:                                                                   │
│  ─────────────────────────────────────────────────────────────────          │
│  en            English           英文                                       │
│  zh-Hans       简体中文          Simplified Chinese                         │
│  zh-Hant       繁體中文          Traditional Chinese                        │
│                                                                             │
│  默认语言:                                                                   │
│  ─────────────────────────────────────────────────────────────────          │
│  • 首次访问: 根据浏览器语言自动选择                                          │
│  • 后续访问: 使用 localStorage 存储的偏好                                   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 文件结构

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         i18n 文件结构                                        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  src/i18n/                                                                  │
│  ├── index.ts          # i18n Provider 配置                                 │
│  ├── en.ts             # 英文翻译                                           │
│  ├── zh-Hans.ts        # 简体中文翻译                                        │
│  └── zh-Hant.ts        # 繁体中文翻译                                        │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 翻译结构

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         翻译文件结构                                         │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  {                                                                          │
│    // React Admin 内置翻译                                                  │
│    ra: {                                                                    │
│      action: {                                                              │
│        save: '保存',                                                        │
│        delete: '删除',                                                       │
│        edit: '编辑',                                                         │
│        cancel: '取消',                                                       │
│        ...                                                                  │
│      },                                                                     │
│      page: {                                                                │
│        list: '%{name} 列表',                                                │
│        edit: '编辑 %{name}',                                                │
│        create: '创建 %{name}',                                              │
│        ...                                                                  │
│      },                                                                     │
│      ...                                                                    │
│    },                                                                       │
│                                                                             │
│    // 自定义资源翻译                                                         │
│    resources: {                                                             │
│      books: {                                                               │
│        name: '书籍 |||| 书籍',                                              │
│        fields: {                                                            │
│          title: '书名',                                                      │
│          author: '作者',                                                     │
│          difficulty: '难度',                                                 │
│          status: '状态',                                                     │
│        },                                                                   │
│      },                                                                     │
│      users: {                                                               │
│        name: '用户 |||| 用户',                                              │
│        fields: { ... },                                                     │
│      },                                                                     │
│      ...                                                                    │
│    },                                                                       │
│                                                                             │
│    // 自定义翻译                                                             │
│    custom: {                                                                │
│      dashboard: {                                                           │
│        title: '仪表盘',                                                      │
│        metrics: { ... },                                                    │
│      },                                                                     │
│      environment: {                                                         │
│        local: '本地',                                                        │
│        debug: '调试',                                                        │
│        staging: '预发布',                                                    │
│        production: '生产',                                                   │
│      },                                                                     │
│    },                                                                       │
│  }                                                                          │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 资源翻译

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         资源名称翻译                                         │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  资源              英文                中文                                  │
│  ─────────────────────────────────────────────────────────────────          │
│  books             Book / Books        书籍                                  │
│  authors           Author / Authors    作者                                  │
│  categories        Category            分类                                  │
│  booklists         Book List           榜单                                  │
│  users             User / Users        用户                                  │
│  quotes            Quote / Quotes      金句                                  │
│  postcards         Postcard            明信片                                │
│  messages          Message             消息                                  │
│  feedback          Feedback            反馈                                  │
│  tickets           Ticket              工单                                  │
│  orders            Order               订单                                  │
│                                                                             │
│  复数形式语法: 'singular |||| plural'                                        │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 字段翻译

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         常用字段翻译                                         │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  通用字段:                                                                   │
│  ─────────────────────────────────────────────────────────────────          │
│  id              ID                   ID                                    │
│  name            Name                 名称                                  │
│  title           Title                标题                                  │
│  description     Description          描述                                  │
│  status          Status               状态                                  │
│  createdAt       Created At           创建时间                              │
│  updatedAt       Updated At           更新时间                              │
│                                                                             │
│  书籍字段:                                                                   │
│  ─────────────────────────────────────────────────────────────────          │
│  author          Author               作者                                  │
│  difficulty      Difficulty           难度                                  │
│  category        Category             分类                                  │
│  wordCount       Word Count           字数                                  │
│  coverUrl        Cover                封面                                  │
│                                                                             │
│  用户字段:                                                                   │
│  ─────────────────────────────────────────────────────────────────          │
│  email           Email                邮箱                                  │
│  displayName     Display Name         显示名称                              │
│  subscription    Subscription         订阅                                  │
│  platform        Platform             平台                                  │
│  lastActiveAt    Last Active          最后活跃                              │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 使用方法

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         翻译使用                                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  自动翻译 (React Admin):                                                     │
│  ─────────────────────────────────────────────────────────────────          │
│  • 资源名称自动从 resources.{name}.name 获取                                │
│  • 字段标签自动从 resources.{name}.fields.{field} 获取                      │
│  • 操作按钮自动从 ra.action.{action} 获取                                   │
│                                                                             │
│  手动翻译 (useTranslate):                                                    │
│  ─────────────────────────────────────────────────────────────────          │
│  const translate = useTranslate();                                          │
│  const title = translate('custom.dashboard.title');                         │
│  const greeting = translate('custom.greeting', { name: 'Alice' });          │
│                                                                             │
│  组件中使用:                                                                 │
│  ─────────────────────────────────────────────────────────────────          │
│  <Typography>                                                               │
│    {translate('custom.dashboard.metrics.totalUsers')}                       │
│  </Typography>                                                              │
│                                                                             │
│  变量插值:                                                                   │
│  ─────────────────────────────────────────────────────────────────          │
│  // 翻译文件                                                                 │
│  greeting: 'Hello, %{name}!'                                                │
│                                                                             │
│  // 使用                                                                     │
│  translate('greeting', { name: 'Alice' })                                   │
│  // 输出: "Hello, Alice!"                                                   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 语言切换

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         语言切换实现                                         │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  切换流程:                                                                   │
│  ─────────────────────────────────────────────────────────────────          │
│  1. 用户点击 LanguageSwitcher                                               │
│  2. 选择目标语言                                                             │
│  3. 调用 React Admin setLocale()                                            │
│  4. 更新 localStorage.locale                                                │
│  5. 触发界面重新渲染                                                         │
│                                                                             │
│  代码示例:                                                                   │
│  ─────────────────────────────────────────────────────────────────          │
│  const { setLocale } = useLocaleState();                                    │
│                                                                             │
│  const handleLanguageChange = (locale: string) => {                         │
│    setLocale(locale);                                                       │
│    localStorage.setItem('locale', locale);                                  │
│  };                                                                         │
│                                                                             │
│  检测浏览器语言:                                                             │
│  ─────────────────────────────────────────────────────────────────          │
│  const browserLocale = navigator.language;                                  │
│  const supportedLocales = ['en', 'zh-Hans', 'zh-Hant'];                     │
│  const defaultLocale =                                                      │
│    supportedLocales.find(l => browserLocale.startsWith(l)) || 'en';         │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 添加新翻译

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         添加翻译步骤                                         │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  1. 在所有语言文件中添加翻译键:                                              │
│                                                                             │
│     // en.ts                                                                │
│     newFeature: {                                                           │
│       title: 'New Feature',                                                 │
│       description: 'This is a new feature',                                 │
│     },                                                                      │
│                                                                             │
│     // zh-Hans.ts                                                           │
│     newFeature: {                                                           │
│       title: '新功能',                                                       │
│       description: '这是一个新功能',                                         │
│     },                                                                      │
│                                                                             │
│     // zh-Hant.ts                                                           │
│     newFeature: {                                                           │
│       title: '新功能',                                                       │
│       description: '這是一個新功能',                                         │
│     },                                                                      │
│                                                                             │
│  2. 在组件中使用:                                                            │
│                                                                             │
│     const translate = useTranslate();                                       │
│     <h1>{translate('newFeature.title')}</h1>                                │
│                                                                             │
│  注意事项:                                                                   │
│  ─────────────────────────────────────────────────────────────────          │
│  • 保持所有语言文件结构一致                                                  │
│  • 缺失的翻译会显示 key 本身                                                │
│  • 建议先添加英文，再添加其他语言                                            │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

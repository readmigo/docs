# iOS 学习功能

> 生词管理 + 间隔复习 + 学习统计

---

## 1. 功能概览

```
┌─────────────────────────────────────────────────────────────────┐
│                    学习功能架构                                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                    词汇采集                              │    │
│  │  ┌───────────┐  ┌───────────┐  ┌───────────┐           │    │
│  │  │ 阅读查词  │  │  手动添加  │  │  批量导入  │           │    │
│  │  └───────────┘  └───────────┘  └───────────┘           │    │
│  └─────────────────────────────────────────────────────────┘    │
│                              │                                   │
│  ┌───────────────────────────┴─────────────────────────────┐    │
│  │                    词汇管理                              │    │
│  │  ┌───────────┐  ┌───────────┐  ┌───────────┐           │    │
│  │  │  生词本   │  │  分类管理  │  │  搜索筛选  │           │    │
│  │  └───────────┘  └───────────┘  └───────────┘           │    │
│  └─────────────────────────────────────────────────────────┘    │
│                              │                                   │
│  ┌───────────────────────────┴─────────────────────────────┐    │
│  │                    复习系统                              │    │
│  │  ┌───────────┐  ┌───────────┐  ┌───────────┐           │    │
│  │  │  SM-2算法 │  │  卡片复习  │  │  学习统计  │           │    │
│  │  └───────────┘  └───────────┘  └───────────┘           │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 2. 词汇采集

### 2.1 采集方式

| 方式 | 说明 |
|------|------|
| 阅读查词 | 查词时自动添加 |
| 手动添加 | 生词本中手动输入 |
| 批量导入 | 导入词汇表 |
| AI 推荐 | 根据阅读推荐 |

### 2.2 词汇信息

```
┌─────────────────────────────────────────────────────────────────┐
│                    词汇信息结构                                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  基本信息                                                        │
│  ├── 单词 (word)                                                │
│  ├── 音标 (phonetic)                                            │
│  ├── 词性 (part_of_speech)                                      │
│  ├── 释义 (definitions)                                         │
│  └── 发音音频 (audio_url)                                       │
│                                                                  │
│  学习信息                                                        │
│  ├── 添加时间 (created_at)                                      │
│  ├── 来源书籍 (source_book)                                     │
│  ├── 原文语境 (context)                                         │
│  └── 用户笔记 (note)                                            │
│                                                                  │
│  复习信息                                                        │
│  ├── 复习次数 (review_count)                                    │
│  ├── 正确次数 (correct_count)                                   │
│  ├── 下次复习 (next_review)                                     │
│  ├── 间隔天数 (interval)                                        │
│  └── 简易度 (easiness_factor)                                   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 3. 生词本

### 3.1 生词本界面

```
┌─────────────────────────────────────────────────────────────────┐
│                    生词本界面                                    │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │  [搜索]                              [筛选] [排序] [+]  │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │  [全部 120] [今日 5] [待复习 23] [已掌握 45]            │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │  abandon                                         🔊 ⭐  │    │
│  │  v. 放弃；遗弃                                         │    │
│  │  📖 The Great Gatsby                                   │    │
│  │  下次复习: 明天                                         │    │
│  ├─────────────────────────────────────────────────────────┤    │
│  │  benevolent                                      🔊 ⭐  │    │
│  │  adj. 仁慈的；慷慨的                                    │    │
│  │  📖 1984                                               │    │
│  │  下次复习: 3 天后                                       │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 3.2 词汇操作

| 操作 | 说明 |
|------|------|
| 查看详情 | 完整释义和例句 |
| 播放发音 | 美式/英式发音 |
| 编辑笔记 | 添加个人笔记 |
| 标记掌握 | 标记为已掌握 |
| 删除词汇 | 从生词本移除 |

---

## 4. SM-2 算法

### 4.1 算法参数

| 参数 | 说明 | 初始值 |
|------|------|--------|
| n | 复习次数 | 0 |
| EF | 简易度因子 | 2.5 |
| I | 间隔天数 | 1 |

### 4.2 算法流程

```
┌─────────────────────────────────────────────────────────────────┐
│                    SM-2 复习算法                                 │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  用户评分 (0-5)                                                  │
│  ├── 0: 完全不记得                                               │
│  ├── 1: 错误，但看到答案后想起                                   │
│  ├── 2: 错误，但答案似曾相识                                     │
│  ├── 3: 正确，但很费劲                                           │
│  ├── 4: 正确，稍有犹豫                                           │
│  └── 5: 完美记忆                                                 │
│                                                                  │
│  间隔计算                                                        │
│  ├── q < 3: 重置为第一天                                        │
│  │   └── I(1) = 1                                               │
│  │                                                              │
│  └── q >= 3: 计算下一间隔                                       │
│      ├── I(1) = 1                                               │
│      ├── I(2) = 6                                               │
│      └── I(n) = I(n-1) × EF                                     │
│                                                                  │
│  简易度更新                                                      │
│  EF' = EF + (0.1 - (5-q) × (0.08 + (5-q) × 0.02))              │
│  └── EF' < 1.3 则 EF' = 1.3                                     │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 5. 复习模式

### 5.1 复习类型

| 类型 | 说明 |
|------|------|
| 认识/不认识 | 简单二选一 |
| 选择题 | 四选一 |
| 拼写 | 输入拼写 |
| 听写 | 听音拼写 |

### 5.2 卡片复习

```
┌─────────────────────────────────────────────────────────────────┐
│                    卡片复习界面                                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  正面 (点击翻转)                                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                                                          │    │
│  │                                                          │    │
│  │                      abandon                             │    │
│  │                      /əˈbændən/                         │    │
│  │                        🔊                                │    │
│  │                                                          │    │
│  │                                                          │    │
│  │              [点击显示释义]                               │    │
│  │                                                          │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
│  背面 (评分)                                                     │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                      abandon                             │    │
│  │                      /əˈbændən/                         │    │
│  │                                                          │    │
│  │  v. 放弃；遗弃；抛弃                                      │    │
│  │                                                          │    │
│  │  "He abandoned his car and fled on foot."               │    │
│  │  他弃车徒步逃走了。                                       │    │
│  │                                                          │    │
│  │  ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐           │    │
│  │  │ 不认识 │ │  模糊  │ │  记得  │ │ 简单  │           │    │
│  │  │ <1min │ │  10min │ │  1day  │ │ 4days │           │    │
│  │  └────────┘ └────────┘ └────────┘ └────────┘           │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 6. 学习计划

### 6.1 每日目标

| 设置 | 选项 |
|------|------|
| 新词数量 | 5/10/20/30/50 |
| 复习上限 | 50/100/200/无限 |
| 提醒时间 | 自定义时间 |

### 6.2 学习提醒

```
┌─────────────────────────────────────────────────────────────────┐
│                    学习提醒                                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  提醒类型                                                        │
│  ├── 每日提醒    固定时间提醒复习                               │
│  ├── 待复习提醒  有待复习词汇时提醒                             │
│  └── 连续打卡    鼓励每日学习                                   │
│                                                                  │
│  提醒设置                                                        │
│  ├── 提醒时间: 09:00 / 20:00                                   │
│  ├── 提醒方式: 通知 / 小组件                                    │
│  └── 静默时段: 22:00 - 08:00                                   │
│                                                                  │
│  智能提醒                                                        │
│  ├── 根据学习习惯调整时间                                        │
│  └── 根据待复习数量调整频率                                      │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 7. 学习统计

### 7.1 统计维度

| 维度 | 说明 |
|------|------|
| 今日学习 | 今日新学 + 复习 |
| 累计词汇 | 总词汇量 |
| 掌握词汇 | 已掌握数量 |
| 连续天数 | 连续学习天数 |
| 正确率 | 复习正确率 |

### 7.2 统计图表

```
┌─────────────────────────────────────────────────────────────────┐
│                    学习统计                                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  今日学习                                                        │
│  ├── 新学: 10 词                                                │
│  ├── 复习: 25 词                                                │
│  └── 学习时长: 15 分钟                                          │
│                                                                  │
│  本周趋势                                                        │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │     ▄                                                    │    │
│  │   ▄ █ ▄   ▄                                              │    │
│  │ ▄ █ █ █ ▄ █ ▄                                            │    │
│  │ █ █ █ █ █ █ █                                            │    │
│  │ 一 二 三 四 五 六 日                                      │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
│  词汇统计                                                        │
│  ├── 总词汇: 500                                                │
│  ├── 已掌握: 200 (40%)                                          │
│  ├── 学习中: 250 (50%)                                          │
│  └── 未学习: 50 (10%)                                           │
│                                                                  │
│  🔥 连续学习 15 天                                              │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 8. 词汇分类

### 8.1 分类方式

| 分类 | 说明 |
|------|------|
| 来源书籍 | 按书籍分组 |
| 学习状态 | 新词/学习中/已掌握 |
| 难度等级 | 简单/中等/困难 |
| 自定义标签 | 用户标签 |

### 8.2 词汇标签

```
┌─────────────────────────────────────────────────────────────────┐
│                    词汇标签                                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  系统标签                                                        │
│  ├── 高频词    常用词汇                                         │
│  ├── 考试词汇  考试高频                                         │
│  └── 难词      高难度词汇                                       │
│                                                                  │
│  自定义标签                                                      │
│  ├── 创建标签                                                    │
│  ├── 颜色选择                                                    │
│  └── 批量添加                                                    │
│                                                                  │
│  智能标签                                                        │
│  ├── 易错词    多次错误的词汇                                   │
│  ├── 长期未复习  超期未复习                                     │
│  └── 即将遗忘  预测将遗忘                                       │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 9. 数据同步

### 9.1 同步内容

| 内容 | 策略 |
|------|------|
| 词汇列表 | 实时同步 |
| 复习记录 | 实时同步 |
| 学习统计 | 定时同步 |
| 设置偏好 | 变更时同步 |

### 9.2 离线学习

```
┌─────────────────────────────────────────────────────────────────┐
│                    离线支持                                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  离线可用                                                        │
│  ├── 生词本浏览                                                  │
│  ├── 卡片复习                                                    │
│  ├── 学习统计查看                                                │
│  └── 发音播放 (已缓存)                                          │
│                                                                  │
│  离线存储                                                        │
│  ├── 词汇数据    SwiftData                                      │
│  ├── 复习记录    SwiftData                                      │
│  └── 音频缓存    FileManager                                    │
│                                                                  │
│  恢复同步                                                        │
│  ├── 网络恢复后自动同步                                          │
│  ├── 冲突时保留最新记录                                          │
│  └── 同步进度提示                                                │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 10. 小组件

### 10.1 小组件类型

| 类型 | 尺寸 | 内容 |
|------|------|------|
| 今日学习 | 小 | 待复习数 |
| 学习统计 | 中 | 今日进度 |
| 单词卡片 | 大 | 每日一词 |

### 10.2 小组件设计

```
┌─────────────────────────────────────────────────────────────────┐
│                    小组件                                        │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  小尺寸                                                          │
│  ┌─────────────────┐                                            │
│  │  📚 待复习      │                                            │
│  │     23 词       │                                            │
│  └─────────────────┘                                            │
│                                                                  │
│  中尺寸                                                          │
│  ┌─────────────────────────────────────────┐                    │
│  │  今日学习                                │                    │
│  │  新学: 10    复习: 25    🔥 15天        │                    │
│  │  ████████████░░░░░░ 70%                 │                    │
│  └─────────────────────────────────────────┘                    │
│                                                                  │
│  大尺寸                                                          │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │  每日一词                                                │    │
│  │                                                          │    │
│  │  serendipity                                            │    │
│  │  /ˌserənˈdɪpəti/                                       │    │
│  │                                                          │    │
│  │  n. 意外发现美好事物的运气                                 │    │
│  │                                                          │    │
│  │  待复习: 23 词                        [开始复习]          │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 11. 相关文档

| 文档 | 说明 |
|------|------|
| [ai.md](./ai.md) | AI 功能 |
| [reader.md](./reader.md) | 阅读器功能 |
| [../architecture.md](../architecture.md) | 架构设计 |

---

*最后更新: 2025-12-31*

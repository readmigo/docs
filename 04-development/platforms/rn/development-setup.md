# React Native 开发环境配置

## 环境要求

```
┌─────────────────────────────────────────────────────────────────┐
│                    Required Environment                          │
├─────────────────────────────────────────────────────────────────┤
│  Node.js                                                         │
│  ├── 版本: 18.x 或更高                                           │
│  └── 推荐: 使用 nvm 管理版本                                     │
├─────────────────────────────────────────────────────────────────┤
│  Package Manager                                                 │
│  ├── npm: 9.x+ (Node 自带)                                      │
│  ├── yarn: 1.22+ (可选)                                         │
│  └── pnpm: 8.x+ (可选)                                          │
├─────────────────────────────────────────────────────────────────┤
│  Expo CLI                                                        │
│  ├── 全局安装: npm install -g expo-cli                          │
│  └── 或使用 npx expo                                            │
├─────────────────────────────────────────────────────────────────┤
│  iOS Development (macOS)                                         │
│  ├── Xcode: 15.0+                                               │
│  ├── iOS Simulator                                              │
│  └── CocoaPods: 1.14+                                           │
├─────────────────────────────────────────────────────────────────┤
│  Android Development                                             │
│  ├── Android Studio: 最新稳定版                                  │
│  ├── Android SDK: API 33+                                       │
│  ├── Android Emulator                                           │
│  └── JAVA_HOME 配置                                             │
└─────────────────────────────────────────────────────────────────┘
```

## 项目设置

### 克隆与安装

```
┌─────────────────────────────────────────────────────────────────┐
│                    Setup Steps                                   │
├─────────────────────────────────────────────────────────────────┤
│  1. 克隆仓库                                                     │
│     git clone <repo-url>                                        │
│     cd readmigo                                                 │
├─────────────────────────────────────────────────────────────────┤
│  2. 安装依赖                                                     │
│     cd apps/mobile                                              │
│     npm install                                                 │
├─────────────────────────────────────────────────────────────────┤
│  3. iOS 依赖 (macOS)                                            │
│     cd ios && pod install && cd ..                              │
├─────────────────────────────────────────────────────────────────┤
│  4. 环境变量                                                     │
│     cp .env.example .env                                        │
│     # 编辑 .env 文件                                            │
└─────────────────────────────────────────────────────────────────┘
```

### 环境变量

```
┌─────────────────────────────────────────────────────────────────┐
│                    Environment Variables                         │
├─────────────────────────────────────────────────────────────────┤
│  .env                                                            │
│  ├── EXPO_PUBLIC_API_URL=https://api.readmigo.app               │
│  ├── EXPO_PUBLIC_REVENUECAT_IOS_KEY=<key>                       │
│  ├── EXPO_PUBLIC_REVENUECAT_ANDROID_KEY=<key>                   │
│  └── EXPO_PUBLIC_SENTRY_DSN=<dsn>                               │
├─────────────────────────────────────────────────────────────────┤
│  访问方式                                                        │
│  └── process.env.EXPO_PUBLIC_API_URL                            │
└─────────────────────────────────────────────────────────────────┘
```

## 开发命令

```
┌─────────────────────────────────────────────────────────────────┐
│                    Development Commands                          │
├─────────────────────────────────────────────────────────────────┤
│  启动开发服务器                                                   │
│  npm start              # 启动 Expo Dev Server                  │
│  npm run ios            # 启动 iOS 模拟器                        │
│  npm run android        # 启动 Android 模拟器                    │
├─────────────────────────────────────────────────────────────────┤
│  构建                                                            │
│  npm run build:ios      # 构建 iOS                              │
│  npm run build:android  # 构建 Android                          │
├─────────────────────────────────────────────────────────────────┤
│  代码质量                                                        │
│  npm run lint           # ESLint 检查                           │
│  npm run lint:fix       # ESLint 自动修复                        │
│  npm run typecheck      # TypeScript 类型检查                    │
├─────────────────────────────────────────────────────────────────┤
│  测试                                                            │
│  npm test               # 运行测试                               │
│  npm run test:watch     # 监听模式                               │
│  npm run test:coverage  # 覆盖率报告                             │
└─────────────────────────────────────────────────────────────────┘
```

## IDE 配置

### VS Code

```
┌─────────────────────────────────────────────────────────────────┐
│                    VS Code Setup                                 │
├─────────────────────────────────────────────────────────────────┤
│  推荐插件                                                        │
│  ├── ES7+ React/Redux/React-Native snippets                     │
│  ├── ESLint                                                     │
│  ├── Prettier - Code formatter                                  │
│  ├── TypeScript Importer                                        │
│  ├── React Native Tools                                         │
│  ├── Color Highlight                                            │
│  └── GitLens                                                    │
├─────────────────────────────────────────────────────────────────┤
│  settings.json                                                   │
│  {                                                              │
│    "editor.formatOnSave": true,                                 │
│    "editor.defaultFormatter": "esbenp.prettier-vscode",         │
│    "editor.codeActionsOnSave": {                                │
│      "source.fixAll.eslint": true                               │
│    },                                                           │
│    "typescript.preferences.importModuleSpecifier": "relative"   │
│  }                                                              │
└─────────────────────────────────────────────────────────────────┘
```

## ESLint 配置

```
┌─────────────────────────────────────────────────────────────────┐
│                    ESLint Configuration                          │
├─────────────────────────────────────────────────────────────────┤
│  extends:                                                        │
│  ├── @react-native                                              │
│  ├── plugin:@typescript-eslint/recommended                      │
│  └── prettier                                                   │
├─────────────────────────────────────────────────────────────────┤
│  plugins:                                                        │
│  ├── @typescript-eslint                                         │
│  ├── react                                                      │
│  ├── react-hooks                                                │
│  └── import                                                     │
├─────────────────────────────────────────────────────────────────┤
│  rules:                                                          │
│  ├── react-hooks/rules-of-hooks: error                          │
│  ├── react-hooks/exhaustive-deps: warn                          │
│  ├── @typescript-eslint/no-unused-vars: warn                    │
│  └── import/order: error                                        │
└─────────────────────────────────────────────────────────────────┘
```

## TypeScript 配置

```
┌─────────────────────────────────────────────────────────────────┐
│                  TypeScript Configuration                        │
├─────────────────────────────────────────────────────────────────┤
│  tsconfig.json                                                   │
│  {                                                              │
│    "extends": "expo/tsconfig.base",                             │
│    "compilerOptions": {                                         │
│      "strict": true,                                            │
│      "baseUrl": ".",                                            │
│      "paths": {                                                 │
│        "@/*": ["src/*"],                                        │
│        "@components/*": ["src/components/*"],                   │
│        "@features/*": ["src/features/*"],                       │
│        "@hooks/*": ["src/hooks/*"],                             │
│        "@services/*": ["src/services/*"],                       │
│        "@stores/*": ["src/stores/*"],                           │
│        "@theme/*": ["src/theme/*"],                             │
│        "@utils/*": ["src/utils/*"]                              │
│      }                                                          │
│    }                                                            │
│  }                                                              │
└─────────────────────────────────────────────────────────────────┘
```

## Babel 配置

```
┌─────────────────────────────────────────────────────────────────┐
│                    Babel Configuration                           │
├─────────────────────────────────────────────────────────────────┤
│  babel.config.js                                                 │
│  module.exports = function(api) {                               │
│    api.cache(true);                                             │
│    return {                                                     │
│      presets: ['babel-preset-expo'],                            │
│      plugins: [                                                 │
│        'react-native-reanimated/plugin',                        │
│        [                                                        │
│          'module-resolver',                                     │
│          {                                                      │
│            alias: {                                             │
│              '@': './src',                                      │
│              '@components': './src/components',                 │
│              '@features': './src/features',                     │
│              // ... 其他别名                                     │
│            }                                                    │
│          }                                                      │
│        ]                                                        │
│      ]                                                          │
│    };                                                           │
│  };                                                             │
└─────────────────────────────────────────────────────────────────┘
```

## 调试工具

```
┌─────────────────────────────────────────────────────────────────┐
│                    Debugging Tools                               │
├─────────────────────────────────────────────────────────────────┤
│  Expo Dev Tools                                                  │
│  ├── 按 j → 打开调试器                                           │
│  ├── 按 r → 重新加载                                             │
│  ├── 按 m → 打开菜单                                             │
│  └── 按 ? → 显示所有命令                                         │
├─────────────────────────────────────────────────────────────────┤
│  React DevTools                                                  │
│  ├── npm install -g react-devtools                              │
│  └── react-devtools                                             │
├─────────────────────────────────────────────────────────────────┤
│  Flipper (可选)                                                  │
│  ├── 网络请求检查                                                │
│  ├── Layout Inspector                                           │
│  ├── Database Browser                                           │
│  └── Shared Preferences Viewer                                  │
├─────────────────────────────────────────────────────────────────┤
│  Console Logs                                                    │
│  └── console.log() → Metro bundler 终端                         │
└─────────────────────────────────────────────────────────────────┘
```

## 模拟器/设备

### iOS Simulator

```
┌─────────────────────────────────────────────────────────────────┐
│                    iOS Simulator                                 │
├─────────────────────────────────────────────────────────────────┤
│  启动                                                            │
│  ├── npm run ios                                                │
│  └── npx expo run:ios --device <device-name>                    │
├─────────────────────────────────────────────────────────────────┤
│  常用命令                                                        │
│  ├── Cmd + D → 打开开发菜单                                      │
│  ├── Cmd + R → 重新加载                                          │
│  └── Cmd + Shift + H → Home                                     │
├─────────────────────────────────────────────────────────────────┤
│  推荐设备                                                        │
│  ├── iPhone 15 Pro                                              │
│  ├── iPhone SE (3rd)                                            │
│  └── iPad Pro                                                   │
└─────────────────────────────────────────────────────────────────┘
```

### Android Emulator

```
┌─────────────────────────────────────────────────────────────────┐
│                   Android Emulator                               │
├─────────────────────────────────────────────────────────────────┤
│  启动                                                            │
│  ├── npm run android                                            │
│  └── npx expo run:android --device <device-name>                │
├─────────────────────────────────────────────────────────────────┤
│  常用命令                                                        │
│  ├── Cmd + M (macOS) / Ctrl + M → 开发菜单                      │
│  └── R + R → 重新加载                                           │
├─────────────────────────────────────────────────────────────────┤
│  推荐配置                                                        │
│  ├── Pixel 7 (API 34)                                           │
│  ├── RAM: 2048 MB                                               │
│  └── 启用 Hardware GLES 2.0                                     │
└─────────────────────────────────────────────────────────────────┘
```

### 真机调试

```
┌─────────────────────────────────────────────────────────────────┐
│                    Physical Device                               │
├─────────────────────────────────────────────────────────────────┤
│  iOS                                                             │
│  ├── 安装 Expo Go App                                           │
│  ├── 扫描 QR 码或输入 URL                                        │
│  └── 或使用 Development Build                                   │
├─────────────────────────────────────────────────────────────────┤
│  Android                                                         │
│  ├── 启用开发者选项和 USB 调试                                   │
│  ├── 安装 Expo Go App                                           │
│  └── 扫描 QR 码或 adb reverse                                   │
├─────────────────────────────────────────────────────────────────┤
│  adb reverse (Android USB 调试)                                 │
│  adb reverse tcp:8081 tcp:8081                                  │
└─────────────────────────────────────────────────────────────────┘
```

## 常见问题

```
┌─────────────────────────────────────────────────────────────────┐
│                  Troubleshooting                                 │
├─────────────────────────────────────────────────────────────────┤
│  Metro bundler 问题                                              │
│  ├── 清除缓存: npx expo start --clear                           │
│  └── 重启 Metro: 关闭终端重新运行                                │
├─────────────────────────────────────────────────────────────────┤
│  iOS Pod 问题                                                    │
│  ├── cd ios && pod deintegrate                                  │
│  ├── pod cache clean --all                                      │
│  └── pod install                                                │
├─────────────────────────────────────────────────────────────────┤
│  Android 构建问题                                                │
│  ├── cd android && ./gradlew clean                              │
│  └── 检查 JAVA_HOME 和 ANDROID_HOME                             │
├─────────────────────────────────────────────────────────────────┤
│  node_modules 问题                                               │
│  ├── rm -rf node_modules                                        │
│  ├── rm package-lock.json                                       │
│  └── npm install                                                │
└─────────────────────────────────────────────────────────────────┘
```

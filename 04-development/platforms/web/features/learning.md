# Web 学习模块

> 词汇管理、间隔复习、学习统计

---

## 1. 模块概述

```
┌─────────────────────────────────────────────────────────────────┐
│                      学习模块架构                                │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  features/learning/                                             │
│  ├── components/                                                │
│  │   ├── Learning.tsx         学习主页                          │
│  │   ├── VocabularyList.tsx   词汇列表                          │
│  │   ├── ReviewSession.tsx    复习会话                          │
│  │   ├── WordCard.tsx         单词卡片                          │
│  │   ├── QuizMode.tsx         测验模式                          │
│  │   └── Statistics.tsx       学习统计                          │
│  ├── hooks/                                                     │
│  │   ├── useLearning.ts       学习主 Hook                       │
│  │   ├── useVocabulary.ts     词汇管理                          │
│  │   ├── useReview.ts         复习逻辑                          │
│  │   └── useSpacedRepetition.ts 间隔重复                        │
│  ├── stores/                                                    │
│  │   └── learningStore.ts     学习状态                          │
│  └── utils/                                                     │
│      └── sm2.ts               SM-2 算法                         │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 2. 词汇管理

### 2.1 词汇来源

| 来源 | 说明 |
|------|------|
| 阅读查词 | 阅读时查询的单词 |
| 手动添加 | 用户手动输入 |
| 高亮收藏 | 高亮文本中提取 |
| AI 推荐 | 基于阅读推荐 |

### 2.2 词汇状态

```
┌─────────────────────────────────────────────────────────────────┐
│                    词汇状态流转                                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  新词                                                            │
│   │                                                              │
│   ▼                                                              │
│  学习中 ◀──────────────────┐                                    │
│   │                        │                                    │
│   ▼                        │                                    │
│  复习中 ────────────────────┤ (记忆衰减)                         │
│   │                        │                                    │
│   ▼                        │                                    │
│  已掌握 ────────────────────┘                                    │
│   │                                                              │
│   ▼                                                              │
│  归档                                                            │
│                                                                  │
│  状态定义                                                        │
│  ├── 新词: 未学习过                                              │
│  ├── 学习中: 首次学习未通过                                      │
│  ├── 复习中: 进入复习周期                                        │
│  ├── 已掌握: 连续 5 次正确                                       │
│  └── 归档: 用户手动归档                                          │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 3. 间隔重复

### 3.1 SM-2 算法

| 参数 | 说明 |
|------|------|
| EF | 记忆难度系数 (1.3-2.5) |
| n | 复习次数 |
| I | 间隔天数 |

### 3.2 复习间隔计算

```
┌─────────────────────────────────────────────────────────────────┐
│                    复习间隔计算                                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  首次学习                                                        │
│  └── 第 1 次复习: 1 天后                                        │
│  └── 第 2 次复习: 6 天后                                        │
│                                                                  │
│  后续复习 (n > 2)                                               │
│  └── I(n) = I(n-1) × EF                                        │
│                                                                  │
│  评分影响 (0-5)                                                  │
│  ├── 0-2: 重新学习, EF 降低                                     │
│  ├── 3: 困难, EF 略降                                           │
│  ├── 4: 一般, EF 不变                                           │
│  └── 5: 简单, EF 提高                                           │
│                                                                  │
│  EF 计算                                                        │
│  └── EF' = EF + (0.1 - (5-q) × (0.08 + (5-q) × 0.02))          │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 4. 复习模式

### 4.1 复习形式

| 模式 | 说明 |
|------|------|
| 闪卡 | 看词回忆释义 |
| 选择题 | 选择正确释义 |
| 拼写 | 听音拼写单词 |
| 例句填空 | 根据例句填词 |

### 4.2 复习流程

```
┌─────────────────────────────────────────────────────────────────┐
│                    复习会话流程                                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  开始复习                                                        │
│       │                                                          │
│       ▼                                                          │
│  获取待复习词汇                                                  │
│  ├── 今日到期词汇                                                │
│  └── 优先显示逾期词汇                                            │
│       │                                                          │
│       ▼                                                          │
│  ┌────────────────────────────────────────────────────────┐     │
│  │                    复习循环                              │     │
│  │                                                          │     │
│  │  显示单词                                                │     │
│  │       │                                                  │     │
│  │       ▼                                                  │     │
│  │  用户回忆/作答                                           │     │
│  │       │                                                  │     │
│  │       ▼                                                  │     │
│  │  显示答案                                                │     │
│  │       │                                                  │     │
│  │       ▼                                                  │     │
│  │  用户评分 (0-5)                                          │     │
│  │       │                                                  │     │
│  │       ▼                                                  │     │
│  │  更新记忆参数                                            │     │
│  │       │                                                  │     │
│  │       ▼                                                  │     │
│  │  下一个词汇                                              │     │
│  └────────────────────────────────────────────────────────┘     │
│       │                                                          │
│       ▼                                                          │
│  复习完成                                                        │
│  ├── 显示统计                                                    │
│  └── 更新学习记录                                                │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 5. 学习统计

### 5.1 统计指标

| 指标 | 说明 |
|------|------|
| 总词汇量 | 收藏的总词汇数 |
| 已掌握 | 进入掌握状态的词汇 |
| 学习中 | 正在学习的词汇 |
| 今日新学 | 今天新学的词汇 |
| 今日复习 | 今天复习的词汇 |
| 准确率 | 复习正确率 |
| 连续天数 | 连续学习天数 |

### 5.2 统计展示

```
┌─────────────────────────────────────────────────────────────────┐
│                    学习统计面板                                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  词汇概览                                                        │
│  ┌─────────┬─────────┬─────────┬─────────┐                     │
│  │  总词汇  │  已掌握  │  学习中  │  待复习  │                     │
│  │   856   │   423   │   312   │   121   │                     │
│  └─────────┴─────────┴─────────┴─────────┘                     │
│                                                                  │
│  今日学习                                                        │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │  新学 15 词  │  复习 42 词  │  准确率 85%              │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
│  学习趋势 (近30天)                                               │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                                                          │    │
│  │   █  █                                                   │    │
│  │   █ ██ █                                                 │    │
│  │  ██ ██ ██                                                │    │
│  │  ██████████████                                          │    │
│  │  ──────────────────────────                              │    │
│  │  1  5  10  15  20  25  30                               │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 6. 学习目标

### 6.1 目标设置

| 目标类型 | 选项 |
|----------|------|
| 每日新词 | 5/10/20/自定义 |
| 每日复习 | 20/50/100/不限 |
| 学习时长 | 10/20/30 分钟 |

### 6.2 目标提醒

```
┌─────────────────────────────────────────────────────────────────┐
│                    学习提醒设置                                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  提醒类型                                                        │
│  ├── 每日复习提醒                                                │
│  ├── 连续学习提醒 (断签预警)                                     │
│  └── 周目标完成提醒                                              │
│                                                                  │
│  提醒时间                                                        │
│  └── 自定义时间设置                                              │
│                                                                  │
│  提醒方式                                                        │
│  ├── 浏览器通知                                                  │
│  └── 邮件提醒                                                    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 7. 词汇导出

### 7.1 导出格式

| 格式 | 说明 |
|------|------|
| CSV | 表格格式 |
| Anki | Anki 卡片格式 |
| JSON | 完整数据 |

### 7.2 导出内容

```
┌─────────────────────────────────────────────────────────────────┐
│                    导出字段选择                                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  基础信息                                                        │
│  ├── [✓] 单词                                                   │
│  ├── [✓] 音标                                                   │
│  ├── [✓] 释义                                                   │
│  └── [ ] 词根词缀                                               │
│                                                                  │
│  例句相关                                                        │
│  ├── [✓] 例句                                                   │
│  └── [ ] 例句翻译                                               │
│                                                                  │
│  学习记录                                                        │
│  ├── [ ] 来源书籍                                               │
│  ├── [ ] 原文上下文                                              │
│  └── [ ] 学习次数                                               │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 8. 相关文档

| 文档 | 说明 |
|------|------|
| [ai.md](./ai.md) | AI 查词 |
| [reader.md](./reader.md) | 阅读器集成 |
| [../state-management.md](../state-management.md) | 状态管理 |

---

*最后更新: 2025-12-31*

# P001: Debug â†’ Staging åŒæ­¥æµæ°´çº¿

> å°†ä¹¦å•å†…å®¹ä» Debug ç¯å¢ƒåŒæ­¥åˆ° Staging ç¯å¢ƒçš„å®Œæ•´æµæ°´çº¿

---

## ä¸€ã€æµæ°´çº¿æ¦‚è¿°

```mermaid
flowchart TD
    A["è¾“å…¥<br>ä¹¦å•æ–‡ä»¶<br>(ç”µå­ä¹¦+æœ‰å£°ä¹¦)"] --> pipeline
    subgraph pipeline["å¤„ç†æµæ°´çº¿"]
        direction LR
        S1["Stage 1<br>è¾“å…¥éªŒè¯"] --> S2["Stage 2<br>è¡¨ç»“æ„"] --> S3["Stage 3<br>æ–‡ä»¶ä¸Šä¼ "] --> S4["Stage 4<br>æ•°æ®å¡«å……"] --> S45["4.5<br>åˆ†ç±»"] --> S46["4.6<br>Tab"] --> S47["4.7<br>å¤´åƒ"] --> S48["4.8<br>æ¨è"] --> S49["4.9<br>æ ‡é¢˜"] --> S410["4.10<br>ç¿»è¯‘"] --> S5["Stage 5<br>å…ƒæ•°æ®"] --> S6["Stage 6<br>APIéªŒè¯"] --> S7["Stage 7<br>éƒ¨ç½²"]
    end
    pipeline --> Z["è¾“å‡º<br>Staging ç¯å¢ƒ<br>å®Œæ•´æ•°æ®"]
```

### 1.1 åŸºæœ¬ä¿¡æ¯

| å±æ€§ | å€¼ |
|------|-----|
| æµæ°´çº¿ç¼–å· | P001 |
| åç§° | Debug â†’ Staging åŒæ­¥ |
| è¾“å…¥æ¥æº | `data/booklists/v1/phase1-ebooks.json`, `data/booklists/v1/phase1-authors.json` |
| è¾“å‡ºç›®æ ‡ | Staging ç¯å¢ƒ (æ•°æ®åº“ + R2 å­˜å‚¨) |
| æ•°æ®æ¥æº | Debug ç¯å¢ƒ (ä¼˜å…ˆ) + Standard Ebooks (å¤‡é€‰) |
| æ‰§è¡Œæ¨¡å¼ | æ‰‹åŠ¨è§¦å‘ (Droplet PM2) |

### 1.2 ä½¿ç”¨åœºæ™¯

| åœºæ™¯ | æè¿° |
|------|------|
| æ–°ä¹¦ä¸Šæ¶ | å°†éªŒè¯è¿‡çš„æ–°ä¹¦ä» Debug åŒæ­¥åˆ° Staging |
| ç‰ˆæœ¬å‘å¸ƒå‡†å¤‡ | å‘å¸ƒå‰å°†å®Œæ•´ä¹¦å•åŒæ­¥åˆ° Staging |
| å†…å®¹æ›´æ–° | æ›´æ–°ç°æœ‰ä¹¦ç±çš„å…ƒæ•°æ®æˆ–æ–‡ä»¶ |

### 1.3 Phase 1 åŒæ­¥æµç¨‹å›¾

```mermaid
flowchart TD
    subgraph header["Phase 1 Staging åŒæ­¥æµç¨‹"]
        direction LR
        SRC["SOURCE: Debug ç¯å¢ƒ"] ~~~ TGT["TARGET: Staging ç¯å¢ƒ"]
    end

    S1["1. æ•°æ®æº: Phase 1 ä¹¦å• JSON<br>data/booklists/v1/<br>phase1-ebooks.json (248æœ¬)<br>phase1-authors.json (100ä½)"]
    S2["2. ä½œè€…åŒæ­¥ (100ä½)"]
    S3["3. ä¹¦ç±åŒæ­¥ (248æœ¬)"]
    S4["4. æ–‡ä»¶åŒæ­¥ (EPUB/å°é¢)"]
    S5["5. ç« èŠ‚åŒæ­¥"]

    header --> S1
    S1 --> S2
    S2 --> S3
    S3 --> S4
    S4 --> S5

    subgraph sync2["ä½œè€…åŒæ­¥"]
        D2["Debug Neon DB<br>(authors è¡¨)<br>606 authors"] -->|"SQL INSERT"| T2["Staging Neon DB<br>(authors è¡¨)<br>~75-100 authors"]
    end
    S2 --- sync2

    subgraph sync3["ä¹¦ç±åŒæ­¥"]
        D3["Debug Neon DB<br>(books è¡¨)<br>65,208 books"] -->|"SQL INSERT"| T3["Staging Neon DB<br>(books è¡¨)<br>~205 books"]
    end
    S3 --- sync3

    subgraph sync4["æ–‡ä»¶åŒæ­¥"]
        D4["Debug R2 Bucket<br>readmigo-debug<br>epubs/ covers/"] -->|"COPY"| T4["Staging R2 Bucket<br>readmigo-staging<br>epubs/ covers/"]
    end
    S4 --- sync4

    subgraph sync5["ç« èŠ‚åŒæ­¥"]
        D5["Debug Neon DB<br>(chapters è¡¨)"] -->|"SQL INSERT"| T5["Staging Neon DB<br>(chapters è¡¨)"]
    end
    S5 --- sync5
```

---

## äºŒã€è¾“å…¥è§„èŒƒ

### 2.1 ä¹¦å•æ–‡ä»¶æ ¼å¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ä¹¦å•è¾“å…¥æ ¼å¼                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚   ä¹¦å•æ–‡ä»¶ä½ç½®: data/booklists/{version}/                                             â”‚
â”‚                                                                                       â”‚
â”‚   Phase 1 æ–‡ä»¶:                                                                       â”‚
â”‚   â”œâ”€â”€ phase1-ebooks.json    - ç”µå­ä¹¦åˆ—è¡¨                                             â”‚
â”‚   â””â”€â”€ phase1-authors.json   - ä½œè€…åˆ—è¡¨                                               â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  phase1-ebooks.json ç»“æ„                                                     â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚  {                                                                           â”‚   â”‚
â”‚   â”‚    "totalInDocument": 300,        // åŸå§‹æ–‡æ¡£ä¸­çš„ä¹¦ç±æ•°                       â”‚   â”‚
â”‚   â”‚    "totalUnique": 248,            // å»é‡åçš„å”¯ä¸€ä¹¦ç±æ•°                       â”‚   â”‚
â”‚   â”‚    "note": "...",                 // é‡å¤è¯´æ˜                                 â”‚   â”‚
â”‚   â”‚    "generatedAt": "...",          // ç”Ÿæˆæ—¶é—´                                 â”‚   â”‚
â”‚   â”‚    "books": [                                                                 â”‚   â”‚
â”‚   â”‚      {                                                                        â”‚   â”‚
â”‚   â”‚        "title": "Pride and Prejudice",                                       â”‚   â”‚
â”‚   â”‚        "author": "Jane Austen",                                              â”‚   â”‚
â”‚   â”‚        "chineseTitle": "å‚²æ…¢ä¸åè§",                                          â”‚   â”‚
â”‚   â”‚        "section": "1.1 P0 æ ¸å¿ƒå¿…é€‰..."                                        â”‚   â”‚
â”‚   â”‚      }                                                                        â”‚   â”‚
â”‚   â”‚    ]                                                                          â”‚   â”‚
â”‚   â”‚  }                                                                            â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  phase1-authors.json ç»“æ„                                                    â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚  {                                                                           â”‚   â”‚
â”‚   â”‚    "total": 100,                  // ä½œè€…æ€»æ•°                                 â”‚   â”‚
â”‚   â”‚    "generatedAt": "...",          // ç”Ÿæˆæ—¶é—´                                 â”‚   â”‚
â”‚   â”‚    "authors": [                                                               â”‚   â”‚
â”‚   â”‚      {                                                                        â”‚   â”‚
â”‚   â”‚        "name": "William Shakespeare",                                        â”‚   â”‚
â”‚   â”‚        "nationality": "è‹±å›½ UK",                                              â”‚   â”‚
â”‚   â”‚        "era": "16-17ä¸–çºª 16-17th C",                                         â”‚   â”‚
â”‚   â”‚        "representativeWork": "37"                                             â”‚   â”‚
â”‚   â”‚      }                                                                        â”‚   â”‚
â”‚   â”‚    ]                                                                          â”‚   â”‚
â”‚   â”‚  }                                                                            â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   ç”Ÿæˆå‘½ä»¤: npx tsx scripts/extract-phase1-lists.ts                                  â”‚
â”‚   åŸå§‹æ•°æ®: docs/06-content/staging-phase1-booklist.md                               â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 è¾“å…¥éªŒè¯è§„åˆ™

| å­—æ®µ | éªŒè¯è§„åˆ™ |
|------|----------|
| identifier | å¿…å¡«ï¼Œå”¯ä¸€ï¼Œæ ¼å¼ç¬¦åˆæ¥æºè§„èŒƒ |
| source | å¿…å¡«ï¼Œåœ¨å…è®¸çš„æ¥æºåˆ—è¡¨å†… |
| title | å¿…å¡«ï¼Œéç©ºå­—ç¬¦ä¸² |
| priority | å¿…å¡«ï¼ŒP0/P1/P2 ä¹‹ä¸€ |
| language | å¿…å¡«ï¼Œæ”¯æŒçš„è¯­è¨€ä»£ç  |

---

## ä¸‰ã€é˜¶æ®µå®šä¹‰

### 3.1 Stage 1: è¾“å…¥éªŒè¯

```mermaid
flowchart LR
    subgraph S1["Stage 1: è¾“å…¥éªŒè¯"]
        A["è¯»å–ä¹¦å•<br>JSON è§£æ<br>ç¼–ç éªŒè¯"] --> B["æ ¼å¼æ ¡éªŒ<br>å¿…å¡«å­—æ®µ<br>ç±»å‹æ£€æŸ¥"] --> C["é‡å¤æ£€æµ‹<br>Stagingä¸­<br>å·²å­˜åœ¨ä¹¦"] --> D["ä¾èµ–æ£€æŸ¥<br>ä½œè€…å­˜åœ¨<br>åˆ†ç±»å­˜åœ¨"]
    end
```

| æ£€æŸ¥é¡¹ | è¯´æ˜ | å¤±è´¥å¤„ç† |
|--------|------|----------|
| JSON æ ¼å¼ | æ–‡ä»¶å¿…é¡»æ˜¯æœ‰æ•ˆ JSON | ç»ˆæ­¢æµæ°´çº¿ |
| å¿…å¡«å­—æ®µ | æ‰€æœ‰å¿…å¡«å­—æ®µå­˜åœ¨ | è®°å½•é”™è¯¯ï¼Œè·³è¿‡æ¡ç›® |
| ID å”¯ä¸€æ€§ | ä¹¦å•å†…æ— é‡å¤ ID | è®°å½•è­¦å‘Šï¼Œä¿ç•™ç¬¬ä¸€ä¸ª |
| Staging æŸ¥é‡ | æ£€æŸ¥ Staging æ˜¯å¦å·²æœ‰ | è·³è¿‡ï¼Œè®°å½•æ—¥å¿— |
| ä¾èµ–æ£€æŸ¥ | ä½œè€…/åˆ†ç±»æ˜¯å¦å­˜åœ¨ | è®°å½•è­¦å‘Šï¼Œåç»­è‡ªåŠ¨åˆ›å»º |

### 3.2 Stage 2: è¡¨ç»“æ„åŒæ­¥

```mermaid
flowchart TD
    subgraph S2["Stage 2: è¡¨ç»“æ„åŒæ­¥"]
        A["Debug ç¯å¢ƒ<br>books / authors / audiobooks<br>è¯»å– Schema å’Œæ•°æ®"] --> B["Schema æ¯”å¯¹<br>æ£€æŸ¥è¡¨ç»“æ„æ˜¯å¦ä¸€è‡´<br>è¯†åˆ«æ–°å¢/ä¿®æ”¹çš„å­—æ®µ<br>ç”Ÿæˆè¿ç§»è„šæœ¬ (å¦‚éœ€è¦)"] --> C["Staging ç¯å¢ƒ<br>æ‰§è¡Œå¿…è¦çš„è¿ç§»<br>éªŒè¯è¡¨ç»“æ„ä¸€è‡´"]
    end
```

| æ“ä½œ | è¯´æ˜ |
|------|------|
| Schema è¯»å– | è¯»å– Debug ç¯å¢ƒçš„è¡¨ç»“æ„ |
| Schema æ¯”å¯¹ | ä¸ Staging ç¯å¢ƒæ¯”å¯¹å·®å¼‚ |
| è¿ç§»ç”Ÿæˆ | ç”Ÿæˆå¿…è¦çš„ ALTER è¯­å¥ |
| è¿ç§»æ‰§è¡Œ | åœ¨ Staging æ‰§è¡Œè¿ç§» |
| éªŒè¯ç¡®è®¤ | ç¡®è®¤è¡¨ç»“æ„ä¸€è‡´ |

### 3.3 Stage 3: æ–‡ä»¶ä¸Šä¼ 

```mermaid
flowchart TD
    subgraph S3["Stage 3: æ–‡ä»¶ä¸Šä¼ "]
        DR2["Debug R2 Bucket<br>readmigo-debug/<br>epubs/ covers/<br>audiobooks/ authors/"] -->|"COPY"| SR2["Staging R2 Bucket<br>readmigo-staging/<br>epubs/ covers/<br>audiobooks/ authors/"]
    end

    subgraph S3flow["å¤„ç†æµç¨‹"]
        direction LR
        A["æ¸…å•ç”Ÿæˆ<br>åˆ—å‡ºéœ€è¦çš„æ–‡ä»¶"] --> B["å­˜åœ¨æ£€æŸ¥<br>æ£€æŸ¥ç›®æ ‡æ˜¯å¦å·²æœ‰"] --> C["æ–‡ä»¶å¤åˆ¶<br>R2 å¤åˆ¶<br>è¿›åº¦è¿½è¸ª"] --> D["å®Œæ•´æ€§éªŒè¯<br>å¤§å°æ ¡éªŒ<br>å“ˆå¸Œå¯¹æ¯”"]
    end
```

| æ–‡ä»¶ç±»å‹ | æ¥æºè·¯å¾„ | ç›®æ ‡è·¯å¾„ | å¤„ç†æ–¹å¼ |
|----------|----------|----------|----------|
| EPUB æ–‡ä»¶ | epubs/{id}.epub | epubs/{id}.epub | ç›´æ¥å¤åˆ¶ |
| ä¹¦ç±å°é¢ | covers/books/{id}.jpg | covers/books/{id}.jpg | ç›´æ¥å¤åˆ¶ |
| å°é¢ç¼©ç•¥å›¾ | covers/books/{id}-thumb.jpg | covers/books/{id}-thumb.jpg | ç›´æ¥å¤åˆ¶ |
| éŸ³é¢‘æ–‡ä»¶ | audiobooks/{id}/chapters/*.mp3 | audiobooks/{id}/chapters/*.mp3 | ç›´æ¥å¤åˆ¶ |
| ä½œè€…å¤´åƒ | authors/{id}/*.jpg | authors/{id}/*.jpg | ç›´æ¥å¤åˆ¶ |

### 3.4 Stage 4: æ•°æ®å¡«å……

```mermaid
flowchart TD
    subgraph S4["Stage 4: æ•°æ®å¡«å……"]
        subgraph sources["æ•°æ®æ¥æº: å…¬å¼€æ¸ é“ (é Seed)"]
            direction LR
            G["Gutenberg<br>å…ƒæ•°æ® / ç« èŠ‚"] ~~~ SE["Standard Ebooks<br>å…ƒæ•°æ® / ç« èŠ‚"] ~~~ W["Wikidata<br>ä½œè€…ä¿¡æ¯ / é“¾æ¥"] ~~~ LV["LibriVox<br>éŸ³é¢‘ / æœ—è¯»è€…"]
        end

        subgraph flow["å¡«å……æµç¨‹"]
            direction LR
            F1["ä½œè€…å¤„ç†<br>æ–°ä½œè€…åˆ›å»º<br>ä¿¡æ¯å¢å¼º (Wikidata)"] --> F2["ä¹¦ç±å¡«å……<br>å…ƒæ•°æ®<br>åˆ†ç±»æ˜ å°„ / éš¾åº¦åˆ†æ"] --> F3["ç« èŠ‚è§£æ<br>EPUB è§£æ<br>ç›®å½•æå–"] --> F4["å…³è”å»ºç«‹<br>ä¹¦-ä½œè€…<br>ç”µå­-æœ‰å£°"]
        end

        subgraph order["æ•°æ®è¡¨å¡«å……é¡ºåº"]
            T1["1. authors"] --> T2["2. books"] --> T3["3. chapters"]
            T2 --> T4["4. audiobooks"] --> T5["5. audio_chapters"]
            T4 --> T6["6. book_audiobook_links"]
        end
    end
```

| æ•°æ®è¡¨ | æ•°æ®æ¥æº | å¡«å……å†…å®¹ |
|--------|----------|----------|
| authors | Wikidata / æ‰‹åŠ¨ | å§“åã€ç”Ÿå’å¹´ã€ç®€ä»‹ã€å¤´åƒURL |
| books | Gutenberg / Standard Ebooks | ä¹¦åã€æè¿°ã€åˆ†ç±»ã€éš¾åº¦ã€å°é¢URL |
| chapters | EPUB è§£æ | ç« èŠ‚æ ‡é¢˜ã€é¡ºåºã€å†…å®¹è·¯å¾„ |
| audiobooks | LibriVox | ä¹¦åã€æœ—è¯»è€…ã€æ—¶é•¿ã€éŸ³é¢‘URL |
| audio_chapters | LibriVox | ç« èŠ‚éŸ³é¢‘ã€æ—¶é•¿ã€é¡ºåº |
| book_audiobook_links | å…³è”é€»è¾‘ | ç”µå­ä¹¦-æœ‰å£°ä¹¦å¯¹åº”å…³ç³» |

### 3.5 Stage 4.5: åˆ†ç±»æ•°æ®ç”Ÿæˆ (Category Generation)

```mermaid
flowchart TD
    subgraph S45["Stage 4.5: åˆ†ç±»æ•°æ®ç”Ÿæˆ (ä»ä¹¦ç±è®¡ç®—)"]
        BT["Book Table genres å­—æ®µ"] --> NORM["Genre å½’ä¸€åŒ– & å±‚çº§æ˜ å°„"] --> HIER["å±‚çº§åˆ†ç±»ç»“æ„<br>Root (level=0) â†’ Child (level=1)"]

        subgraph proc["å¤„ç†æµç¨‹"]
            direction LR
            P1["æ¸…ç†æ—§æ•°æ® (å¯é€‰)<br>--clean æ¨¡å¼<br>åˆ é™¤æ—§åˆ†ç±»"] --> P2["è¯»å–ä¹¦ç± genres<br>å½’ä¸€åŒ– / å»é‡ç»Ÿè®¡"] --> P3["ç”Ÿæˆåˆ†ç±»å±‚çº§ç»“æ„<br>Root åˆ†ç±» / Child åˆ†ç±»"] --> P4["åˆ›å»ºå…³è” / æ›´æ–°è®¡æ•°<br>BookCategory / bookCount"]
        end
    end
```

### 3.6 Stage 4.6: å‘ç°é¡µ Tab ç”Ÿæˆ (Discover Tabs)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Stage 4.6: å‘ç°é¡µ Tab ç”Ÿæˆ                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚   ä¾èµ–: Stage 4.5 å®Œæˆåæ‰§è¡Œ                                                          â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                          æ•°æ®æ¥æº: categories è¡¨                             â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   categories (level=0, isActive=true)                                        â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ Fiction          â”€â”€â–º ç›´æ¥å…³è”ä¹¦ç±æ•° + å­åˆ†ç±»å…³è”ä¹¦ç±æ•° = æ€»æ•°           â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ Classics         â”€â”€â–º 207 books                                         â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ Adventure        â”€â”€â–º 49 books                                          â”‚   â”‚
â”‚   â”‚   â””â”€â”€ ...                                                                     â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   âš ï¸ æ³¨æ„: bookCount éœ€è¦åŒ…å«:                                                â”‚   â”‚
â”‚   â”‚      1. ç›´æ¥å…³è”åˆ° Root åˆ†ç±»çš„ä¹¦ç± (book.genres åŒ…å« "Classics")             â”‚   â”‚
â”‚   â”‚      2. å…³è”åˆ° Child åˆ†ç±»çš„ä¹¦ç± (book.genres åŒ…å« "Classic Literature")      â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   è¾“å‡ºè¡¨: discover_tabs                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   discover_tabs                                                              â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ id                                                                      â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ slug            (æ¥è‡ª category.slug)                                   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ name / nameEn   (æ¥è‡ª category)                                        â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ type = "category"                                                       â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ categoryId      (å…³è” category)                                        â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ icon            (æ ¹æ® slug æ˜ å°„)                                        â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ sortOrder       (æŒ‰ä¹¦ç±æ•°é‡é™åº)                                        â”‚   â”‚
â”‚   â”‚   â””â”€â”€ isActive                                                                â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   æ‰§è¡Œè„šæœ¬: scripts/sync-discover-tabs.ts                                           â”‚
â”‚                                                                                       â”‚
â”‚   å‘½ä»¤:                                                                               â”‚
â”‚   DATABASE_URL='staging-url' npx tsx scripts/sync-discover-tabs.ts                  â”‚
â”‚                                                                                       â”‚
â”‚   âš ï¸ ç¼“å­˜æ³¨æ„: API è¿”å›çš„ discover/tabs æ•°æ®ä¼šè¢« Redis ç¼“å­˜ 1 å°æ—¶                   â”‚
â”‚               æ›´æ–°æ•°æ®åº“åéœ€ç­‰å¾…ç¼“å­˜è¿‡æœŸæˆ–æ‰‹åŠ¨æ¸…ç†                                     â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.7 Stage 4.7: ä½œè€…å¤´åƒä¿®å¤ (Author Avatar Fix)

```mermaid
flowchart LR
    subgraph S47["Stage 4.7: ä½œè€…å¤´åƒä¿®å¤"]
        A["æŸ¥è¯¢æœ‰å¤´åƒçš„ä½œè€…<br>avatarUrl IS NOT NULL"] --> B["å½’ä¸€åŒ–åç§°<br>å»ºç«‹æ˜ å°„<br>normalize() nameâ†’avatar"] --> C["æŸ¥è¯¢æ— å¤´åƒçš„ä½œè€…<br>avatarUrl IS NULL"] --> D["åŒ¹é…å¹¶æ›´æ–°<br>UPDATE SET avatar"]
    end
```

### 3.8 Stage 4.8: æ¨èæœåŠ¡éªŒè¯ (Recommendation Service Validation)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Stage 4.8: æ¨èæœåŠ¡éªŒè¯                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚   é—®é¢˜èƒŒæ™¯:                                                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   æ¨èæœåŠ¡æŒ‰åˆ†ç±»ç­›é€‰æ—¶éœ€è¦åŒ…å«å­åˆ†ç±»çš„ä¹¦ç±                                       â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   é”™è¯¯å®ç° âŒ:                                                                 â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚   â”‚   â”‚   where: {                                                           â”‚   â”‚   â”‚
â”‚   â”‚   â”‚     categories: { some: { categoryId: parentCategoryId } }          â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   }                                                                  â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   // åªæŸ¥è¯¢ç›´æ¥å…³è”åˆ°çˆ¶åˆ†ç±»çš„ä¹¦ç±                                      â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   // æ¼æ‰å…³è”åˆ°å­åˆ†ç±»çš„ä¹¦ç±!                                          â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   æ­£ç¡®å®ç° âœ“:                                                                 â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚   â”‚   â”‚   // å…ˆæŸ¥è¯¢å­åˆ†ç±»                                                     â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   const childCategories = await prisma.category.findMany({          â”‚   â”‚   â”‚
â”‚   â”‚   â”‚     where: { parentId: categoryId, isActive: true },                â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   });                                                                â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   const categoryIds = [categoryId, ...childCategories.map(c=>c.id)];â”‚   â”‚   â”‚
â”‚   â”‚   â”‚                                                                      â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   where: {                                                           â”‚   â”‚   â”‚
â”‚   â”‚   â”‚     categories: { some: { categoryId: { in: categoryIds } } }       â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   }                                                                  â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   éªŒè¯æµç¨‹:                                                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚ è·å–æ‰€æœ‰    â”‚â”€â”€â”€â–ºâ”‚ é€ä¸ªåˆ†ç±»    â”‚â”€â”€â”€â–ºâ”‚ éªŒè¯è¿”å›    â”‚â”€â”€â”€â–ºâ”‚ è®°å½•ç»“æœ    â”‚         â”‚
â”‚   â”‚ çˆ¶åˆ†ç±»      â”‚    â”‚ è°ƒç”¨ API    â”‚    â”‚ ä¹¦ç±æ•°é‡    â”‚    â”‚             â”‚         â”‚
â”‚   â”‚             â”‚    â”‚             â”‚    â”‚             â”‚    â”‚             â”‚         â”‚
â”‚   â”‚ level = 0   â”‚    â”‚ categoryId  â”‚    â”‚ total > 0   â”‚    â”‚ æˆåŠŸ/å¤±è´¥   â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                                       â”‚
â”‚   éªŒè¯å‘½ä»¤:                                                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   # è·å–æ‰€æœ‰åˆ†ç±»çš„ä¹¦ç±æ•°é‡                                                     â”‚   â”‚
â”‚   â”‚   for tab in $(curl -s $API/discover/tabs | jq -r '.[].categoryId'); do      â”‚   â”‚
â”‚   â”‚     count=$(curl -s "$API/discover/books?categoryId=$tab" | jq '.total')     â”‚   â”‚
â”‚   â”‚     echo "$tab: $count books"                                                 â”‚   â”‚
â”‚   â”‚   done                                                                        â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   é¢„æœŸç»“æœ (æ¯ä¸ªåˆ†ç±»éƒ½åº”æœ‰ä¹¦ç±):                                                â”‚   â”‚
â”‚   â”‚   classics: 199                                                               â”‚   â”‚
â”‚   â”‚   fiction: 61                                                                 â”‚   â”‚
â”‚   â”‚   adventure-fantasy: 49                                                       â”‚   â”‚
â”‚   â”‚   drama-poetry: 27                                                            â”‚   â”‚
â”‚   â”‚   mystery-thriller: 31                                                        â”‚   â”‚
â”‚   â”‚   ...                                                                         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   å…³é”®æ–‡ä»¶:                                                                           â”‚
â”‚   apps/backend/src/modules/recommendation/recommendation.service.ts:73-84           â”‚
â”‚                                                                                       â”‚
â”‚   âš ï¸ æ³¨æ„: æ­¤éªŒè¯å¿…é¡»åœ¨ Stage 4.5 (åˆ†ç±»ç”Ÿæˆ) å’Œ Stage 4.6 (Tabç”Ÿæˆ) ä¹‹åæ‰§è¡Œ         â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.9 Stage 4.9: æ ‡é¢˜æ¸…æ´— (Title Cleaning)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Stage 4.9: æ ‡é¢˜æ¸…æ´—                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚   é—®é¢˜èƒŒæ™¯:                                                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   Standard Ebooks å¯¼å…¥çš„ä¹¦ç±æ ‡é¢˜åŒ…å«ä½œè€…åç¼€                                     â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   åŸå§‹æ ¼å¼:  "The Age of Innocence by Edith Wharton"                         â”‚   â”‚
â”‚   â”‚   æœŸæœ›æ ¼å¼:  "The Age of Innocence"                                           â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   é—®é¢˜å½±å“:                                                                    â”‚   â”‚
â”‚   â”‚   â€¢ æ ‡é¢˜æ˜¾ç¤ºå†—ä½™ä¿¡æ¯                                                           â”‚   â”‚
â”‚   â”‚   â€¢ æœç´¢ä½“éªŒå—å½±å“                                                             â”‚   â”‚
â”‚   â”‚   â€¢ å¤šè¯­è¨€ç¿»è¯‘å¤æ‚åº¦å¢åŠ                                                         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   å¤„ç†æµç¨‹:                                                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   1. æŸ¥æ‰¾åŒ…å« " by " çš„æ ‡é¢˜                                                    â”‚   â”‚
â”‚   â”‚   2. æå– " by " åçš„å†…å®¹                                                       â”‚   â”‚
â”‚   â”‚   3. ä¸ author å­—æ®µå¯¹æ¯” (æ™ºèƒ½åŒ¹é…å¤„ç†å„ç§æ ¼å¼å·®å¼‚)                              â”‚   â”‚
â”‚   â”‚   4. åŒ¹é…æˆåŠŸåˆ™ç§»é™¤åç¼€                                                         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   ä½œè€…ååŒ¹é…è§„åˆ™:                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   æ ‡é¢˜åç¼€: "Charles Dickens"                                                  â”‚   â”‚
â”‚   â”‚   ä½œè€…å­—æ®µ: "Dickens, Charles, 1812-1870"                                      â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   åŒ¹é…è¿‡ç¨‹:                                                                    â”‚   â”‚
â”‚   â”‚   1. ç§»é™¤å¹´ä»½: "Dickens, Charles"                                              â”‚   â”‚
â”‚   â”‚   2. ç§»é™¤æ‹¬å·å†…å®¹                                                              â”‚   â”‚
â”‚   â”‚   3. åˆ†è¯: ["dickens", "charles"]                                              â”‚   â”‚
â”‚   â”‚   4. äº¤å‰åŒ¹é…: è‡³å°‘2ä¸ªè¯åŒ¹é…                                                    â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   æ‰§è¡Œå‘½ä»¤:                                                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   npx ts-node -r tsconfig-paths/register \                                    â”‚   â”‚
â”‚   â”‚     src/scripts/data-enrichment/clean-book-titles.ts                         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   å…³é”®æ–‡ä»¶:                                                                           â”‚
â”‚   apps/backend/src/scripts/data-enrichment/clean-book-titles.ts                     â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.10 Stage 4.10: ç¿»è¯‘æ•°æ®å¡«å…… (Translation Enrichment)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Stage 4.10: ç¿»è¯‘æ•°æ®å¡«å……                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚   ç›®çš„:                                                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   ä¸ºä¸­æ–‡ç”¨æˆ·æä¾›æœ¬åœ°åŒ–çš„ä¹¦åå’Œä½œè€…å                                             â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   åŸå§‹ (è‹±æ–‡):  "Pride and Prejudice" by "Jane Austen"                        â”‚   â”‚
â”‚   â”‚   ç¿»è¯‘ (ä¸­æ–‡):  "å‚²æ…¢ä¸åè§" by "ç®€Â·å¥¥æ–¯æ±€"                                    â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   æŠ€æœ¯æ¶æ„:                                                                    â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚   â”‚
â”‚   â”‚   â”‚   API   â”‚â”€â”€â”€â”€â–ºâ”‚ Localeä¸­é—´ä»¶ â”‚â”€â”€â”€â”€â–ºâ”‚ LocalizationService â”‚              â”‚   â”‚
â”‚   â”‚   â”‚ Request â”‚     â”‚Accept-Languageâ”‚    â”‚ (æŸ¥è¯¢translationsè¡¨) â”‚              â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   æ•°æ®æ¥æº:                                                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   ä¼˜å…ˆçº§ 1: Wikidata                                                          â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ä½¿ç”¨ SPARQL æŸ¥è¯¢ä¹¦ç±/ä½œè€…çš„ä¸­æ–‡æ ‡ç­¾                                       â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ç›´æ¥è·å– zh-Hans å’Œ zh-Hant ç‰ˆæœ¬                                         â”‚   â”‚
â”‚   â”‚   â””â”€â”€ API å»¶è¿Ÿ: 500ms                                                         â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   ä¼˜å…ˆçº§ 2: è±†ç“£ Douban (Fallback)                                              â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ æœç´¢ä¹¦ç±è·å–ä¸­æ–‡ä¹¦å/ä½œè€…                                                 â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ æœç´¢ç»“æœéªŒè¯åŒ¹é…åº¦                                                        â”‚   â”‚
â”‚   â”‚   â””â”€â”€ API å»¶è¿Ÿ: 2000ms (å—é™)                                                  â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   è¡¥å……: OpenCC ç¹ç®€è½¬æ¢                                                         â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ä» zh-Hans è‡ªåŠ¨ç”Ÿæˆ zh-Hant                                              â”‚   â”‚
â”‚   â”‚   â””â”€â”€ é…ç½®: s2twp (ç®€ä½“åˆ°å°æ¹¾ç¹ä½“å¸¦è¯æ±‡è½¬æ¢)                                     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   translations è¡¨ç»“æ„:                                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   entityType  â”‚ entityId  â”‚ fieldName â”‚ locale   â”‚ value     â”‚ source      â”‚   â”‚
â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   â”‚
â”‚   â”‚   book        â”‚ uuid      â”‚ title     â”‚ zh-Hans  â”‚ å‚²æ…¢ä¸åè§ â”‚ wikidata    â”‚   â”‚
â”‚   â”‚   book        â”‚ uuid      â”‚ title     â”‚ zh-Hant  â”‚ å‚²æ…¢èˆ‡åè¦‹ â”‚ opencc      â”‚   â”‚
â”‚   â”‚   book        â”‚ uuid      â”‚ author    â”‚ zh-Hans  â”‚ ç®€Â·å¥¥æ–¯æ±€  â”‚ wikidata    â”‚   â”‚
â”‚   â”‚   author      â”‚ uuid      â”‚ name      â”‚ zh-Hans  â”‚ ç®€Â·å¥¥æ–¯æ±€  â”‚ wikidata    â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   æ‰§è¡Œå‘½ä»¤:                                                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   # å¿«é€Ÿæ¨¡å¼ (ä»… Wikidata)                                                     â”‚   â”‚
â”‚   â”‚   npx ts-node -r tsconfig-paths/register \                                    â”‚   â”‚
â”‚   â”‚     src/scripts/data-enrichment/wikidata-book-enrichment.ts 500              â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   # å®Œæ•´æ¨¡å¼ (Douban + Wikidata + OpenCC)                                      â”‚   â”‚
â”‚   â”‚   npx ts-node -r tsconfig-paths/register \                                    â”‚   â”‚
â”‚   â”‚     src/scripts/data-enrichment/batch-enrichment.ts \                        â”‚   â”‚
â”‚   â”‚     --entity=all --limit=500                                                  â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   # éªŒè¯è¦†ç›–ç‡                                                                 â”‚   â”‚
â”‚   â”‚   psql $DATABASE_URL -c "SELECT locale, COUNT(*) FROM translations \          â”‚   â”‚
â”‚   â”‚     WHERE entity_type='book' GROUP BY locale"                                 â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   å…³é”®æ–‡ä»¶:                                                                           â”‚
â”‚   â”œâ”€â”€ apps/backend/src/scripts/data-enrichment/wikidata-book-enrichment.ts        â”‚
â”‚   â”œâ”€â”€ apps/backend/src/scripts/data-enrichment/batch-enrichment.ts                â”‚
â”‚   â”œâ”€â”€ apps/backend/src/scripts/data-enrichment/wikidata-client.ts                 â”‚
â”‚   â”œâ”€â”€ apps/backend/src/scripts/data-enrichment/douban-client.ts                   â”‚
â”‚   â”œâ”€â”€ apps/backend/src/scripts/data-enrichment/opencc-converter.ts                â”‚
â”‚   â”œâ”€â”€ apps/backend/src/scripts/data-enrichment/seed-category-translations.ts     â”‚
â”‚   â”œâ”€â”€ apps/backend/src/scripts/data-enrichment/enrich-author-translations.ts     â”‚
â”‚   â””â”€â”€ apps/backend/src/common/localization/localization.service.ts                â”‚
â”‚                                                                                       â”‚
â”‚   âš ï¸ é‡è¦: RecommendationController å·²é›†æˆ LocalizationService                       â”‚
â”‚   âš ï¸ iOS å®¢æˆ·ç«¯å·²å‘é€ Accept-Language header                                         â”‚
â”‚   âš ï¸ æ­¤æ­¥éª¤å¿…é¡»åœ¨ Stage 4.9 (æ ‡é¢˜æ¸…æ´—) ä¹‹åæ‰§è¡Œ                                       â”‚
â”‚                                                                                       â”‚
â”‚   ğŸ“Š å½“å‰ç¿»è¯‘è¦†ç›–ç‡ (2026-01-01):                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   å®ä½“ç±»å‹    â”‚ å·²ç¿»è¯‘  â”‚ æ€»æ•°   â”‚ è¦†ç›–ç‡  â”‚ æ•°æ®æ¥æº                         â”‚   â”‚
â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   â”‚
â”‚   â”‚   Categories â”‚ 58/58   â”‚ 100%   â”‚  âœ…     â”‚ seed-category-translations.ts    â”‚   â”‚
â”‚   â”‚   Authors    â”‚ 216/216 â”‚ 100%   â”‚  âœ…     â”‚ enrich-author-translations.ts    â”‚   â”‚
â”‚   â”‚   Books      â”‚ 346/346 â”‚ 100%   â”‚  âœ…     â”‚ seed-book-translations.ts        â”‚   â”‚
â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   â”‚
â”‚   â”‚   æ€»ä½“è¯„ä¼°: åˆ†ç±»ã€ä½œè€…ã€ä¹¦ç±ç¿»è¯‘å…¨éƒ¨å®Œæˆ (100%)                                â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.11 Stage 5: å…ƒæ•°æ®ç”Ÿæˆä¸éªŒè¯

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           Stage 5: å…ƒæ•°æ®ç”Ÿæˆä¸éªŒè¯                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                           å…ƒæ•°æ®åˆ†ç±»                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  ğŸ“š ä¹¦ç±æ ¸å¿ƒå…ƒæ•°æ® (Book)                                                     â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚  åŸºç¡€ä¿¡æ¯:                                                                    â”‚   â”‚
â”‚   â”‚  â€¢ title / titlePinyin / titleNormalized                                     â”‚   â”‚
â”‚   â”‚  â€¢ author / authorNormalized / authorId                                      â”‚   â”‚
â”‚   â”‚  â€¢ description                                                                â”‚   â”‚
â”‚   â”‚  â€¢ language / languageVariant                                                 â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚  åˆ†ç±»ä¸æ ‡ç­¾:                                                                  â”‚   â”‚
â”‚   â”‚  â€¢ subjects[] / genres[]                                                      â”‚   â”‚
â”‚   â”‚  â€¢ categories (å…³è”è¡¨)                                                        â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚  æ–‡ä»¶å¼•ç”¨:                                                                    â”‚   â”‚
â”‚   â”‚  â€¢ epubUrl / coverUrl / coverThumbUrl                                        â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚  ç»Ÿè®¡ä¿¡æ¯:                                                                    â”‚   â”‚
â”‚   â”‚  â€¢ wordCount / chapterCount / estimatedReadingMinutes                        â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚  éš¾åº¦è¯„ä¼°:                                                                    â”‚   â”‚
â”‚   â”‚  â€¢ difficultyScore / fleschScore / cefrLevel                                 â”‚   â”‚
â”‚   â”‚  â€¢ (ä¸­æ–‡) hskLevel / avgStrokeCount / characterCount                         â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚  æ¥æºè¿½æº¯:                                                                    â”‚   â”‚
â”‚   â”‚  â€¢ source / sourceId / sourceUrl                                             â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  ğŸ‘¤ ä½œè€…å…ƒæ•°æ® (Author)                                                       â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚  åŸºç¡€ä¿¡æ¯:                                                                    â”‚   â”‚
â”‚   â”‚  â€¢ name / aliases[] / avatarUrl                                              â”‚   â”‚
â”‚   â”‚  â€¢ bio / era / nationality / birthPlace                                      â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚  æ–‡å­¦ç‰¹å¾:                                                                    â”‚   â”‚
â”‚   â”‚  â€¢ writingStyle / famousWorks[] / literaryPeriod                             â”‚   â”‚
â”‚   â”‚  â€¢ literaryMovement / historicalPeriod                                       â”‚   â”‚
â”‚   â”‚  â€¢ primaryGenres[] / themes[]                                                â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚  AI äººè®¾:                                                                     â”‚   â”‚
â”‚   â”‚  â€¢ aiPersonaPrompt / voiceStyle                                              â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚  å¤–éƒ¨é“¾æ¥:                                                                    â”‚   â”‚
â”‚   â”‚  â€¢ wikipediaUrl / wikidataId                                                 â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚  ç»Ÿè®¡:                                                                        â”‚   â”‚
â”‚   â”‚  â€¢ bookCount / quoteCount / followerCount                                    â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  ğŸ§ æœ‰å£°ä¹¦å…ƒæ•°æ® (Audiobook)                                                  â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚  åŸºç¡€ä¿¡æ¯:                                                                    â”‚   â”‚
â”‚   â”‚  â€¢ title / author / narrator / description                                   â”‚   â”‚
â”‚   â”‚  â€¢ coverUrl / totalDuration                                                  â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚  æ¥æºä¿¡æ¯:                                                                    â”‚   â”‚
â”‚   â”‚  â€¢ source / sourceId / sourceUrl                                             â”‚   â”‚
â”‚   â”‚  â€¢ archiveUrl / zipUrl / rssUrl                                              â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚  è´¨é‡ä¿¡æ¯:                                                                    â”‚   â”‚
â”‚   â”‚  â€¢ quality / language / genres[] / publishYear                               â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚  çƒ­åº¦æ•°æ®:                                                                    â”‚   â”‚
â”‚   â”‚  â€¢ archiveDownloads / avgRating / numReviews                                 â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚  åŒ¹é…å­—æ®µ:                                                                    â”‚   â”‚
â”‚   â”‚  â€¢ titleNormalized / authorNormalized                                        â”‚   â”‚
â”‚   â”‚  â€¢ bookId (å…³è”ç”µå­ä¹¦)                                                        â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  ğŸ“– ç« èŠ‚å…ƒæ•°æ® (Chapter / AudiobookChapter)                                   â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚  ç”µå­ä¹¦ç« èŠ‚:                                                                  â”‚   â”‚
â”‚   â”‚  â€¢ order / title / href / wordCount                                          â”‚   â”‚
â”‚   â”‚  â€¢ content / htmlContent                                                     â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚  æœ‰å£°ä¹¦ç« èŠ‚:                                                                  â”‚   â”‚
â”‚   â”‚  â€¢ chapterNumber / title / duration                                          â”‚   â”‚
â”‚   â”‚  â€¢ audioUrl / fileName / readerName                                          â”‚   â”‚
â”‚   â”‚  â€¢ timestamps (å¬è¯»åŒæ­¥)                                                      â”‚   â”‚
â”‚   â”‚  â€¢ bookChapterId (å…³è”ç”µå­ä¹¦ç« èŠ‚)                                             â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  ğŸŒ å¤šè¯­è¨€ç¿»è¯‘ (Translation)                                                  â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚  â€¢ entityType / entityId / fieldName / locale / value                        â”‚   â”‚
â”‚   â”‚  â€¢ source: manual / douban / wikidata / wikipedia / ai / opencc              â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   éªŒè¯æµç¨‹:                                                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚  å®Œæ•´æ€§æ£€æŸ¥  â”‚â”€â”€â”€â–ºâ”‚  æ ¼å¼éªŒè¯   â”‚â”€â”€â”€â–ºâ”‚  å…³è”éªŒè¯   â”‚â”€â”€â”€â–ºâ”‚  è´¨é‡è¯„ä¼°   â”‚         â”‚
â”‚   â”‚             â”‚    â”‚             â”‚    â”‚             â”‚    â”‚             â”‚         â”‚
â”‚   â”‚ â€¢ å¿…å¡«å­—æ®µ  â”‚    â”‚ â€¢ URLæ ¼å¼   â”‚    â”‚ â€¢ ä½œè€…å…³è”  â”‚    â”‚ â€¢ æè¿°é•¿åº¦  â”‚         â”‚
â”‚   â”‚ â€¢ éç©ºæ£€æŸ¥  â”‚    â”‚ â€¢ æ—¶é•¿æ ¼å¼  â”‚    â”‚ â€¢ åˆ†ç±»å…³è”  â”‚    â”‚ â€¢ å°é¢è´¨é‡  â”‚         â”‚
â”‚   â”‚             â”‚    â”‚ â€¢ IDæ ¼å¼    â”‚    â”‚ â€¢ ä¹¦ç±å…³è”  â”‚    â”‚ â€¢ æ•°æ®å®Œæ•´åº¦â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| å…ƒæ•°æ®ç±»åˆ« | å¿…å¡«å­—æ®µ | å¯é€‰ä½†æ¨è | éªŒè¯è§„åˆ™ |
|-----------|---------|-----------|---------|
| ä¹¦ç±åŸºç¡€ | title, author, epubUrl, source | description, coverUrl | title éç©º, epubUrl æ ¼å¼æ­£ç¡® |
| ä¹¦ç±éš¾åº¦ | - | difficultyScore, cefrLevel | åˆ†æ•°èŒƒå›´ 0-1, CEFR ç­‰çº§æœ‰æ•ˆ |
| ä½œè€…åŸºç¡€ | name | bio, avatarUrl, era | name éç©º |
| æœ‰å£°ä¹¦ | title, totalDuration, source | narrator, coverUrl | duration > 0 |
| ç« èŠ‚ | order, title | wordCount | order >= 0 |

**ğŸ“Š Stage 5 æ‰§è¡ŒçŠ¶æ€ (2026-01-01):**

| æŒ‡æ ‡ | æ•°é‡ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|------|
| æ´»è·ƒä¹¦ç± | 346 | âœ… | å…¨éƒ¨ ACTIVE çŠ¶æ€ |
| æœ‰ç« èŠ‚ä¹¦ç± | 206/346 | âš ï¸ 60% | 140 æœ¬éœ€è¦ç« èŠ‚æ•°æ® |
| Feature Flags | 3 | âœ… | chinese_content, maintenance_mode, new_reader_ui |
| ç¿»è¯‘è¦†ç›–ç‡ | è§ 4.10 | âœ… | åˆ†ç±»ã€ä½œè€…ã€ä¹¦ç±å…¨éƒ¨ 100% |

**ğŸ“Œ ç« èŠ‚è§£æçŠ¶æ€ (2026-01-01 05:54):**

ç« èŠ‚è§£æè„šæœ¬å·²æ‰§è¡Œï¼Œä½†ç”±äº EPUB URL å¤±æ•ˆå¯¼è‡´å…¨éƒ¨å¤±è´¥ï¼š

| URL ç±»å‹ | æ•°é‡ | å¤±è´¥åŸå›  |
|----------|------|----------|
| Gutenberg R2 | ~30 | Access Denied (å­˜å‚¨æ¡¶æœªå…¬å¼€) |
| Standard Ebooks | ~100 | 404 (URL æ ¼å¼å·²æ›´æ”¹) |
| Debug R2 | ~10 | éœ€è¦è®¤è¯æˆ–æ–‡ä»¶ä¸å­˜åœ¨ |

**åç»­è®¡åˆ’ï¼š**
1. ä¿®å¤ Gutenberg R2 å­˜å‚¨æ¡¶å…¬å¼€è®¿é—®é…ç½®
2. æ›´æ–° Standard Ebooks URL æŠ“å–é€»è¾‘
3. æˆ–ä» Debug æœ¬åœ°æ•°æ®åº“ç›´æ¥åŒæ­¥ç« èŠ‚æ•°æ®

**å¾…å¤„ç†:**
- 140 æœ¬ä¹¦ç±éœ€è¦ EPUB ç« èŠ‚è§£æ (åœ¨ Droplet è¿è¡Œ `BookEnrichmentService.enrichBatch()`)
- Debug ç¯å¢ƒä»… 1 æœ¬å¯åŒæ­¥ï¼Œå…¶ä½™éœ€è¦ä¸‹è½½è§£æ

### 3.6 Stage 6: API éªŒè¯ (å®¢æˆ·ç«¯è¯·æ±‚)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           Stage 6: API éªŒè¯                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                      æ¨¡æ‹Ÿå®¢æˆ·ç«¯è¯·æ±‚éªŒè¯                                       â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   Droplet â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Staging API         â”‚   â”‚
â”‚   â”‚     â”‚                                                      â”‚                 â”‚   â”‚
â”‚   â”‚     â”‚   æ¨¡æ‹Ÿ iOS/Android å®¢æˆ·ç«¯è¯·æ±‚                         â”‚                 â”‚   â”‚
â”‚   â”‚     â”‚   (é™„å¸¦æ­£ç¡®çš„ Headers å’Œè®¤è¯)                         â”‚                 â”‚   â”‚
â”‚   â”‚     â”‚                                                      â”‚                 â”‚   â”‚
â”‚   â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   éªŒè¯åœºæ™¯:                                                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  1. ä¹¦ç±åˆ—è¡¨ API                                                             â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚  GET /api/v1/books                                                           â”‚   â”‚
â”‚   â”‚  GET /api/v1/books?category={id}                                             â”‚   â”‚
â”‚   â”‚  GET /api/v1/books?language=en                                               â”‚   â”‚
â”‚   â”‚  GET /api/v1/books?search={keyword}                                          â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚  éªŒè¯: æ–°å¢ä¹¦ç±å‡ºç°åœ¨åˆ—è¡¨ä¸­ï¼Œåˆ†é¡µæ­£å¸¸ï¼Œæ’åºæ­£ç¡®                                â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  2. ä¹¦ç±è¯¦æƒ… API                                                             â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚  GET /api/v1/books/{id}                                                      â”‚   â”‚
â”‚   â”‚  GET /api/v1/books/{id}/chapters                                             â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚  éªŒè¯: ä¹¦ç±è¯¦æƒ…å®Œæ•´ï¼Œç« èŠ‚åˆ—è¡¨æ­£ç¡®ï¼ŒEPUB URL å¯è®¿é—®                             â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  3. ä½œè€… API                                                                 â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚  GET /api/v1/authors                                                         â”‚   â”‚
â”‚   â”‚  GET /api/v1/authors/{id}                                                    â”‚   â”‚
â”‚   â”‚  GET /api/v1/authors/{id}/books                                              â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚  éªŒè¯: ä½œè€…ä¿¡æ¯å®Œæ•´ï¼Œå…³è”ä¹¦ç±æ­£ç¡®                                              â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  4. æœ‰å£°ä¹¦ API                                                               â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚  GET /api/v1/audiobooks                                                      â”‚   â”‚
â”‚   â”‚  GET /api/v1/audiobooks/{id}                                                 â”‚   â”‚
â”‚   â”‚  GET /api/v1/audiobooks/{id}/chapters                                        â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚  éªŒè¯: æœ‰å£°ä¹¦åˆ—è¡¨æ­£ç¡®ï¼Œç« èŠ‚éŸ³é¢‘ URL å¯è®¿é—®ï¼Œæ—¶é•¿æ­£ç¡®                           â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  5. èµ„æºæ–‡ä»¶éªŒè¯                                                             â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚  HEAD {epubUrl}        - EPUB æ–‡ä»¶å¯è®¿é—®                                     â”‚   â”‚
â”‚   â”‚  HEAD {coverUrl}       - å°é¢å›¾ç‰‡å¯è®¿é—®                                       â”‚   â”‚
â”‚   â”‚  HEAD {audioUrl}       - éŸ³é¢‘æ–‡ä»¶å¯è®¿é—®                                       â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚  éªŒè¯: HTTP 200, Content-Type æ­£ç¡®, Content-Length åˆç†                      â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  6. å‘ç°é¡µ API                                                               â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚  GET /api/v1/discover/tabs                                                   â”‚   â”‚
â”‚   â”‚  GET /api/v1/discover/sections                                               â”‚   â”‚
â”‚   â”‚  GET /api/v1/book-lists                                                      â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚  éªŒè¯: æ–°ä¹¦å‡ºç°åœ¨ç›¸åº”æ¨èä½ç½®                                                  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| API ç±»åˆ« | éªŒè¯é¡¹ | é¢„æœŸç»“æœ | å¤±è´¥å¤„ç† |
|---------|--------|---------|---------|
| ä¹¦ç±åˆ—è¡¨ | æ–°ä¹¦å¯è§æ€§ | æ–°å¢ä¹¦ç±å‡ºç°åœ¨åˆ—è¡¨ | è­¦å‘Š + ç»§ç»­ |
| ä¹¦ç±è¯¦æƒ… | æ•°æ®å®Œæ•´æ€§ | æ‰€æœ‰å­—æ®µæ­£ç¡®è¿”å› | é”™è¯¯ + è®°å½• |
| æ–‡ä»¶è®¿é—® | URL å¯è¾¾æ€§ | HTTP 200 | é”™è¯¯ + é‡è¯•ä¸Šä¼  |
| ç« èŠ‚å†…å®¹ | ç« èŠ‚æ•°é‡ | ä¸ DB ä¸€è‡´ | é”™è¯¯ + è®°å½• |
| æœ‰å£°ä¹¦ | éŸ³é¢‘å¯æ’­æ”¾ | HEAD 200, æ—¶é•¿ > 0 | é”™è¯¯ + è®°å½• |

### 3.7 Stage 7: éƒ¨ç½²ç¡®è®¤

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           Stage 7: éƒ¨ç½²ç¡®è®¤                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                         éƒ¨ç½²å‰æ£€æŸ¥                                            â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   â–¡ Stage 1-6 å…¨éƒ¨é€šè¿‡                                                        â”‚   â”‚
â”‚   â”‚   â–¡ é”™è¯¯æ•°é‡åœ¨å¯æ¥å—èŒƒå›´å†…                                                    â”‚   â”‚
â”‚   â”‚   â–¡ å…³é”®ä¹¦ç±å…¨éƒ¨æˆåŠŸ                                                          â”‚   â”‚
â”‚   â”‚   â–¡ API éªŒè¯é€šè¿‡ç‡ > 95%                                                      â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   éƒ¨ç½²æµç¨‹:                                                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚ ç¼“å­˜æ¸…ç†    â”‚â”€â”€â”€â–ºâ”‚ æœåŠ¡é‡å¯    â”‚â”€â”€â”€â–ºâ”‚ å¥åº·æ£€æŸ¥    â”‚â”€â”€â”€â–ºâ”‚ é€šçŸ¥å®Œæˆ    â”‚         â”‚
â”‚   â”‚             â”‚    â”‚ (å¯é€‰)      â”‚    â”‚             â”‚    â”‚             â”‚         â”‚
â”‚   â”‚ â€¢ Redis     â”‚    â”‚ â€¢ Staging   â”‚    â”‚ â€¢ API å¥åº·  â”‚    â”‚ â€¢ Slack     â”‚         â”‚
â”‚   â”‚ â€¢ CDN       â”‚    â”‚   æœåŠ¡      â”‚    â”‚ â€¢ DB è¿æ¥   â”‚    â”‚ â€¢ é‚®ä»¶      â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                         ç¼“å­˜æ¸…ç†æ“ä½œ                                          â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   Redis ç¼“å­˜:                                                                 â”‚   â”‚
â”‚   â”‚   â€¢ books:list:*         - ä¹¦ç±åˆ—è¡¨ç¼“å­˜                                       â”‚   â”‚
â”‚   â”‚   â€¢ books:detail:{id}    - ä¹¦ç±è¯¦æƒ…ç¼“å­˜                                       â”‚   â”‚
â”‚   â”‚   â€¢ authors:list:*       - ä½œè€…åˆ—è¡¨ç¼“å­˜                                       â”‚   â”‚
â”‚   â”‚   â€¢ audiobooks:*         - æœ‰å£°ä¹¦ç›¸å…³ç¼“å­˜                                     â”‚   â”‚
â”‚   â”‚   â€¢ discover:*           - å‘ç°é¡µç¼“å­˜                                         â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   CDN ç¼“å­˜ (Cloudflare):                                                      â”‚   â”‚
â”‚   â”‚   â€¢ æ¸…ç†æ–°å¢å°é¢ URL                                                          â”‚   â”‚
â”‚   â”‚   â€¢ æ¸…ç† API å“åº”ç¼“å­˜ (å¦‚æœ‰)                                                  â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                         å¥åº·æ£€æŸ¥                                              â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   GET https://staging-api.readmigo.app/api/v1/health                         â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   éªŒè¯å“åº”:                                                                   â”‚   â”‚
â”‚   â”‚   â€¢ status: "ok"                                                              â”‚   â”‚
â”‚   â”‚   â€¢ database: "connected"                                                     â”‚   â”‚
â”‚   â”‚   â€¢ redis: "connected"                                                        â”‚   â”‚
â”‚   â”‚   â€¢ r2: "accessible"                                                          â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                         å®Œæˆé€šçŸ¥                                              â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   é€šçŸ¥å†…å®¹:                                                                   â”‚   â”‚
â”‚   â”‚   â€¢ æµæ°´çº¿è¿è¡Œ ID                                                             â”‚   â”‚
â”‚   â”‚   â€¢ æ‰§è¡Œæ—¶é•¿                                                                  â”‚   â”‚
â”‚   â”‚   â€¢ æˆåŠŸ/å¤±è´¥ç»Ÿè®¡                                                             â”‚   â”‚
â”‚   â”‚   â€¢ æ–°å¢ä¹¦ç±/æœ‰å£°ä¹¦æ•°é‡                                                       â”‚   â”‚
â”‚   â”‚   â€¢ å¤±è´¥æ¡ç›®åˆ—è¡¨ (å¦‚æœ‰)                                                       â”‚   â”‚
â”‚   â”‚   â€¢ æ—¥å¿—æ–‡ä»¶é“¾æ¥                                                              â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| æ­¥éª¤ | æ“ä½œ | è§¦å‘æ¡ä»¶ | å¤±è´¥å¤„ç† |
|------|------|---------|---------|
| ç¼“å­˜æ¸…ç† | æ¸…é™¤ Redis + CDN | å§‹ç»ˆæ‰§è¡Œ | è­¦å‘Š + ç»§ç»­ |
| æœåŠ¡é‡å¯ | é‡å¯ Staging æœåŠ¡ | æœ‰ Schema å˜æ›´æ—¶ | å›æ»š |
| å¥åº·æ£€æŸ¥ | API å¥åº·æ£€æŸ¥ | ç¼“å­˜æ¸…ç†å | ç»ˆæ­¢ + å‘Šè­¦ |
| é€šçŸ¥ | å‘é€å®Œæˆé€šçŸ¥ | å§‹ç»ˆæ‰§è¡Œ | è®°å½•æ—¥å¿— |

---

## å››ã€æ‰§è¡Œæµç¨‹

### 4.1 å®Œæ•´æ‰§è¡Œæµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           P001 æ‰§è¡Œæµç¨‹è¯¦å›¾                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                â”‚
â”‚   â”‚ è¾“å…¥: ä¹¦å•æ–‡ä»¶   â”‚                                                                â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                â”‚
â”‚            â”‚                                                                          â”‚
â”‚            â–¼                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚   â”‚ Stage 1: éªŒè¯   â”‚â”€â”€â”€â”€â–ºâ”‚ éªŒè¯å¤±è´¥æ¡ç›®    â”‚â”€â”€â–º è®°å½•åˆ°é”™è¯¯æ—¥å¿—                       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚            â”‚ éªŒè¯é€šè¿‡                                                                 â”‚
â”‚            â–¼                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚   â”‚ Stage 2: Schema â”‚â”€â”€â”€â”€â–ºâ”‚ éœ€è¦è¿ç§»?       â”‚                                        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚            â”‚                       â”‚                                                  â”‚
â”‚            â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ æ‰§è¡Œè¿ç§»                                        â”‚
â”‚            â–¼                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚   â”‚ Stage 3: ä¸Šä¼    â”‚â”€â”€â”€â”€â–ºâ”‚ å¹¶è¡Œä¸Šä¼ æ–‡ä»¶    â”‚                                        â”‚
â”‚   â”‚                 â”‚     â”‚ â€¢ EPUBs         â”‚                                        â”‚
â”‚   â”‚                 â”‚     â”‚ â€¢ Covers        â”‚                                        â”‚
â”‚   â”‚                 â”‚     â”‚ â€¢ Audio Files   â”‚                                        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚            â”‚                                                                          â”‚
â”‚            â–¼                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚   â”‚ Stage 4: å¡«å……   â”‚â”€â”€â”€â”€â–ºâ”‚ å…¬å¼€æ¸ é“æŠ“å–    â”‚                                        â”‚
â”‚   â”‚                 â”‚     â”‚ â€¢ å…ƒæ•°æ®å¢å¼º    â”‚                                        â”‚
â”‚   â”‚                 â”‚     â”‚ â€¢ ç« èŠ‚è§£æ      â”‚                                        â”‚
â”‚   â”‚                 â”‚     â”‚ â€¢ å…³è”å»ºç«‹      â”‚                                        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚            â”‚                                                                          â”‚
â”‚            â–¼                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚   â”‚ Stage 5: å…ƒæ•°æ® â”‚â”€â”€â”€â”€â–ºâ”‚ å…ƒæ•°æ®éªŒè¯      â”‚                                        â”‚
â”‚   â”‚                 â”‚     â”‚ â€¢ å®Œæ•´æ€§æ£€æŸ¥    â”‚                                        â”‚
â”‚   â”‚                 â”‚     â”‚ â€¢ æ ¼å¼éªŒè¯      â”‚                                        â”‚
â”‚   â”‚                 â”‚     â”‚ â€¢ å…³è”éªŒè¯      â”‚                                        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚            â”‚                                                                          â”‚
â”‚            â–¼                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚   â”‚ Stage 6: API    â”‚â”€â”€â”€â”€â–ºâ”‚ å®¢æˆ·ç«¯è¯·æ±‚æ¨¡æ‹Ÿ  â”‚                                        â”‚
â”‚   â”‚                 â”‚     â”‚ â€¢ ä¹¦ç±/ä½œè€… API â”‚                                        â”‚
â”‚   â”‚                 â”‚     â”‚ â€¢ æœ‰å£°ä¹¦ API    â”‚                                        â”‚
â”‚   â”‚                 â”‚     â”‚ â€¢ æ–‡ä»¶å¯è®¿é—®æ€§  â”‚                                        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚            â”‚                                                                          â”‚
â”‚            â–¼                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚   â”‚ Stage 7: éƒ¨ç½²   â”‚â”€â”€â”€â”€â–ºâ”‚ éƒ¨ç½²ç¡®è®¤        â”‚                                        â”‚
â”‚   â”‚                 â”‚     â”‚ â€¢ ç¼“å­˜æ¸…ç†      â”‚                                        â”‚
â”‚   â”‚                 â”‚     â”‚ â€¢ å¥åº·æ£€æŸ¥      â”‚                                        â”‚
â”‚   â”‚                 â”‚     â”‚ â€¢ å®Œæˆé€šçŸ¥      â”‚                                        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚            â”‚                                                                          â”‚
â”‚            â–¼                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                â”‚
â”‚   â”‚ å®Œæˆ: ç”ŸæˆæŠ¥å‘Š   â”‚                                                                â”‚
â”‚   â”‚ â€¢ æˆåŠŸæ•°é‡      â”‚                                                                â”‚
â”‚   â”‚ â€¢ å¤±è´¥æ¡ç›®      â”‚                                                                â”‚
â”‚   â”‚ â€¢ è­¦å‘Šä¿¡æ¯      â”‚                                                                â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 æ‰§è¡Œå‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `pnpm pipeline:p001 --input=<booklist.json>` | æ‰§è¡Œå®Œæ•´æµæ°´çº¿ |
| `pnpm pipeline:p001 --input=<booklist.json> --dry-run` | é¢„æ¼”æ¨¡å¼ï¼Œä¸å®é™…æ‰§è¡Œ |
| `pnpm pipeline:p001 --input=<booklist.json> --stage=1` | ä»…æ‰§è¡Œ Stage 1 |
| `pnpm pipeline:p001 --resume=<run-id>` | ä»ä¸­æ–­ç‚¹æ¢å¤æ‰§è¡Œ |

---

## äº”ã€é”™è¯¯å¤„ç†

### 5.1 é”™è¯¯åˆ†ç±»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           é”™è¯¯å¤„ç†ç­–ç•¥                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  è‡´å‘½é”™è¯¯ (Fatal) - ç»ˆæ­¢æµæ°´çº¿                                                â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚  â€¢ ä¹¦å•æ–‡ä»¶ä¸å­˜åœ¨æˆ–æ— æ³•è§£æ                                                   â”‚   â”‚
â”‚   â”‚  â€¢ æ•°æ®åº“è¿æ¥å¤±è´¥                                                             â”‚   â”‚
â”‚   â”‚  â€¢ R2 å­˜å‚¨æ— æ³•è®¿é—®                                                            â”‚   â”‚
â”‚   â”‚  â€¢ å…³é”®é…ç½®ç¼ºå¤±                                                               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  å¯æ¢å¤é”™è¯¯ (Recoverable) - è·³è¿‡æ¡ç›®ç»§ç»­                                      â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚  â€¢ å•æœ¬ä¹¦ç±éªŒè¯å¤±è´¥                                                           â”‚   â”‚
â”‚   â”‚  â€¢ å•ä¸ªæ–‡ä»¶ä¸Šä¼ å¤±è´¥ (é‡è¯•3æ¬¡åè·³è¿‡)                                           â”‚   â”‚
â”‚   â”‚  â€¢ å…¬å¼€æ¸ é“æŠ“å–è¶…æ—¶ (ä½¿ç”¨ç¼“å­˜/é»˜è®¤å€¼)                                         â”‚   â”‚
â”‚   â”‚  â€¢ ç« èŠ‚è§£æéƒ¨åˆ†å¤±è´¥                                                           â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  è­¦å‘Š (Warning) - è®°å½•æ—¥å¿—ç»§ç»­                                                â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚  â€¢ ä¹¦ç±å·²å­˜åœ¨äº Staging (è·³è¿‡)                                                â”‚   â”‚
â”‚   â”‚  â€¢ å°é¢å›¾ç‰‡è´¨é‡ä½                                                             â”‚   â”‚
â”‚   â”‚  â€¢ ä½œè€…ä¿¡æ¯ä¸å®Œæ•´                                                             â”‚   â”‚
â”‚   â”‚  â€¢ éŸ³é¢‘æ–‡ä»¶æ¯”ç‰¹ç‡ä½äºæ ‡å‡†                                                     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 é‡è¯•ç­–ç•¥

| æ“ä½œ | é‡è¯•æ¬¡æ•° | é‡è¯•é—´éš” | å¤±è´¥åå¤„ç† |
|------|:--------:|----------|------------|
| æ•°æ®åº“å†™å…¥ | 3 | æŒ‡æ•°é€€é¿ | ç»ˆæ­¢æµæ°´çº¿ |
| R2 æ–‡ä»¶ä¸Šä¼  | 3 | 2s, 5s, 10s | è·³è¿‡ï¼Œè®°å½•å¤±è´¥ |
| å…¬å¼€æ¸ é“è¯·æ±‚ | 2 | 5s | ä½¿ç”¨é»˜è®¤å€¼/ç¼“å­˜ |
| EPUB è§£æ | 1 | - | æ ‡è®°ä¸ºè§£æå¤±è´¥ |

---

## å…­ã€è¾“å‡ºè§„èŒƒ

### 6.1 æ‰§è¡ŒæŠ¥å‘Š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           æ‰§è¡ŒæŠ¥å‘Šç»“æ„                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚   æŠ¥å‘Šæ–‡ä»¶: logs/pipeline/P001/{timestamp}-report.json                               â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  æ€»è§ˆ                                                                        â”‚   â”‚
â”‚   â”‚  â€¢ æ‰§è¡Œæ—¶é—´                                                                   â”‚   â”‚
â”‚   â”‚  â€¢ æ€»è€—æ—¶                                                                     â”‚   â”‚
â”‚   â”‚  â€¢ è¾“å…¥ä¹¦å•                                                                   â”‚   â”‚
â”‚   â”‚  â€¢ ç›®æ ‡ç¯å¢ƒ                                                                   â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  ç»Ÿè®¡                                                                        â”‚   â”‚
â”‚   â”‚  â€¢ ç”µå­ä¹¦: æˆåŠŸ / å¤±è´¥ / è·³è¿‡                                                 â”‚   â”‚
â”‚   â”‚  â€¢ æœ‰å£°ä¹¦: æˆåŠŸ / å¤±è´¥ / è·³è¿‡                                                 â”‚   â”‚
â”‚   â”‚  â€¢ æ–‡ä»¶ä¸Šä¼ : æˆåŠŸ / å¤±è´¥                                                      â”‚   â”‚
â”‚   â”‚  â€¢ æ•°æ®å¡«å……: æˆåŠŸ / å¤±è´¥                                                      â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  è¯¦ç»†è®°å½•                                                                    â”‚   â”‚
â”‚   â”‚  â€¢ æ¯ä¸ª Stage çš„è¯¦ç»†æ—¥å¿—                                                      â”‚   â”‚
â”‚   â”‚  â€¢ å¤±è´¥æ¡ç›®æ¸…å•å’ŒåŸå›                                                          â”‚   â”‚
â”‚   â”‚  â€¢ è­¦å‘Šä¿¡æ¯æ±‡æ€»                                                               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¸ƒã€è¿è¡Œç¯å¢ƒ

### 7.1 Droplet æœåŠ¡å™¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           Droplet è¿è¡Œæ¶æ„                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                      Digital Ocean Droplet                                   â”‚   â”‚
â”‚   â”‚                      (æµæ°´çº¿æ‰§è¡ŒæœåŠ¡å™¨)                                       â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚   â”‚
â”‚   â”‚   â”‚   tmux /    â”‚    â”‚   Node.js   â”‚    â”‚   æœ¬åœ°å­˜å‚¨   â”‚                     â”‚   â”‚
â”‚   â”‚   â”‚   screen    â”‚    â”‚   Runtime   â”‚    â”‚   (çŠ¶æ€)     â”‚                     â”‚   â”‚
â”‚   â”‚   â”‚             â”‚    â”‚             â”‚    â”‚             â”‚                     â”‚   â”‚
â”‚   â”‚   â”‚ â€¢ ä¼šè¯ä¿æŒ  â”‚    â”‚ â€¢ æµæ°´çº¿    â”‚    â”‚ â€¢ æ£€æŸ¥ç‚¹    â”‚                     â”‚   â”‚
â”‚   â”‚   â”‚ â€¢ æ–­å¼€ç»­è·‘  â”‚    â”‚   æ‰§è¡Œ      â”‚    â”‚ â€¢ æ—¥å¿—æ–‡ä»¶  â”‚                     â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚   â”‚
â”‚   â”‚         â”‚                   â”‚                  â”‚                             â”‚   â”‚
â”‚   â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚   â”‚
â”‚   â”‚                             â”‚                                                 â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚                                                     â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚           â”‚                     â”‚                     â”‚                              â”‚
â”‚           â–¼                     â–¼                     â–¼                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚   â”‚ Debug ç¯å¢ƒ  â”‚       â”‚ Staging ç¯å¢ƒâ”‚       â”‚ å…¬å¼€æ¸ é“    â”‚                       â”‚
â”‚   â”‚ (Fly.io)   â”‚       â”‚ (Fly.io)   â”‚       â”‚ (Internet)  â”‚                       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 é•¿æ—¶é—´è¿è¡Œæ”¯æŒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           é•¿æ—¶é—´æ‰§è¡Œæœºåˆ¶                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                      ä¼šè¯ç®¡ç† (tmux/screen)                                  â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   â€¢ ä½¿ç”¨ tmux æˆ– screen åˆ›å»ºæŒä¹…ä¼šè¯                                          â”‚   â”‚
â”‚   â”‚   â€¢ SSH æ–­å¼€åè¿›ç¨‹ç»§ç»­è¿è¡Œ                                                    â”‚   â”‚
â”‚   â”‚   â€¢ å¯éšæ—¶é‡æ–°è¿æ¥æŸ¥çœ‹è¿›åº¦                                                    â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                      æ£€æŸ¥ç‚¹æœºåˆ¶ (Checkpoint)                                  â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   checkpoint/                                                                 â”‚   â”‚
â”‚   â”‚   â””â”€â”€ P001-{run-id}/                                                         â”‚   â”‚
â”‚   â”‚       â”œâ”€â”€ state.json         # å½“å‰æ‰§è¡ŒçŠ¶æ€                                   â”‚   â”‚
â”‚   â”‚       â”œâ”€â”€ stage1-complete    # Stage 1 å®Œæˆæ ‡è®°                              â”‚   â”‚
â”‚   â”‚       â”œâ”€â”€ stage2-complete    # Stage 2 å®Œæˆæ ‡è®°                              â”‚   â”‚
â”‚   â”‚       â”œâ”€â”€ processed-books.json    # å·²å¤„ç†ä¹¦ç±åˆ—è¡¨                           â”‚   â”‚
â”‚   â”‚       â””â”€â”€ pending-books.json      # å¾…å¤„ç†ä¹¦ç±åˆ—è¡¨                           â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   æ¢å¤æ‰§è¡Œ: pnpm pipeline:p001 --resume={run-id}                             â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                      è¿›åº¦è¿½è¸ª & é€šçŸ¥                                          â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   å®æ—¶æ—¥å¿—:                                                                   â”‚   â”‚
â”‚   â”‚   logs/pipeline/P001/{run-id}/                                               â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ progress.log           # è¿›åº¦æ—¥å¿— (tail -f æŸ¥çœ‹)                       â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ error.log              # é”™è¯¯æ—¥å¿—                                       â”‚   â”‚
â”‚   â”‚   â””â”€â”€ complete.log           # å®Œæˆçš„æ¡ç›®                                     â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   è¿›åº¦æŸ¥çœ‹å‘½ä»¤:                                                               â”‚   â”‚
â”‚   â”‚   â€¢ pnpm pipeline:status {run-id}                                            â”‚   â”‚
â”‚   â”‚   â€¢ tail -f logs/pipeline/P001/{run-id}/progress.log                         â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   å®Œæˆé€šçŸ¥ (å¯é€‰):                                                            â”‚   â”‚
â”‚   â”‚   â€¢ é‚®ä»¶é€šçŸ¥                                                                  â”‚   â”‚
â”‚   â”‚   â€¢ Slack Webhook                                                             â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.3 æ‰§è¡Œæ—¶é—´é¢„ä¼°

| å†…å®¹è§„æ¨¡ | é¢„ä¼°æ—¶é—´ | ä¸»è¦è€—æ—¶ç¯èŠ‚ |
|----------|----------|--------------|
| 50 æœ¬ç”µå­ä¹¦ | 30-60 åˆ†é’Ÿ | æ–‡ä»¶ä¸Šä¼ ã€å…ƒæ•°æ®æŠ“å– |
| 100 æœ¬ç”µå­ä¹¦ | 1-2 å°æ—¶ | æ–‡ä»¶ä¸Šä¼ ã€EPUB è§£æ |
| 300 æœ¬ç”µå­ä¹¦ + 50 æœ‰å£°ä¹¦ | 4-8 å°æ—¶ | éŸ³é¢‘æ–‡ä»¶ä¸Šä¼  |
| 500 æœ¬æ··åˆå†…å®¹ | 8-16 å°æ—¶ | å…¨æµç¨‹ |

### 7.4 èµ„æºä½¿ç”¨

| èµ„æº | æ¨èé…ç½® | è¯´æ˜ |
|------|----------|------|
| Droplet è§„æ ¼ | 2 vCPU / 4GB RAM | åŸºç¡€è§„æ ¼ï¼Œå¯æ‰©å±• |
| ç£ç›˜ç©ºé—´ | 50GB+ | ç”¨äºä¸´æ—¶æ–‡ä»¶å’Œæ—¥å¿— |
| ç½‘ç»œå¸¦å®½ | æ— é™åˆ¶ | DO å¸¦å®½å…è´¹ |

---

## å…«ã€ä¾èµ–ä¸å‰ç½®æ¡ä»¶

### 8.1 ç¯å¢ƒä¾èµ–

| ä¾èµ–é¡¹ | è¦æ±‚ | è¯´æ˜ |
|--------|------|------|
| Droplet æœåŠ¡å™¨ | è¿è¡Œä¸­ | æµæ°´çº¿æ‰§è¡Œç¯å¢ƒ |
| Debug ç¯å¢ƒ | å·²éƒ¨ç½²è¿è¡Œ | ä½œä¸ºæ•°æ®æº |
| Staging ç¯å¢ƒ | å·²éƒ¨ç½²è¿è¡Œ | ä½œä¸ºç›®æ ‡ |
| Debug R2 Bucket | å¯è®¿é—® | æ–‡ä»¶æ¥æº |
| Staging R2 Bucket | å¯å†™å…¥ | æ–‡ä»¶ç›®æ ‡ |
| å…¬å¼€æ¸ é“ç½‘ç»œ | å¯è®¿é—® | Gutenberg, Wikidata ç­‰ |
| tmux/screen | å·²å®‰è£… | ä¼šè¯æŒä¹…åŒ– |
| Node.js 20+ | å·²å®‰è£… | è¿è¡Œæ—¶ç¯å¢ƒ |

### 8.2 é…ç½®è¦æ±‚

| é…ç½®é¡¹ | è¯´æ˜ |
|--------|------|
| DEBUG_DATABASE_URL | Debug ç¯å¢ƒæ•°æ®åº“è¿æ¥ |
| STAGING_DATABASE_URL | Staging ç¯å¢ƒæ•°æ®åº“è¿æ¥ |
| DEBUG_R2_* | Debug R2 å­˜å‚¨é…ç½® |
| STAGING_R2_* | Staging R2 å­˜å‚¨é…ç½® |
| PIPELINE_CHECKPOINT_DIR | æ£€æŸ¥ç‚¹å­˜å‚¨ç›®å½• |
| PIPELINE_LOG_DIR | æ—¥å¿—å­˜å‚¨ç›®å½• |

---

## ä¹ã€ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´è¯´æ˜ |
|------|------|----------|
| 1.0 | 2025-12-31 | åˆå§‹è®¾è®¡ |
| 1.1 | 2025-12-31 | æ·»åŠ  Droplet è¿è¡Œç¯å¢ƒå’Œé•¿æ—¶é—´æ‰§è¡Œæ”¯æŒ |
| 1.2 | 2025-12-31 | æ·»åŠ  Stage 5 (å…ƒæ•°æ®)ã€Stage 6 (APIéªŒè¯)ã€Stage 7 (éƒ¨ç½²) |
| 1.3 | 2026-01-01 | æ·»åŠ  Stage 4.5 (åˆ†ç±»ç”Ÿæˆ)ã€Stage 4.6 (å‘ç°é¡µTab)ã€ç»éªŒæ€»ç»“ |
| 1.4 | 2026-01-01 | æ·»åŠ  Stage 4.7 (ä½œè€…å¤´åƒä¿®å¤)ã€Stage 4.8 (æ¨èæœåŠ¡éªŒè¯)ã€ä¸€é”®éƒ¨ç½²è„šæœ¬ |
| 1.5 | 2026-01-01 | æ·»åŠ  Stage 4.9 (æ ‡é¢˜æ¸…æ´—)ã€Stage 4.10 (ç¿»è¯‘æ•°æ®å¡«å……)ã€å¤šè¯­è¨€æœ¬åœ°åŒ–æ”¯æŒ |
| 1.6 | 2026-01-01 | Stage 4.10 æ‰§è¡Œå®Œæˆ: åˆ†ç±» 100%ã€ä½œè€… 85%ã€ä¹¦ç± 91%ï¼›æ·»åŠ æ–°è„šæœ¬ seed-category-translations.tsã€enrich-author-translations.tsã€seed-book-translations.ts |
| 1.7 | 2026-01-01 | Stage 5 è¿›åº¦: ä¿®å¤ 6 æœ¬ PROCESSING ä¹¦ç±ã€å¡«å…… 3 ä¸ª Feature Flagsã€è¯†åˆ« 141 æœ¬å¾…è§£æä¹¦ç± |
| 1.8 | 2026-01-01 | ç¿»è¯‘è¦†ç›–ç‡è¾¾ 100%: åˆ†ç±» 58/58ã€ä½œè€… 216/216ã€ä¹¦ç± 346/346ï¼›åŒæ­¥ 1 æœ¬ Debug ç« èŠ‚ |
| 1.9 | 2026-01-01 | ç« èŠ‚è§£æè„šæœ¬æ‰§è¡Œ: 140 æœ¬ä¹¦ EPUB ä¸‹è½½å¤±è´¥ (URL å¤±æ•ˆ)ï¼›éœ€ä¿®å¤ R2 å…¬å¼€è®¿é—®æˆ–æ›´æ–° URL æŠ“å–é€»è¾‘ |
| 1.10 | 2026-01-01 | Stage 6 API è¿æ¥è¯Šæ–­: iOS å®¢æˆ·ç«¯æ— æ³•è¿æ¥ Staging APIï¼Œè¯¦è§ä¸‹æ–¹è¯Šæ–­æŠ¥å‘Š |
| 1.11 | 2026-01-01 | Stage 6 API è¿æ¥å·²ä¿®å¤: é‡æ–°éƒ¨ç½² Fly.ioï¼ŒHealth/Redis/Database/Storage å…¨éƒ¨æ­£å¸¸ï¼Œ8 ä¸ªåˆ†ç±» Tab æ­£å¸¸è¿”å› |
| 1.12 | 2026-01-01 | iOS å®¢æˆ·ç«¯æœ¬åœ°åŒ–ä¿®å¤: ç§»é™¤å®¢æˆ·ç«¯æ•°æ®ç¿»è¯‘è¡¨ï¼Œæ”¹ç”¨æœåŠ¡ç«¯æœ¬åœ°åŒ–ï¼Œè¯¦è§ ä¹-C ç« èŠ‚ |
| 1.13 | 2026-01-01 | ä½œè€…å¤´åƒé—®é¢˜ä¿®å¤: 18 ä¸ª Agora ä½œè€…å¤´åƒä»å­—æ¯å ä½ç¬¦æ›´æ–°ä¸ºçœŸå®è‚–åƒï¼›æ·»åŠ  10.6 ä½œè€…å¤´åƒå¤„ç†ç»éªŒæ€»ç»“ |
| 1.14 | 2026-01-02 | Prisma æ•°æ®åº“è¿æ¥é—®é¢˜: packages/database/.env æŒ‡å‘æ—§æ•°æ®åº“å¯¼è‡´ iOS æ˜¾ç¤ºé”™è¯¯çš„ 5 ä¸ª Tabï¼›æ·»åŠ  10.8 æ•°æ®åº“è¿æ¥æ’æŸ¥ç»éªŒ |
| 1.15 | 2026-01-02 | Fly.io ç¯å¢ƒåŒæ­¥é—®é¢˜: Fly.io secrets ç‹¬ç«‹äº Droplet é…ç½®å¯¼è‡´ iOS ä»æ˜¾ç¤ºæ—§æ•°æ®ï¼›ä¹¦ç±ä» Debug åŒæ­¥åˆ° Staging (153æœ¬)ï¼›æ·»åŠ  10.9 Fly.io éƒ¨ç½²ç¯å¢ƒåŒæ­¥ç»éªŒã€10.10 ä¹¦ç±åŒæ­¥ä¸åˆ†ç±»å…³è”ç»éªŒ |

---

## ä¹-Bã€Stage 6 API è¿æ¥é—®é¢˜è¯Šæ–­ (2026-01-01)

### è¯Šæ–­ç»“æœ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           iOS â†’ Staging API è¿æ¥é—®é¢˜è¯Šæ–­                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚   ç—‡çŠ¶: iOS å®¢æˆ·ç«¯è¯·æ±‚ /recommendation/discover/tabs æ— å“åº”                          â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  iOS é…ç½®                                                                     â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚  ç¯å¢ƒ: Staging                                                                â”‚   â”‚
â”‚   â”‚  URL:  https://readmigo-staging.fly.dev/api/v1                               â”‚   â”‚
â”‚   â”‚  é…ç½®æ–‡ä»¶: ios/Readmigo/Core/Config/Environment.swift:20                     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  Fly.io Staging çŠ¶æ€                                                          â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚  App:      readmigo-staging                                                   â”‚   â”‚
â”‚   â”‚  Region:   nrt (Tokyo)                                                        â”‚   â”‚
â”‚   â”‚  State:    started                                                            â”‚   â”‚
â”‚   â”‚  TCP:      âœ… passing                                                          â”‚   â”‚
â”‚   â”‚  HTTP:     âŒ critical (health check /api/v1/health æ— å“åº”)                    â”‚   â”‚
â”‚   â”‚  åŸå› :     åº”ç”¨å¯åŠ¨åæŒ‚èµ·ï¼Œå¯èƒ½ Redis è¿æ¥é—®é¢˜                                  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  Droplet Staging çŠ¶æ€                                                         â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚  æœåŠ¡:     PM2 - readmigo-staging                                             â”‚   â”‚
â”‚   â”‚  ç«¯å£:     8081                                                               â”‚   â”‚
â”‚   â”‚  æœ¬åœ°æµ‹è¯•: âœ… HTTP 200 (curl localhost:8081)                                   â”‚   â”‚
â”‚   â”‚  å¤–éƒ¨è®¿é—®: âŒ æ—  Nginx é…ç½®ï¼Œæ— æ³•å¤–éƒ¨è®¿é—®                                       â”‚   â”‚
â”‚   â”‚  Redis:    âŒ æœªå®‰è£… (æ—¥å¿—æ˜¾ç¤ºè¿æ¥é”™è¯¯)                                         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¹æœ¬åŸå› 

| é—®é¢˜ | è¯¦æƒ… | å½±å“ |
|------|------|------|
| Fly.io HTTP å¥åº·æ£€æŸ¥å¤±è´¥ | åº”ç”¨ TCP ç›‘å¬æ­£å¸¸ä½† HTTP è¯·æ±‚æ— å“åº” | iOS æ— æ³•è¿æ¥ |
| å¯èƒ½çš„ Redis é—®é¢˜ | REDIS_URL é…ç½®äº†ä½†å¯èƒ½è¿æ¥å¤±è´¥å¯¼è‡´åº”ç”¨æŒ‚èµ· | API æ— å“åº” |
| Droplet æ— å¤–éƒ¨è®¿é—® | staging.readmigo.com DNS ä¸å­˜åœ¨ï¼Œæ—  Nginx ä»£ç† | å¤‡é€‰æ–¹æ¡ˆä¸å¯ç”¨ |

### ä¿®å¤é€‰é¡¹

| é€‰é¡¹ | æ­¥éª¤ | ä¼˜å…ˆçº§ |
|------|------|--------|
| A: ä¿®å¤ Fly.io | 1. æ£€æŸ¥ Redis è¿æ¥é…ç½® 2. æ£€æŸ¥åº”ç”¨å¯åŠ¨æ—¥å¿— 3. é‡æ–°éƒ¨ç½² | P0 |
| B: é…ç½® Droplet | 1. å®‰è£… Redis 2. é…ç½® Nginx 3. æ·»åŠ  DNS è®°å½• | P1 |
| C: ä¸´æ—¶ç»•è¿‡ | åœ¨ iOS æ·»åŠ  Droplet IP ç›´è¿é€‰é¡¹ (ä»…ä¾›æµ‹è¯•) | P2 |

### è§£å†³æ–¹æ¡ˆ (å·²å®Œæˆ)

**æ‰§è¡Œé€‰é¡¹ A: é‡æ–°éƒ¨ç½² Fly.io**

```bash
# 1. æ›´æ–° REDIS_URL (ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„ç§æœ‰ç½‘ç»œåœ°å€)
flyctl secrets set REDIS_URL='redis://default:xxx@fly-readmigo-staging-redis.upstash.io:6379' -a readmigo-staging

# 2. é”€æ¯æ—§æœºå™¨å¹¶é‡æ–°éƒ¨ç½²
flyctl machine destroy <machine-id> -a readmigo-staging --force
flyctl deploy -a readmigo-staging --now
```

**ç»“æœéªŒè¯ (2026-01-01 14:46 UTC+8)**

| æ£€æŸ¥é¡¹ | çŠ¶æ€ |
|--------|------|
| Health API | âœ… HTTP 200 |
| Database | âœ… ok (latency: 69ms) |
| Redis | âœ… ok (latency: 2ms) |
| Storage | âœ… ok (configured: true) |
| Discover Tabs | âœ… è¿”å› 8 ä¸ªåˆ†ç±» |

**ä¿®å¤åçš„æœºå™¨é…ç½®**

- æœºå™¨æ•°é‡: 2 (é«˜å¯ç”¨)
- åŒºåŸŸ: nrt (Tokyo)
- é•œåƒ: `readmigo-staging:deployment-01KDW4RE47PFGDE8JEK418A0BS`

---

## ä¹-Cã€iOS å®¢æˆ·ç«¯æœ¬åœ°åŒ–ä¿®å¤ (2026-01-01)

### é—®é¢˜ç°è±¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           iOS å‘ç°é¡µä¸­æ–‡æ˜¾ç¤ºé—®é¢˜                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚   ç—‡çŠ¶: å‘ç°é¡µéƒ¨åˆ†å†…å®¹æ˜¾ç¤ºè‹±æ–‡è€Œéä¸­æ–‡                                                   â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  é—®é¢˜ 1: åˆ†ç±»æ ‡ç­¾æ˜¾ç¤ºè‹±æ–‡                                                      â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚  ç°è±¡: Classics, Fiction, Adventure & Fantasy                               â”‚   â”‚
â”‚   â”‚  æœŸæœ›: ç»å…¸, å°è¯´, å†’é™©å¥‡å¹»                                                    â”‚   â”‚
â”‚   â”‚  åŸå› : API è¿”å›çš„ name å­—æ®µå€¼æ˜¯è‹±æ–‡ (æœåŠ¡ç«¯ç¿»è¯‘è¡¨æœªæ­£ç¡®åº”ç”¨)                     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  é—®é¢˜ 2: ä¹¦ç±æµæ´¾æ˜¾ç¤ºè‹±æ–‡                                                      â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚  ç°è±¡: Satire, Classic Literature                                            â”‚   â”‚
â”‚   â”‚  æœŸæœ›: è®½åˆº, ç»å…¸æ–‡å­¦                                                          â”‚   â”‚
â”‚   â”‚  åŸå› : API è¿”å›çš„ genres å­—æ®µå€¼æ˜¯è‹±æ–‡ (æœåŠ¡ç«¯ç¿»è¯‘è¡¨æœªæ­£ç¡®åº”ç”¨)                   â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  é—®é¢˜ 3: ä½œè€…ä¿¡æ¯æ˜¾ç¤ºè‹±æ–‡                                                      â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚  ç°è±¡: Aesop, 621? BCE-565? BCE                                              â”‚   â”‚
â”‚   â”‚  æœŸæœ›: ä¼Šç´¢, å…¬å…ƒå‰621å¹´?-å…¬å…ƒå‰565å¹´?                                         â”‚   â”‚
â”‚   â”‚  åŸå› : API è¿”å›çš„ author å­—æ®µå€¼æ˜¯è‹±æ–‡ (æœåŠ¡ç«¯ç¿»è¯‘è¡¨æœªæ­£ç¡®åº”ç”¨)                   â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è§£å†³æ–¹æ¡ˆï¼šéµå¾ªè®¾è®¡åŸåˆ™

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          æ­£ç¡®çš„æœ¬åœ°åŒ–æ¶æ„ (æœåŠ¡ç«¯è´Ÿè´£)                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚   æ ¸å¿ƒåŸåˆ™: æ•°æ®æœ¬åœ°åŒ–ç”±æœåŠ¡ç«¯è´Ÿè´£ï¼Œå®¢æˆ·ç«¯ç›´æ¥ä½¿ç”¨æœåŠ¡ç«¯è¿”å›çš„æ•°æ®                        â”‚
â”‚            å‚è€ƒ: docs/04-development/backend/localization/data-localization-design.md (ç¬¬åäºŒç« ) â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                        èŒè´£åˆ†å·¥                                               â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚          æœåŠ¡ç«¯               â”‚              å®¢æˆ·ç«¯                          â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚  âœ… æ•°æ®æœ¬åœ°åŒ–                â”‚  âœ… UI æœ¬åœ°åŒ–                                 â”‚   â”‚
â”‚   â”‚  - ä¹¦ç±æ ‡é¢˜ã€ä½œè€…å           â”‚  - æŒ‰é’®æ–‡å­—ã€å¯¼èˆªæ ‡ç­¾                         â”‚   â”‚
â”‚   â”‚  - åˆ†ç±»åç§° (Tab name)        â”‚  - æç¤º/é”™è¯¯æ¶ˆæ¯                             â”‚   â”‚
â”‚   â”‚  - æµæ´¾åç§° (genres)          â”‚  - è®¾ç½®é€‰é¡¹ã€çŠ¶æ€æ–‡å­—                         â”‚   â”‚
â”‚   â”‚  - ä¹¦ç±ç®€ä»‹ç­‰                 â”‚                                              â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚  ğŸ“ translations è¡¨           â”‚  ğŸ“ Localizable.xcstrings                    â”‚   â”‚
â”‚   â”‚  ğŸ”„ Accept-Language header    â”‚  ğŸ”„ ç³»ç»Ÿè¯­è¨€è‡ªåŠ¨åŒ¹é…                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### iOS å®¢æˆ·ç«¯ä¿®å¤å†…å®¹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å®¢æˆ·ç«¯ä»£ç ä¿®æ­£                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚   âŒ é”™è¯¯åšæ³• (å·²ç§»é™¤):                                                               â”‚
â”‚   - åœ¨ Localizable.xcstrings ä¸­æ·»åŠ  discoverTab.*, genre.* ç­‰æ•°æ®ç¿»è¯‘æ¡ç›®             â”‚
â”‚   - åœ¨å®¢æˆ·ç«¯ä»£ç ä¸­ä½¿ç”¨ç¿»è¯‘é”®æŸ¥è¯¢æœ¬åœ°ç¿»è¯‘è¡¨                                             â”‚
â”‚                                                                                       â”‚
â”‚   âœ… æ­£ç¡®åšæ³• (å·²å®ç°):                                                               â”‚
â”‚   - å®¢æˆ·ç«¯ç›´æ¥ä½¿ç”¨æœåŠ¡ç«¯è¿”å›çš„ name å­—æ®µ                                               â”‚
â”‚   - å®¢æˆ·ç«¯ç›´æ¥ä½¿ç”¨æœåŠ¡ç«¯è¿”å›çš„ genres æ•°ç»„                                             â”‚
â”‚   - Localizable.xcstrings åªå­˜å‚¨ UI æ–‡æ¡ˆ                                              â”‚
â”‚                                                                                       â”‚
â”‚   ä»£ç ç¤ºä¾‹:                                                                            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  // DiscoverTab.swift                                                        â”‚   â”‚
â”‚   â”‚  var displayName: String {                                                   â”‚   â”‚
â”‚   â”‚      name  // ç›´æ¥ä½¿ç”¨æœåŠ¡ç«¯è¿”å›çš„ nameï¼Œä¸æŸ¥æœ¬åœ°ç¿»è¯‘è¡¨                         â”‚   â”‚
â”‚   â”‚  }                                                                           â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚  // Book.swift                                                               â”‚   â”‚
â”‚   â”‚  var localizedGenres: [String] {                                             â”‚   â”‚
â”‚   â”‚      genres  // ç›´æ¥ä½¿ç”¨æœåŠ¡ç«¯è¿”å›çš„ genresï¼Œä¸åšå®¢æˆ·ç«¯ç¿»è¯‘                     â”‚   â”‚
â”‚   â”‚  }                                                                           â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¿®æ”¹æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | ä¿®æ”¹å†…å®¹ |
|------|----------|
| `ios/Readmigo/Core/Models/DiscoverTab.swift` | displayName ç›´æ¥è¿”å› name å­—æ®µ |
| `ios/Readmigo/Core/Models/Book.swift` | ç§»é™¤ GenreHelperï¼ŒlocalizedGenres ç›´æ¥è¿”å› genres |
| `ios/Readmigo/Localizable.xcstrings` | ç§»é™¤ 53 æ¡æ•°æ®ç¿»è¯‘æ¡ç›® (discoverTab.*, genre.*) |
| `docs/04-development/backend/localization/data-localization-design.md` | æ–°å¢ç¬¬åäºŒç« ï¼šå®¢æˆ·ç«¯æœ¬åœ°åŒ–åŸåˆ™ |

### å¾…è§£å†³é—®é¢˜ (æœåŠ¡ç«¯)

| é—®é¢˜ | æ ¹æœ¬åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|----------|----------|
| åˆ†ç±» Tab æ˜¾ç¤ºè‹±æ–‡ | discover_tabs è¡¨çš„ name å­—æ®µæœªæœ¬åœ°åŒ– | æœåŠ¡ç«¯æ ¹æ® Accept-Language æŸ¥è¯¢ translations è¡¨ |
| ä¹¦ç±æµæ´¾æ˜¾ç¤ºè‹±æ–‡ | books è¡¨çš„ genres å­—æ®µæœªæœ¬åœ°åŒ– | æœåŠ¡ç«¯æ ¹æ® Accept-Language æŸ¥è¯¢ translations è¡¨ |
| ä½œè€…åæ˜¾ç¤ºè‹±æ–‡ | books è¡¨çš„ author å­—æ®µæœªæœ¬åœ°åŒ– | æœåŠ¡ç«¯æ ¹æ® Accept-Language æŸ¥è¯¢ translations è¡¨ |

### æœåŠ¡ç«¯ä¿®å¤æ–¹å‘

æœåŠ¡ç«¯éœ€è¦ç¡®ä¿ API è¿”å›çš„æ•°æ®å·²æ ¹æ® `Accept-Language` header è¿›è¡Œæœ¬åœ°åŒ–ï¼š

1. **åˆ†ç±» Tab API** (`/api/discover/tabs`): è¿”å›çš„ `name` å­—æ®µåº”æ˜¯æœ¬åœ°åŒ–åçš„å€¼
2. **ä¹¦ç±åˆ—è¡¨ API** (`/api/books`, `/api/discover/books`): è¿”å›çš„ `title`, `author`, `genres` åº”æ˜¯æœ¬åœ°åŒ–åçš„å€¼
3. **ä¹¦ç±è¯¦æƒ… API** (`/api/books/:id`): åŒä¸Š

---

## åã€ç»éªŒæ€»ç»“ä¸æœ€ä½³å®è·µ

### 10.1 æ ¸å¿ƒåŸåˆ™: ç¦æ­¢ Seed

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              âš ï¸ å…¨æ ˆç¦æ­¢ Seed åŸåˆ™                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚   âŒ ç¦æ­¢çš„åšæ³•:                                                                       â”‚
â”‚   â”œâ”€â”€ åœ¨ä»£ç ä¸­ç¡¬ç¼–ç åˆ†ç±»ã€Tabã€é…ç½®ç­‰æ•°æ®                                              â”‚
â”‚   â”œâ”€â”€ ä½¿ç”¨ prisma db seed å¡«å……ä¸šåŠ¡æ•°æ®                                                â”‚
â”‚   â”œâ”€â”€ ä» Debug ç¯å¢ƒç›´æ¥å¤åˆ¶é¢„å®šä¹‰çš„åˆ†ç±»æ•°æ®                                            â”‚
â”‚   â””â”€â”€ åœ¨ API è¿”å›ä¸­ç¡¬ç¼–ç  "All"ã€"For You" ç­‰ Tab                                     â”‚
â”‚                                                                                       â”‚
â”‚   âœ… æ­£ç¡®çš„åšæ³•:                                                                       â”‚
â”‚   â”œâ”€â”€ æ‰€æœ‰ä¸šåŠ¡æ•°æ®å¿…é¡»ä»å®é™…æ•°æ®æºè®¡ç®—ç”Ÿæˆ                                              â”‚
â”‚   â”œâ”€â”€ åˆ†ç±»æ•°æ®ä»ä¹¦ç±çš„ genres å­—æ®µåŠ¨æ€ç”Ÿæˆ                                             â”‚
â”‚   â”œâ”€â”€ Tab æ•°æ®ä»åˆ†ç±»è¡¨åŠ¨æ€æŸ¥è¯¢å¹¶ç¼“å­˜                                                   â”‚
â”‚   â””â”€â”€ ä½¿ç”¨å¯å¤ç”¨è„šæœ¬ï¼Œæ”¯æŒå¢é‡æ›´æ–°å’Œé‡å»º                                               â”‚
â”‚                                                                                       â”‚
â”‚   åŸå› :                                                                                â”‚
â”‚   â”œâ”€â”€ æ•°æ®ä¸€è‡´æ€§: Seed æ•°æ®ä¸å®é™…å†…å®¹å¯èƒ½ä¸åŒ¹é…                                        â”‚
â”‚   â”œâ”€â”€ å¯ç»´æŠ¤æ€§: ç¡¬ç¼–ç æ•°æ®éš¾ä»¥è¿½è¸ªå’Œæ›´æ–°                                               â”‚
â”‚   â””â”€â”€ å¯æ‰©å±•æ€§: æ–°ä¹¦å¯¼å…¥æ—¶éœ€è¦è‡ªåŠ¨æ›´æ–°åˆ†ç±»                                             â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.2 åˆ†ç±»ç”Ÿæˆç»éªŒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           åˆ†ç±»ç”Ÿæˆè¸©å‘ä¸è§£å†³æ–¹æ¡ˆ                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚   é—®é¢˜ 1: Genre å‘½åä¸ä¸€è‡´                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   ç°è±¡: åŒä¸€åˆ†ç±»æœ‰å¤šç§å†™æ³•                                                     â”‚   â”‚
â”‚   â”‚   - "fiction" vs "Fiction"                                                    â”‚   â”‚
â”‚   â”‚   - "classics" vs "Classic Literature" vs "Classics"                          â”‚   â”‚
â”‚   â”‚   - "childrens" vs "Children's Literature"                                    â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   è§£å†³: ä½¿ç”¨å½’ä¸€åŒ–æ˜ å°„è¡¨                                                        â”‚   â”‚
â”‚   â”‚   GENRE_NORMALIZE_MAP = {                                                     â”‚   â”‚
â”‚   â”‚     'fiction': 'Fiction',                                                     â”‚   â”‚
â”‚   â”‚     'classics': 'Classics',                                                   â”‚   â”‚
â”‚   â”‚     'classic literature': 'Classics',                                         â”‚   â”‚
â”‚   â”‚     ...                                                                       â”‚   â”‚
â”‚   â”‚   }                                                                            â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   é—®é¢˜ 2: bookCount ç»Ÿè®¡ä¸å®Œæ•´                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   ç°è±¡: Root åˆ†ç±»æ˜¾ç¤ºçš„ä¹¦ç±æ•°è¿œå°‘äºå®é™…                                         â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   åŸå› : åªç»Ÿè®¡äº†å­åˆ†ç±»çš„ä¹¦ç±ï¼Œæ¼æ‰ç›´æ¥å…³è”åˆ° Root çš„ä¹¦ç±                        â”‚   â”‚
â”‚   â”‚   - ä¹¦ç± genres: ["Classics"] â†’ ç›´æ¥å…³è” Root "Classics"                      â”‚   â”‚
â”‚   â”‚   - ä¹¦ç± genres: ["Classic Literature"] â†’ å…³è” Childï¼Œå†å½’å± Root            â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   è§£å†³: ç»Ÿè®¡æ—¶åˆå¹¶ä¸¤ç§æ¥æº                                                      â”‚   â”‚
â”‚   â”‚   totalBooks = directBooks + childBooks                                       â”‚   â”‚
â”‚   â”‚   directBooks = root._count.books                                             â”‚   â”‚
â”‚   â”‚   childBooks = root.children.reduce((sum, c) => sum + c._count.books, 0)     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   é—®é¢˜ 3: è„šæœ¬å¯å¤ç”¨æ€§                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   éœ€æ±‚: åç»­æ–°ä¹¦å¯¼å…¥æ—¶éœ€è¦é‡å¤æ‰§è¡Œåˆ†ç±»æ›´æ–°                                       â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   è§£å†³: è„šæœ¬è®¾è®¡æ”¯æŒå¤šç§æ¨¡å¼                                                     â”‚   â”‚
â”‚   â”‚   - å¢é‡æ¨¡å¼ (é»˜è®¤): åªæ·»åŠ æ–°åˆ†ç±»å’Œå…³è”ï¼Œä¸åˆ é™¤                                 â”‚   â”‚
â”‚   â”‚   - é‡å»ºæ¨¡å¼ (--clean): åˆ é™¤æ‰€æœ‰åˆ†ç±»åé‡æ–°ç”Ÿæˆ                                  â”‚   â”‚
â”‚   â”‚   - é¢„è§ˆæ¨¡å¼ (--dry-run): åªè¾“å‡ºå°†è¦æ‰§è¡Œçš„æ“ä½œ                                  â”‚   â”‚
â”‚   â”‚   - å¤šç¯å¢ƒæ”¯æŒ (--db=staging/debug): æ”¯æŒä¸åŒç›®æ ‡ç¯å¢ƒ                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.3 ç¼“å­˜å¤„ç†ç»éªŒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ç¼“å­˜ç›¸å…³æ³¨æ„äº‹é¡¹                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚   é—®é¢˜: æ›´æ–°æ•°æ®åº“å API ä»è¿”å›æ—§æ•°æ®                                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   ç°è±¡: discover_tabs è¡¨å·²æ›´æ–°ï¼Œä½† /api/v1/recommendation/discover/tabs     â”‚   â”‚
â”‚   â”‚         æ¥å£ä»è¿”å›æ—§çš„ Tab åˆ—è¡¨                                               â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   åŸå› : RecommendationService.getDiscoverTabs() ä½¿ç”¨ Redis ç¼“å­˜               â”‚   â”‚
â”‚   â”‚         ç¼“å­˜ Key: "discover:tabs"                                             â”‚   â”‚
â”‚   â”‚         ç¼“å­˜ TTL: 3600 ç§’ (1 å°æ—¶)                                            â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   è§£å†³æ–¹æ¡ˆ:                                                                    â”‚   â”‚
â”‚   â”‚   1. ç­‰å¾…ç¼“å­˜è‡ªåŠ¨è¿‡æœŸ (æœ€å¤š 1 å°æ—¶)                                            â”‚   â”‚
â”‚   â”‚   2. é‡å¯ Staging åç«¯æœåŠ¡ (æ¸…ç©º Redis è¿æ¥)                                   â”‚   â”‚
â”‚   â”‚   3. æ‰‹åŠ¨æ¸…é™¤ç¼“å­˜ (éœ€è¦ Redis è®¿é—®æƒé™):                                       â”‚   â”‚
â”‚   â”‚      redis-cli DEL discover:tabs                                              â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   å…¶ä»–ç¼“å­˜ç›¸å…³ Key (ä¾›å‚è€ƒ):                                                           â”‚
â”‚   â”œâ”€â”€ books:list:*       - ä¹¦ç±åˆ—è¡¨ç¼“å­˜                                              â”‚
â”‚   â”œâ”€â”€ books:detail:{id}  - ä¹¦ç±è¯¦æƒ…ç¼“å­˜                                              â”‚
â”‚   â”œâ”€â”€ authors:list:*     - ä½œè€…åˆ—è¡¨ç¼“å­˜                                              â”‚
â”‚   â””â”€â”€ discover:*         - å‘ç°é¡µç›¸å…³ç¼“å­˜                                            â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.4 æ–°ä¹¦å¯¼å…¥åçš„æ ‡å‡†æ“ä½œæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           æ–°ä¹¦å¯¼å…¥åæ ‡å‡†æ“ä½œ                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚   å½“æœ‰æ–°ä¹¦å¯¼å…¥åˆ° Staging åï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤æ›´æ–°åˆ†ç±»å’Œå‘ç°é¡µ:                              â”‚
â”‚                                                                                       â”‚
â”‚   Step 1: ç”Ÿæˆ/æ›´æ–°åˆ†ç±»                                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   # å¢é‡æ›´æ–° (æ¨èï¼Œä¿ç•™ç°æœ‰åˆ†ç±»)                                              â”‚   â”‚
â”‚   â”‚   npx tsx scripts/generate-categories-from-books.ts --db=staging             â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   # æˆ–å®Œå…¨é‡å»º (é€‚ç”¨äºå¤§è§„æ¨¡å˜æ›´)                                               â”‚   â”‚
â”‚   â”‚   npx tsx scripts/generate-categories-from-books.ts --db=staging --clean     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   Step 2: æ›´æ–°å‘ç°é¡µ Tab                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   DATABASE_URL='postgresql://...' npx tsx scripts/sync-discover-tabs.ts      â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   Step 3: ç­‰å¾…æˆ–æ¸…é™¤ç¼“å­˜                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   # é€‰é¡¹ A: ç­‰å¾… 1 å°æ—¶ç¼“å­˜è‡ªåŠ¨è¿‡æœŸ                                            â”‚   â”‚
â”‚   â”‚   # é€‰é¡¹ B: é‡å¯ Staging åç«¯                                                  â”‚   â”‚
â”‚   â”‚   fly apps restart readmigo-staging                                           â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   Step 4: éªŒè¯                                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   curl -s https://readmigo-staging.fly.dev/api/v1/recommendation/discover/tabs â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.5 ç›¸å…³è„šæœ¬æ¸…å•

| è„šæœ¬ | ç”¨é€” | æ‰§è¡Œç¯å¢ƒ |
|------|------|----------|
| `scripts/generate-categories-from-books.ts` | ä»ä¹¦ç± genres ç”Ÿæˆåˆ†ç±» | æœ¬åœ°/Droplet |
| `scripts/sync-discover-tabs.ts` | ä»åˆ†ç±»è¡¨ç”Ÿæˆå‘ç°é¡µ Tab | æœ¬åœ°/Droplet |
| `scripts/sync-booklist-to-staging.ts` | æŒ‰ä¹¦å•åŒæ­¥ä¹¦ç±/ä½œè€…åˆ° Staging | Droplet |
| `scripts/sync-debug-to-staging.ts` | æ‰¹é‡åŒæ­¥ Debug æ•°æ®åˆ° Staging | Droplet |
| `scripts/fix-author-avatars.ts` | ä¿®å¤ä½œè€…å¤´åƒé‡å¤è®°å½•é—®é¢˜ | æœ¬åœ°/Droplet |
| `scripts/staging-deploy.sh` | ä¸€é”®éƒ¨ç½²è„šæœ¬ (Stage 4.5 - 4.8) | Droplet |

### 10.6 ä½œè€…å¤´åƒå¤„ç†ç»éªŒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ä½œè€…å¤´åƒå¤„ç†è¸©å‘ä¸è§£å†³æ–¹æ¡ˆ                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚   âš ï¸ æ ¸å¿ƒåŸåˆ™: ç¦æ­¢ä½¿ç”¨å­—æ¯å ä½ç¬¦å¤´åƒ                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   âŒ ç¦æ­¢: ä½¿ç”¨ DiceBear API ç”Ÿæˆå­—æ¯å ä½ç¬¦ (å¦‚ "SJ", "MT")                    â”‚   â”‚
â”‚   â”‚   âŒ ç¦æ­¢: ä½¿ç”¨ ui-avatars.com ç­‰æœåŠ¡ç”Ÿæˆå­—æ¯å¤´åƒ                               â”‚   â”‚
â”‚   â”‚   âœ… æ­£ç¡®: æ‰¾ä¸åˆ°çœŸå®å¤´åƒæ—¶å¿…é¡»æŠ¥é”™ï¼Œç”±äººå·¥å¤„ç†                                   â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   åŸå› :                                                                        â”‚   â”‚
â”‚   â”‚   - å­—æ¯å¤´åƒåœ¨ App ä¸­æ˜¾ç¤ºæ•ˆæœå·®ï¼Œç”¨æˆ·ä½“éªŒä¸ä½³                                   â”‚   â”‚
â”‚   â”‚   - å­—æ¯å¤´åƒå®¹æ˜“ä¸çœŸå®å¤´åƒæ··æ·†ï¼Œéš¾ä»¥å‘ç°é—®é¢˜                                     â”‚   â”‚
â”‚   â”‚   - R2 URL æŒ‡å‘å­—æ¯å›¾ç‰‡æ—¶ï¼ŒiOS å®¢æˆ·ç«¯ä¼šæ˜¾ç¤ºå­—æ¯è€Œéä½¿ç”¨æœ¬åœ°å ä½ç¬¦               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   é—®é¢˜ 1: å­—æ¯å¤´åƒè¢«ä¸Šä¼ åˆ° R2                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   ç°è±¡: Agora é¡µé¢ä½œè€…å¤´åƒæ˜¾ç¤ºå­—æ¯ (å¦‚ "SJ") è€ŒéçœŸå®ç…§ç‰‡                       â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   åŸå› : import-authors.ts è„šæœ¬é€»è¾‘:                                           â”‚   â”‚
â”‚   â”‚   1. å°è¯•ä» Wikipedia ä¸‹è½½å¤´åƒ                                                â”‚   â”‚
â”‚   â”‚   2. å¦‚æœå¤±è´¥ â†’ ä½¿ç”¨ DiceBear API ç”Ÿæˆå­—æ¯å ä½ç¬¦                               â”‚   â”‚
â”‚   â”‚   3. æŠŠå ä½ç¬¦å›¾ç‰‡ä¸Šä¼ åˆ° R2                                                     â”‚   â”‚
â”‚   â”‚   4. æ•°æ®åº“ avatarUrl æŒ‡å‘ R2 é“¾æ¥ (ä½†å†…å®¹æ˜¯å­—æ¯å›¾ç‰‡)                          â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   è§£å†³: ä½¿ç”¨ Wikidata SPARQL æŸ¥è¯¢ P18 (å›¾ç‰‡) å±æ€§                              â”‚   â”‚
â”‚   â”‚   - æ¯” Wikipedia pageimages API æ›´å¯é                                         â”‚   â”‚
â”‚   â”‚   - è¦†ç›–ç‡æ›´é«˜ï¼Œå†å²äººç‰©å›¾ç‰‡æ›´å…¨                                               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   é—®é¢˜ 2: Wikidata è¿”å›é”™è¯¯çš„äºº                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   ç°è±¡: "Shaw, Bernard" æœç´¢è¿”å›äº†ç°ä»£çš„ Bernard Shawï¼Œè€Œéè§ä¼¯çº³              â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   åŸå› : Wikidata æœç´¢ API è¿”å›æœ€ç›¸å…³ç»“æœï¼Œä½†åŒåäººç‰©ä¼šæ··æ·†                      â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   è§£å†³æ–¹æ¡ˆ:                                                                    â”‚   â”‚
â”‚   â”‚   1. ä¼˜å…ˆä½¿ç”¨ä½œè€…çš„ wikidataId (å¦‚æœæ•°æ®åº“ä¸­å·²æœ‰)                              â”‚   â”‚
â”‚   â”‚   2. æœç´¢æ—¶ä½¿ç”¨å®Œæ•´åç§° + ç”Ÿå’å¹´ (å¦‚ "George Bernard Shaw 1856-1950")          â”‚   â”‚
â”‚   â”‚   3. å¯¹é‡è¦ä½œè€…ç»´æŠ¤æ‰‹åŠ¨æ˜ å°„è¡¨ KNOWN_AUTHORS                                    â”‚   â”‚
â”‚   â”‚   4. ä¸Šä¼ åäººå·¥æŠ½æ£€éªŒè¯å›¾ç‰‡æ˜¯å¦æ­£ç¡®                                            â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   é—®é¢˜ 3: CDN ç¼“å­˜å¯¼è‡´å›¾ç‰‡ä¸æ›´æ–°                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   ç°è±¡: R2 å·²ä¸Šä¼ æ–°å›¾ç‰‡ï¼Œä½†æµè§ˆå™¨/App ä»æ˜¾ç¤ºæ—§å›¾ç‰‡                              â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   åŸå› : Cloudflare R2 public bucket ä½¿ç”¨ CDN è¾¹ç¼˜ç¼“å­˜                          â”‚   â”‚
â”‚   â”‚   - ä¸åŒåœ°ç†ä½ç½®çš„ CDN èŠ‚ç‚¹ç¼“å­˜ä¸åŒç‰ˆæœ¬                                        â”‚   â”‚
â”‚   â”‚   - å³ä½¿æºæ–‡ä»¶æ›´æ–°ï¼Œè¾¹ç¼˜èŠ‚ç‚¹å¯èƒ½ä»è¿”å›æ—§ç¼“å­˜                                    â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   è§£å†³æ–¹æ¡ˆ:                                                                    â”‚   â”‚
â”‚   â”‚   1. ä¸Šä¼ æ—¶è®¾ç½® Cache-Control: no-cache, max-age=0                            â”‚   â”‚
â”‚   â”‚   2. æ›´æ–°æ•°æ®åº“ URL æ·»åŠ ç¼“å­˜åˆ·æ–°å‚æ•°: ?v={timestamp}                           â”‚   â”‚
â”‚   â”‚   3. å®¢æˆ·ç«¯å¼ºåˆ¶åˆ·æ–°æˆ–æ¸…é™¤å›¾ç‰‡ç¼“å­˜                                              â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   é¢„é˜²æªæ–½:                                                                    â”‚   â”‚
â”‚   â”‚   - åˆæ¬¡ä¸Šä¼ æ—¶å°±åœ¨ URL ä¸­åŒ…å«ç‰ˆæœ¬å·                                            â”‚   â”‚
â”‚   â”‚   - æ›´æ–°å¤´åƒæ—¶åŒæ—¶æ›´æ–°æ•°æ®åº“ URL çš„ç‰ˆæœ¬å‚æ•°                                    â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   é—®é¢˜ 4: ä½œè€… ID é‡å¤                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   ç°è±¡: åŒä¸€ä½œè€…åœ¨æ•°æ®åº“ä¸­æœ‰å¤šæ¡è®°å½• (ä¸åŒ ID)                                  â”‚   â”‚
â”‚   â”‚   - "F. Scott Fitzgerald" (ID: ac11f567...)                                   â”‚   â”‚
â”‚   â”‚   - "Fitzgerald, F. Scott (Francis Scott), 1896-1940" (ID: fe4c8179...)      â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   å½±å“:                                                                        â”‚   â”‚
â”‚   â”‚   - ä¿®å¤å¤´åƒæ—¶å¯èƒ½ä¿®å¤é”™è¯¯çš„ ID                                                â”‚   â”‚
â”‚   â”‚   - Agora ä½¿ç”¨çš„ä½œè€… ID ä¸å…¶ä»–åœ°æ–¹ä¸ä¸€è‡´                                       â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   è§£å†³: ä¿®å¤å‰å…ˆæŸ¥è¯¢ç¡®è®¤æ­£ç¡®çš„ä½œè€… ID                                           â”‚   â”‚
â”‚   â”‚   SELECT * FROM Author WHERE name LIKE '%Fitzgerald%';                        â”‚   â”‚
â”‚   â”‚   SELECT authorId FROM AgoraPost WHERE author.name LIKE '%Fitzgerald%';       â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   å¤´åƒä¿®å¤æ ‡å‡†æµç¨‹:                                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   Step 1: æŸ¥è¯¢éœ€è¦ä¿®å¤çš„ä½œè€…                                                   â”‚   â”‚
â”‚   â”‚   - ç¡®è®¤æ­£ç¡®çš„ä½œè€… ID (ç‰¹åˆ«æ˜¯ Agora ä½¿ç”¨çš„ ID)                                 â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   Step 2: è·å–çœŸå®å¤´åƒ                                                         â”‚   â”‚
â”‚   â”‚   - ä¼˜å…ˆ: Wikidata SPARQL æŸ¥è¯¢ P18 å±æ€§                                       â”‚   â”‚
â”‚   â”‚   - å¤‡é€‰: Wikipedia API (pageimages)                                          â”‚   â”‚
â”‚   â”‚   - æ‰‹åŠ¨: ç›´æ¥ä½¿ç”¨ Wikimedia Commons URL                                      â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   Step 3: å¤„ç†å¹¶ä¸Šä¼                                                            â”‚   â”‚
â”‚   â”‚   - ä½¿ç”¨ sharp å¤„ç†: resize(400, 400), jpeg({ quality: 85 })                  â”‚   â”‚
â”‚   â”‚   - ä¸Šä¼ åˆ° R2: authors/{authorId}/avatar.jpg                                  â”‚   â”‚
â”‚   â”‚   - è®¾ç½® Cache-Control: no-cache, max-age=0                                   â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   Step 4: æ›´æ–°æ•°æ®åº“                                                           â”‚   â”‚
â”‚   â”‚   - æ›´æ–° avatarUrl å¹¶æ·»åŠ ç¼“å­˜åˆ·æ–°å‚æ•° ?v={timestamp}                           â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   Step 5: éªŒè¯                                                                 â”‚   â”‚
â”‚   â”‚   - ä¸‹è½½å›¾ç‰‡å¹¶ç›®è§†ç¡®è®¤æ˜¯å¦ä¸ºæ­£ç¡®çš„äººç‰©è‚–åƒ                                      â”‚   â”‚
â”‚   â”‚   - æ£€æŸ¥ API è¿”å›çš„ avatarUrl æ˜¯å¦æ­£ç¡®                                         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.7 ç›¸å…³è„šæœ¬è¯´æ˜

| è„šæœ¬ | ç”¨é€” | å…³é”®ç‚¹ |
|------|------|--------|
| `scripts/fix-author-avatars.ts` | æ‰¹é‡ä¿®å¤ä½œè€…å¤´åƒ | ä½¿ç”¨å¤šæ•°æ®æº: Wikidata â†’ Wikipedia â†’ Open Library â†’ LoC |
| `scripts/fetch-real-avatars.ts` | ä¸º Agora ä½œè€…è·å–çœŸå®å¤´åƒ | ä½¿ç”¨ Wikidata SPARQL æŸ¥è¯¢ P18 å±æ€§ |
| `scripts/fix-fitzgerald-agora.ts` | æ‰‹åŠ¨ä¿®å¤ç‰¹å®šä½œè€… | ç›´æ¥ä½¿ç”¨ Wikimedia Commons URL |

### 10.8 æ•°æ®åº“è¿æ¥æ’æŸ¥ç»éªŒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Prisma è¿æ¥é”™è¯¯æ•°æ®åº“æ’æŸ¥æµç¨‹                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚   é—®é¢˜ç°è±¡                                                                            â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                           â”‚
â”‚   â€¢ iOS å®¢æˆ·ç«¯æ˜¾ç¤º 5 ä¸ªæ—§ Tab (Literature & Fiction, Philosophy & Ethics...)         â”‚
â”‚   â€¢ API è¿”å›çš„æ•°æ®ä¸æ•°æ®åº“æŸ¥è¯¢ç»“æœä¸ä¸€è‡´                                               â”‚
â”‚   â€¢ åˆ·æ–° Redis ç¼“å­˜åé—®é¢˜ä¾ç„¶å­˜åœ¨                                                      â”‚
â”‚                                                                                       â”‚
â”‚   æ’æŸ¥æ­¥éª¤                                                                            â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                           â”‚
â”‚                                                                                       â”‚
â”‚   1. éªŒè¯ Redis ç¼“å­˜                                                                  â”‚
â”‚      curl https://readmigo-staging.fly.dev/api/v1/recommendation/cache/status        â”‚
â”‚      â†’ ç¼“å­˜æ˜¾ç¤ºæ­£å¸¸ (tabs: 5)                                                         â”‚
â”‚                                                                                       â”‚
â”‚   2. éªŒè¯æ•°æ®åº“æ•°æ®                                                                   â”‚
â”‚      psql $DATABASE_URL -c "SELECT * FROM discover_tabs WHERE is_active=true"        â”‚
â”‚      â†’ è¿”å› 8 ä¸ªæ–° Tab âœ“                                                              â”‚
â”‚                                                                                       â”‚
â”‚   3. å…³é”®å‘ç°: Prisma ä¸ psql è¿”å›ä¸åŒæ•°æ®                                            â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚      â”‚  psql $DATABASE_URL      â†’ 8 ä¸ªæ–° Tab (Classics, Fiction...)        â”‚        â”‚
â”‚      â”‚  Prisma $queryRaw       â†’ 5 ä¸ªæ—§ Tab (Literature & Fiction...)      â”‚        â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                                       â”‚
â”‚   4. æ£€æŸ¥ .env æ–‡ä»¶                                                                   â”‚
â”‚      â€¢ /apps/backend/.env.staging     â†’ ep-shy-cloud-a1depd3i (æ–°æ•°æ®åº“) âœ“           â”‚
â”‚      â€¢ /packages/database/.env        â†’ ep-small-queen-a1du4xmc (æ—§æ•°æ®åº“) âœ—         â”‚
â”‚                                                                                       â”‚
â”‚   æ ¹æœ¬åŸå›                                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                           â”‚
â”‚   Prisma Client ä» packages/database/.env åŠ è½½ DATABASE_URL                          â”‚
â”‚   è¯¥æ–‡ä»¶æŒ‡å‘æ—§çš„ Neon æ•°æ®åº“é¡¹ç›®ï¼Œä¸ apps/backend/.env.staging ä¸ä¸€è‡´                  â”‚
â”‚                                                                                       â”‚
â”‚   ä¿®å¤æ–¹æ¡ˆ                                                                            â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                           â”‚
â”‚   1. æ›´æ–° /packages/database/.env ä¸­çš„ DATABASE_URL                                   â”‚
â”‚      DATABASE_URL=postgresql://...@ep-shy-cloud-a1depd3i.ap-southeast-1...           â”‚
â”‚                                                                                       â”‚
â”‚   2. é‡æ–°ç”Ÿæˆ Prisma Client                                                          â”‚
â”‚      cd packages/database && npx prisma generate                                     â”‚
â”‚                                                                                       â”‚
â”‚   3. é‡å¯æœåŠ¡                                                                         â”‚
â”‚      pm2 restart readmigo-staging                                                    â”‚
â”‚                                                                                       â”‚
â”‚   4. åˆ·æ–° Redis ç¼“å­˜                                                                  â”‚
â”‚      curl -X POST https://readmigo-staging.fly.dev/api/v1/recommendation/cache/refresh â”‚
â”‚                                                                                       â”‚
â”‚   é¢„é˜²æªæ–½                                                                            â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                           â”‚
â”‚   â€¢ Monorepo ä¸­æ‰€æœ‰ .env æ–‡ä»¶å¿…é¡»æŒ‡å‘åŒä¸€ä¸ªæ•°æ®åº“å®ä¾‹                                  â”‚
â”‚   â€¢ åˆ‡æ¢æ•°æ®åº“æ—¶ï¼Œæ£€æŸ¥ä»¥ä¸‹ä½ç½®:                                                        â”‚
â”‚     - apps/backend/.env, .env.staging, .env.production                               â”‚
â”‚     - packages/database/.env                                                         â”‚
â”‚   â€¢ ä½¿ç”¨ grep -r "neon.tech" æŸ¥æ‰¾æ‰€æœ‰æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²                                  â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.9 Fly.io éƒ¨ç½²ç¯å¢ƒåŒæ­¥ç»éªŒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Fly.io ä¸ Droplet ç¯å¢ƒä¸åŒæ­¥é—®é¢˜                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚   é—®é¢˜ç°è±¡                                                                            â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                           â”‚
â”‚   â€¢ Droplet å·²ä¿®å¤ packages/database/.envï¼Œé‡å¯ PM2 åæœ¬åœ° API æ­£å¸¸                   â”‚
â”‚   â€¢ iOS å®¢æˆ·ç«¯è¯·æ±‚ Fly.io (readmigo-staging.fly.dev) ä»è¿”å›æ—§æ•°æ®                     â”‚
â”‚   â€¢ 5 ä¸ªæ—§ Tab è€Œé 8 ä¸ªæ–° Tab                                                        â”‚
â”‚                                                                                       â”‚
â”‚   æ ¹æœ¬åŸå›                                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                           â”‚
â”‚   Fly.io æœ‰ç‹¬ç«‹çš„ secrets é…ç½®ï¼Œä¸ Droplet .env æ–‡ä»¶ç›¸äº’ç‹¬ç«‹:                          â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  ç¯å¢ƒ              â”‚  é…ç½®ä½ç½®                  â”‚  DATABASE_URL              â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚  Droplet PM2       â”‚  packages/database/.env   â”‚  ep-shy-cloud (æ–°) âœ“        â”‚   â”‚
â”‚   â”‚  Fly.io Staging    â”‚  fly secrets             â”‚  ep-small-queen (æ—§) âœ—       â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   ä¿®å¤æ­¥éª¤                                                                            â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                           â”‚
â”‚                                                                                       â”‚
â”‚   1. æ›´æ–° Fly.io secrets                                                             â”‚
â”‚      fly secrets set DATABASE_URL="postgresql://...@ep-shy-cloud..." -a readmigo-staging â”‚
â”‚                                                                                       â”‚
â”‚   2. é‡å¯ Fly.io æœºå™¨                                                                 â”‚
â”‚      fly apps restart readmigo-staging                                               â”‚
â”‚                                                                                       â”‚
â”‚   3. æ¸…ç† Redis ç¼“å­˜ (å¿…é¡»åœ¨ Fly.io å®¹å™¨å†…æ‰§è¡Œ)                                        â”‚
â”‚      fly ssh console -a readmigo-staging                                             â”‚
â”‚      > ä½¿ç”¨ node è¿æ¥ Redis åˆ é™¤ discover:v2:* é”®                                     â”‚
â”‚                                                                                       â”‚
â”‚   4. åˆ·æ–°ç¼“å­˜                                                                         â”‚
â”‚      curl -X POST https://readmigo-staging.fly.dev/api/v1/recommendation/cache/refresh â”‚
â”‚                                                                                       â”‚
â”‚   5. éªŒè¯ API è¿”å›                                                                    â”‚
â”‚      curl https://readmigo-staging.fly.dev/api/v1/recommendation/discover/tabs        â”‚
â”‚                                                                                       â”‚
â”‚   âš ï¸ å…³é”®æé†’                                                                         â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                           â”‚
â”‚   â€¢ Fly.io secrets ç‹¬ç«‹äºä»£ç ä»“åº“å’Œ Droplet é…ç½®                                      â”‚
â”‚   â€¢ åˆ‡æ¢æ•°æ®åº“æ—¶ï¼Œå¿…é¡»åŒæ—¶æ›´æ–°:                                                        â”‚
â”‚     1. Droplet: packages/database/.env + apps/backend/.env.staging                   â”‚
â”‚     2. Fly.io: fly secrets set DATABASE_URL=... -a readmigo-staging                  â”‚
â”‚   â€¢ Redis ç¼“å­˜åœ¨ Fly.io å®¹å™¨å†…ï¼ŒDroplet çš„ redis-cli æ— æ³•è®¿é—®                          â”‚
â”‚   â€¢ ç¼“å­˜åˆ·æ–° API åœ¨ Fly.io ä¸Šè¿è¡Œï¼Œä¼šè‡ªåŠ¨ä½¿ç”¨ Fly.io çš„ Redis è¿æ¥                     â”‚
â”‚                                                                                       â”‚
â”‚   æ£€æŸ¥æ¸…å• (åˆ‡æ¢æ•°æ®åº“æ—¶)                                                              â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                               â”‚
â”‚   â–¡ packages/database/.env æ›´æ–°                                                       â”‚
â”‚   â–¡ apps/backend/.env.staging æ›´æ–°                                                    â”‚
â”‚   â–¡ Droplet PM2 é‡å¯: pm2 restart readmigo-staging                                   â”‚
â”‚   â–¡ Fly.io secrets æ›´æ–°: fly secrets set DATABASE_URL=...                            â”‚
â”‚   â–¡ Fly.io é‡å¯: fly apps restart readmigo-staging                                   â”‚
â”‚   â–¡ Redis ç¼“å­˜æ¸…ç† (é€šè¿‡ fly ssh æˆ– cache/refresh API)                                â”‚
â”‚   â–¡ API éªŒè¯: curl /recommendation/discover/tabs                                      â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.10 ä¹¦ç±åŒæ­¥ä¸åˆ†ç±»å…³è”ç»éªŒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ä¹¦ç±å¯¼å…¥ä¸åˆ†ç±»å…³è”è¸©å‘è®°å½•                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚   åœºæ™¯: æ–°æ•°æ®åº“åªæœ‰åˆ†ç±»ç»“æ„ï¼Œéœ€è¦ä» Debug å¯¼å…¥ä¹¦ç±å¹¶å…³è”åˆ†ç±»                            â”‚
â”‚                                                                                       â”‚
â”‚   é—®é¢˜ 1: éƒ¨åˆ†ä¹¦ç±å¯¼å…¥å¤±è´¥ (å¤–é”®çº¦æŸ)                                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   ç°è±¡: "Hound of the Baskervilles" ç­‰ä¹¦ç±åˆ›å»ºå¤±è´¥                            â”‚   â”‚
â”‚   â”‚   é”™è¯¯: Foreign key constraint failed on the field: author_id               â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   åŸå› : ä¹¦ç±çš„ authorId æŒ‡å‘çš„ä½œè€…æœªåŒæ­¥åˆ° staging                             â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   è§£å†³: åŒæ­¥è„šæœ¬åº”å…ˆåŒæ­¥ authors å†åŒæ­¥ books                                   â”‚   â”‚
â”‚   â”‚   - ä»ä¹¦å•è§£æä½œè€…åˆ—è¡¨                                                         â”‚   â”‚
â”‚   â”‚   - æŒ‰ä½œè€…ååŒ¹é… Debug ä¸­çš„ä½œè€…è®°å½•                                            â”‚   â”‚
â”‚   â”‚   - å…ˆåˆ›å»ºä½œè€…ï¼Œå†åˆ›å»ºä¹¦ç±                                                      â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   é—®é¢˜ 2: ä¹¦ç±æœªå…³è”åˆ° Discover Tab åˆ†ç±»                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   ç°è±¡: ä¹¦ç±å·²å¯¼å…¥ï¼Œä½† Tab æ˜¾ç¤º 0 æœ¬ä¹¦                                          â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   åŸå› : book_categories è¡¨é“¾æ¥åˆ°å­åˆ†ç±» IDï¼Œè€Œé discover_tabs çš„ categoryId    â”‚   â”‚
â”‚   â”‚   - Discover Tab çš„ categoryId æŒ‡å‘ Level 0 (Root) åˆ†ç±»                       â”‚   â”‚
â”‚   â”‚   - ä¹¦ç±å¯èƒ½åªé“¾æ¥åˆ° Level 1 (Child) åˆ†ç±»                                      â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   è§£å†³: åˆ†ç±»è¿‡æ»¤æ—¶éœ€è¦åŒ…å«å­åˆ†ç±»                                                â”‚   â”‚
â”‚   â”‚   discover-cache.service.ts ä¸­çš„ buildBooksCache():                           â”‚   â”‚
â”‚   â”‚   const childCategories = await prisma.category.findMany({                    â”‚   â”‚
â”‚   â”‚     where: { parentId: categoryId, isActive: true }                           â”‚   â”‚
â”‚   â”‚   });                                                                          â”‚   â”‚
â”‚   â”‚   const categoryIds = [categoryId, ...childCategories.map(c => c.id)];        â”‚   â”‚
â”‚   â”‚   where.categories = { some: { categoryId: { in: categoryIds } } };           â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   é—®é¢˜ 3: genres æœªæ­£ç¡®æ˜ å°„åˆ° Root åˆ†ç±»                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   ç°è±¡: ä¹¦ç± genres æ˜¯ "Classic Literature"ï¼Œä½† Tab æ˜¯ "Classics"             â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   åŸå› : generate-categories-from-books.ts çš„ GENRE_GROUPS æ˜ å°„                 â”‚   â”‚
â”‚   â”‚   éœ€è¦æŠŠ "Classic Literature" ä½œä¸º "Classics" çš„å­åˆ†ç±»                          â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   æ­£ç¡®é…ç½®:                                                                    â”‚   â”‚
â”‚   â”‚   GENRE_GROUPS = {                                                            â”‚   â”‚
â”‚   â”‚     'Classics': ['Classic Literature', 'American Classics', ...],            â”‚   â”‚
â”‚   â”‚     'Fiction': ['Literary Fiction', 'Historical Fiction', ...],              â”‚   â”‚
â”‚   â”‚     ...                                                                        â”‚   â”‚
â”‚   â”‚   }                                                                            â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â”‚   ä¹¦ç±åŒæ­¥åçš„æ ‡å‡†éªŒè¯æ­¥éª¤                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                           â”‚
â”‚   1. éªŒè¯ä¹¦ç±æ€»æ•°                                                                     â”‚
â”‚      psql -c "SELECT COUNT(*) FROM books WHERE status='ACTIVE'"                      â”‚
â”‚                                                                                       â”‚
â”‚   2. éªŒè¯åˆ†ç±»é“¾æ¥                                                                     â”‚
â”‚      psql -c "SELECT COUNT(*) FROM book_categories"                                  â”‚
â”‚                                                                                       â”‚
â”‚   3. éªŒè¯æ¯ä¸ª Tab çš„ä¹¦ç±æ•°                                                            â”‚
â”‚      for catId in $(discover_tab_category_ids); do                                   â”‚
â”‚        curl ".../discover?categoryId=$catId" | jq '.total'                           â”‚
â”‚      done                                                                             â”‚
â”‚                                                                                       â”‚
â”‚   4. åˆ·æ–°ç¼“å­˜                                                                         â”‚
â”‚      curl -X POST .../recommendation/cache/refresh                                   â”‚
â”‚                                                                                       â”‚
â”‚   5. iOS å®¢æˆ·ç«¯éªŒè¯                                                                   â”‚
â”‚      - Force quit App                                                                â”‚
â”‚      - é‡æ–°æ‰“å¼€æ£€æŸ¥ Discover Tab                                                     â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## åä¸€ã€ä¸€é”®éƒ¨ç½²è„šæœ¬

> **é‡è¦**: ä¸€é”®éƒ¨ç½²è„šæœ¬å¿…é¡»åœ¨ **Droplet** æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼Œä¸æ”¯æŒæœ¬åœ°è¿è¡Œã€‚
>
> åŸå› :
> - Droplet å·²é…ç½®å¥½æ•°æ®åº“è¿æ¥å’Œç¯å¢ƒå˜é‡
> - é¿å…æœ¬åœ°ç½‘ç»œå»¶è¿Ÿå½±å“æ•°æ®åº“æ“ä½œ
> - ç»Ÿä¸€æ‰§è¡Œç¯å¢ƒï¼Œç¡®ä¿è„šæœ¬è¡Œä¸ºä¸€è‡´

### 11.1 è„šæœ¬æ¦‚è¿°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ä¸€é”®éƒ¨ç½²è„šæœ¬æ¶æ„                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                       â”‚
â”‚   è„šæœ¬ä½ç½®: scripts/staging-deploy.sh                                                 â”‚
â”‚                                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                         æ‰§è¡Œæµç¨‹                                              â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                            â”‚   â”‚
â”‚   â”‚   â”‚ ç¯å¢ƒæ£€æŸ¥    â”‚ â”€â”€â–º éªŒè¯ DATABASE_URL, Node.js, ä¾èµ–åŒ…                     â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                                            â”‚   â”‚
â”‚   â”‚          â–¼                                                                    â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                            â”‚   â”‚
â”‚   â”‚   â”‚ Stage 4.5   â”‚ â”€â”€â–º åˆ†ç±»ç”Ÿæˆ (generate-categories-from-books.ts)           â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                                            â”‚   â”‚
â”‚   â”‚          â–¼                                                                    â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                            â”‚   â”‚
â”‚   â”‚   â”‚ Stage 4.6   â”‚ â”€â”€â–º Tab ç”Ÿæˆ (sync-discover-tabs.ts)                       â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                                            â”‚   â”‚
â”‚   â”‚          â–¼                                                                    â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                            â”‚   â”‚
â”‚   â”‚   â”‚ Stage 4.7   â”‚ â”€â”€â–º ä½œè€…å¤´åƒä¿®å¤ (fix-author-avatars.ts)                   â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                                            â”‚   â”‚
â”‚   â”‚          â–¼                                                                    â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                            â”‚   â”‚
â”‚   â”‚   â”‚ Stage 4.8   â”‚ â”€â”€â–º æ¨èæœåŠ¡éªŒè¯ (curl éªŒè¯æ¯ä¸ªåˆ†ç±»)                        â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                                            â”‚   â”‚
â”‚   â”‚          â–¼                                                                    â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                            â”‚   â”‚
â”‚   â”‚   â”‚ Stage 4.9   â”‚ â”€â”€â–º æ ‡é¢˜æ¸…æ´— (clean-book-titles.ts)                        â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                                            â”‚   â”‚
â”‚   â”‚          â–¼                                                                    â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                            â”‚   â”‚
â”‚   â”‚   â”‚ Stage 4.10  â”‚ â”€â”€â–º ç¿»è¯‘å¡«å…… (wikidata-book-enrichment.ts)                 â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                                            â”‚   â”‚
â”‚   â”‚          â–¼                                                                    â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                            â”‚   â”‚
â”‚   â”‚   â”‚ æ¸…é™¤ç¼“å­˜    â”‚ â”€â”€â–º é‡å¯ Fly.io åº”ç”¨ (æ¸…é™¤ Redis ç¼“å­˜)                      â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                                            â”‚   â”‚
â”‚   â”‚          â–¼                                                                    â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                            â”‚   â”‚
â”‚   â”‚   â”‚ éªŒè¯ç»“æœ    â”‚ â”€â”€â–º è°ƒç”¨ API ç¡®è®¤æ›´æ–°ç”Ÿæ•ˆ                                   â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                            â”‚   â”‚
â”‚   â”‚                                                                               â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 11.2 è„šæœ¬å†…å®¹

```bash
#!/bin/bash
# scripts/staging-deploy.sh
# Staging ç¯å¢ƒä¸€é”®éƒ¨ç½²è„šæœ¬ (Stage 4.5 - 4.10)

set -e

# é¢œè‰²å®šä¹‰
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m'

# é…ç½®
STAGING_API="https://readmigo-staging.fly.dev/api/v1"
FLY_APP="readmigo-staging"

echo "================================================"
echo "Staging ç¯å¢ƒä¸€é”®éƒ¨ç½² (Stage 4.5 - 4.10)"
echo "================================================"

# ç¯å¢ƒæ£€æŸ¥
echo -e "\n${YELLOW}[Step 0] ç¯å¢ƒæ£€æŸ¥...${NC}"
if [ -z "$DATABASE_URL" ]; then
    echo -e "${RED}é”™è¯¯: DATABASE_URL æœªè®¾ç½®${NC}"
    exit 1
fi
echo -e "${GREEN}âœ“ DATABASE_URL å·²è®¾ç½®${NC}"

# Stage 4.5: åˆ†ç±»ç”Ÿæˆ
echo -e "\n${YELLOW}[Stage 4.5] ç”Ÿæˆåˆ†ç±»æ•°æ®...${NC}"
npx tsx scripts/generate-categories-from-books.ts
echo -e "${GREEN}âœ“ åˆ†ç±»ç”Ÿæˆå®Œæˆ${NC}"

# Stage 4.6: Tab ç”Ÿæˆ
echo -e "\n${YELLOW}[Stage 4.6] ç”Ÿæˆå‘ç°é¡µ Tab...${NC}"
npx tsx scripts/sync-discover-tabs.ts
echo -e "${GREEN}âœ“ Tab ç”Ÿæˆå®Œæˆ${NC}"

# Stage 4.7: ä½œè€…å¤´åƒä¿®å¤
echo -e "\n${YELLOW}[Stage 4.7] ä¿®å¤ä½œè€…å¤´åƒ...${NC}"
npx tsx scripts/fix-author-avatars.ts
echo -e "${GREEN}âœ“ å¤´åƒä¿®å¤å®Œæˆ${NC}"

# Stage 4.8: æ¨èæœåŠ¡éªŒè¯ (åœ¨æ¸…é™¤ç¼“å­˜å‰å…ˆéªŒè¯)
echo -e "\n${YELLOW}[Stage 4.8] éªŒè¯æ¨èæœåŠ¡...${NC}"
TABS_PRE=$(curl -s "$STAGING_API/recommendation/discover/tabs")
echo "å‘ç° $(echo $TABS_PRE | jq '.tabs | length') ä¸ªåˆ†ç±» (é¢„æ£€)"

# Stage 4.9: æ ‡é¢˜æ¸…æ´—
echo -e "\n${YELLOW}[Stage 4.9] æ¸…æ´—ä¹¦ç±æ ‡é¢˜...${NC}"
npx ts-node -r tsconfig-paths/register src/scripts/data-enrichment/clean-book-titles.ts
echo -e "${GREEN}âœ“ æ ‡é¢˜æ¸…æ´—å®Œæˆ${NC}"

# Stage 4.10: ç¿»è¯‘æ•°æ®å¡«å……
echo -e "\n${YELLOW}[Stage 4.10] å¡«å……ç¿»è¯‘æ•°æ®...${NC}"
npx ts-node -r tsconfig-paths/register src/scripts/data-enrichment/wikidata-book-enrichment.ts 500
echo -e "${GREEN}âœ“ ç¿»è¯‘å¡«å……å®Œæˆ${NC}"

# æ¸…é™¤ç¼“å­˜ (é‡å¯åº”ç”¨)
echo -e "\n${YELLOW}[Cache] é‡å¯åº”ç”¨æ¸…é™¤ç¼“å­˜...${NC}"
fly apps restart $FLY_APP --yes 2>/dev/null || echo "è·³è¿‡é‡å¯ (éœ€è¦ fly CLI)"
sleep 10

# Stage 4.8 éªŒè¯: æ¨èæœåŠ¡å®Œæ•´éªŒè¯
echo -e "\n${YELLOW}[Stage 4.8] éªŒè¯æ¨èæœåŠ¡...${NC}"
TABS=$(curl -s "$STAGING_API/recommendation/discover/tabs")
echo "å‘ç° $(echo $TABS | jq 'length') ä¸ªåˆ†ç±»"

FAILED=0
for row in $(echo $TABS | jq -r '.[] | @base64'); do
    _jq() { echo ${row} | base64 -d | jq -r ${1}; }
    NAME=$(_jq '.name')
    CAT_ID=$(_jq '.categoryId')

    if [ "$CAT_ID" != "null" ]; then
        COUNT=$(curl -s "$STAGING_API/recommendation/discover/books?categoryId=$CAT_ID" | jq '.total')
        if [ "$COUNT" -gt 0 ]; then
            echo -e "  ${GREEN}âœ“${NC} $NAME: $COUNT æœ¬ä¹¦"
        else
            echo -e "  ${RED}âœ—${NC} $NAME: 0 æœ¬ä¹¦"
            FAILED=$((FAILED + 1))
        fi
    fi
done

# ç»“æœæ±‡æ€»
echo -e "\n================================================"
if [ $FAILED -eq 0 ]; then
    echo -e "${GREEN}éƒ¨ç½²æˆåŠŸ! æ‰€æœ‰åˆ†ç±»éªŒè¯é€šè¿‡${NC}"
else
    echo -e "${RED}è­¦å‘Š: $FAILED ä¸ªåˆ†ç±»æ— ä¹¦ç±æ•°æ®${NC}"
fi
echo "================================================"
```

### 11.3 ä½¿ç”¨æ–¹æ³•

```bash
# 1. SSH åˆ° Droplet
ssh root@mcloud88.com

# 2. è¿›å…¥é¡¹ç›®ç›®å½•
cd ~/readmigo

# 3. è®¾ç½®ç¯å¢ƒå˜é‡
export DATABASE_URL='postgresql://user:pass@host/staging_db'

# 4. æ‰§è¡Œä¸€é”®éƒ¨ç½²
bash scripts/staging-deploy.sh

# æˆ–è€…ä½¿ç”¨ npm è„šæœ¬
npm run deploy:staging
```

### 11.4 æ·»åŠ åˆ° package.json

```json
{
  "scripts": {
    "deploy:staging": "bash scripts/staging-deploy.sh",
    "deploy:staging:dry-run": "bash scripts/staging-deploy.sh --dry-run"
  }
}
```

---

## åäºŒã€é—®é¢˜ä¿®å¤è®°å½•

### 12.1 æœ¬åœ°åŒ–æ•°æ®ä¿®å¤ (2026-01-03)

#### é—®é¢˜æè¿°

iOS å®¢æˆ·ç«¯éƒ¨åˆ†å†…å®¹æœªæ­£ç¡®æœ¬åœ°åŒ–ï¼š
1. ä¹¦ç±åˆ†ç±»æ ‡ç­¾ï¼ˆgenresï¼‰æ˜¾ç¤ºè‹±æ–‡ï¼Œå¦‚ "Fiction"ã€"Poetry" è€Œé "å°è¯´"ã€"è¯—æ­Œ"
2. éƒ¨åˆ†ä¹¦ç±æœªå…³è”ä½œè€…ï¼Œå¯¼è‡´ä½œè€…åæ— æ³•æœ¬åœ°åŒ–
3. éƒ¨åˆ†ä½œè€…ç¼ºå°‘ä¸­æ–‡ç¿»è¯‘

#### æ ¹æœ¬åŸå› 

| é—®é¢˜ | åŸå›  |
|------|------|
| Genre æœªæœ¬åœ°åŒ– | `translations` è¡¨ä¸­ç¼ºå°‘ `entityType='genre'` çš„ç¿»è¯‘è®°å½• |
| ä¹¦ç±æ— ä½œè€…å | `books.authorId` ä¸º NULLï¼Œæœªå…³è”åˆ° `authors` è¡¨ |
| ä½œè€…æ— ç¿»è¯‘ | `translations` è¡¨ä¸­ç¼ºå°‘å¯¹åº”ä½œè€…çš„ä¸­æ–‡ç¿»è¯‘ |

#### ä¿®å¤å†…å®¹

**1. Genre ç¿»è¯‘ (85æ¡)**

```
scripts/seed-genre-translations.ts
```

| è‹±æ–‡ | ä¸­æ–‡ |
|------|------|
| Fiction | å°è¯´ |
| Poetry | è¯—æ­Œ |
| Drama | æˆå‰§ |
| Philosophy | å“²å­¦ |
| Classics | ç»å…¸æ–‡å­¦ |
| Science Fiction | ç§‘å¹»å°è¯´ |
| Historical Fiction | å†å²å°è¯´ |
| ... | (å…±85æ¡) |

**2. ä¹¦ç±ä½œè€…å…³è” (91æœ¬)**

å°† 91 æœ¬ä¹¦ç±çš„ `authorId` å…³è”åˆ°å·²å­˜åœ¨çš„ä½œè€…è®°å½•ã€‚

**3. ä½œè€…ç¿»è¯‘ (24ä½)**

| è‹±æ–‡ | ä¸­æ–‡ |
|------|------|
| William Shakespeare | å¨å»‰Â·èå£«æ¯”äºš |
| Charles Dickens | æŸ¥å°”æ–¯Â·ç‹„æ›´æ–¯ |
| Jane Austen | ç®€Â·å¥¥æ–¯æ±€ |
| Leo Tolstoy | åˆ—å¤«Â·æ‰˜å°”æ–¯æ³° |
| Victor Hugo | ç»´å…‹å¤šÂ·é›¨æœ |
| Fyodor Dostoevsky | è´¹å¥¥å¤šå°”Â·é™€æ€å¦¥è€¶å¤«æ–¯åŸº |
| Jules Verne | å„’å‹’Â·å‡¡å°”çº³ |
| Mark Twain | é©¬å…‹Â·åæ¸© |
| Oscar Wilde | å¥¥æ–¯å¡Â·ç‹å°”å¾· |
| Dante Alighieri | ä½†ä¸Â·é˜¿åˆ©å‰è€¶é‡Œ |
| ... | (å…±24ä½) |

**4. æ–°å»ºä½œè€… (4ä½)**

| ä½œè€… | ä¸­æ–‡ | å…³è”ä¹¦ç± |
|------|------|----------|
| Karl Marx | å¡å°”Â·é©¬å…‹æ€ | The Communist Manifesto |
| Adam Smith | äºšå½“Â·æ–¯å¯† | An Inquiry into the Nature and Causes of the Wealth of Nations |
| H. G. Wells | HÂ·GÂ·å¨å°”æ–¯ | The Invisible Man |
| L. M. Montgomery | LÂ·MÂ·è’™å“¥é©¬åˆ© | Anne of Green Gables |

**5. ç‰¹æ®Šä¹¦ç±ä¿®å¤**

| ä¹¦ç± | é—®é¢˜ | ä¿®å¤ |
|------|------|------|
| Faust (æµ®å£«å¾·) | authorId=NULL, æ ‡é¢˜/æè¿°æœªç¿»è¯‘ | å…³è”æ­Œå¾·, æ›´æ–°ç¿»è¯‘ |
| The Analects (è®ºè¯­) | authorId=NULL | å…³è”å­”å­ |
| Aesop's Fables (ä¼Šç´¢å¯“è¨€) | ä½œè€…ç¿»è¯‘ç¼ºå¤± | æ·»åŠ "ä¼Šç´¢" |
| Sindbad the Sailor (è¾›å·´è¾¾èˆªæµ·å†é™©è®°) | author=Anonymous, authorId=NULL | åˆ›å»º"ä½šåï¼ˆä¸€åƒé›¶ä¸€å¤œï¼‰"å¹¶å…³è” |

#### ä¿®å¤ç»“æœ

| æŒ‡æ ‡ | ä¿®å¤å‰ | ä¿®å¤å |
|------|--------|--------|
| Genre ç¿»è¯‘ | 0 | 85 |
| ä¹¦ç±æ— ä½œè€…ID | 103 | 9 |
| ä½œè€…æ— ç¿»è¯‘ | 61 | 0 |
| æ€»ä¹¦ç±æ•° | 222 | 222 |

#### ç›¸å…³è„šæœ¬

| è„šæœ¬ | ç”¨é€” |
|------|------|
| `scripts/seed-genre-translations.ts` | å¡«å…… genre ç¿»è¯‘æ•°æ® |

#### éªŒè¯æ–¹æ³•

```bash
# 1. æ£€æŸ¥ genre ç¿»è¯‘
SELECT * FROM translations WHERE entity_type = 'genre' AND locale = 'zh' LIMIT 10;

# 2. æ£€æŸ¥ä¹¦ç±ä½œè€…å…³è”
SELECT COUNT(*) FROM books WHERE author_id IS NULL;

# 3. é‡å¯åç«¯æ¸…é™¤ç¼“å­˜
ssh readmigo@mcloud88.com "pm2 restart readmigo-staging"

# 4. iOS å®¢æˆ·ç«¯éªŒè¯
# - æ‰“å¼€å‘ç° Tab
# - æŸ¥çœ‹ä¹¦ç±è¯¦æƒ…é¡µçš„åˆ†ç±»æ ‡ç­¾å’Œä½œè€…å
```

---

### 2025-01-03: ä¹¦ç±è¯¦æƒ…é¡µä½œè€…åæœªæœ¬åœ°åŒ–

#### é—®é¢˜æè¿°

iOS å®¢æˆ·ç«¯ä¹¦ç±è¯¦æƒ…é¡µä½œè€…åæ˜¾ç¤ºè‹±æ–‡ï¼Œè€Œéä¸­æ–‡ç¿»è¯‘ã€‚ä¾‹å¦‚ï¼š
- ã€Šå¤§è¡—ã€‹(Main Street) - ä½œè€…æ˜¾ç¤º "Sinclair Lewis" è€Œé "è¾›å…‹è±Â·åˆ˜æ˜“æ–¯"
- ã€Šç¾å›½çš„æ‚²å‰§ã€‹- ä½œè€…æ˜¾ç¤º "Theodore Dreiser" è€Œé "è¥¿å¥¥å¤šÂ·å¾·è±å¡"
- ã€Šé²æ»¨é€Šæ¼‚æµè®°ã€‹- ä½œè€…æ˜¾ç¤º "Daniel Defoe" è€Œé "ä¸¹å°¼å°”Â·ç¬›ç¦"
- ã€Šå¯†æ¢ã€‹(The Secret Agent) - ä½œè€…æ˜¾ç¤º "å±•å¼€" (UI æ–‡å­—æ³„æ¼)

#### æ ¹æœ¬åŸå› 

| ç«¯ç‚¹ | é—®é¢˜ |
|------|------|
| `/api/v1/recommendation/discover` | âœ… å·²æœ¬åœ°åŒ– `authorRef`ï¼Œä½†æœªæ›´æ–° `book.author` å­—æ®µ |
| `/api/v1/books/:id` | âŒ å®Œå…¨æœªæœ¬åœ°åŒ–ä½œè€…å |

iOS å®¢æˆ·ç«¯è¯»å– `book.author` å­—æ®µæ˜¾ç¤ºä½œè€…åï¼Œè€Œåç«¯åªæœ¬åœ°åŒ–äº† `authorRef` å¯¹è±¡ï¼ŒæœªåŒæ­¥æ›´æ–° `book.author` å­—ç¬¦ä¸²å­—æ®µã€‚

#### ä¿®å¤å†…å®¹

**1. Discover ç«¯ç‚¹ä¿®å¤**

æ–‡ä»¶: `apps/backend/src/modules/recommendation/recommendation.service.ts` (Lines 253-258)
æ–‡ä»¶: `apps/backend/src/modules/recommendation/services/discover-cache.service.ts` (Lines 284-289)

```typescript
// Update book.author field with localized author name for iOS client
if (localizedAuthors[i].name) {
  books[authorsToLocalize[i].index].book.author = localizedAuthors[i].name;
}
```

**2. ä¹¦ç±è¯¦æƒ…ç«¯ç‚¹ä¿®å¤**

æ–‡ä»¶: `apps/backend/src/modules/books/books.service.ts` (Lines 158-171, 222-235)

```typescript
// Localize author name if authorId exists
if (localizedCached.authorId && locale !== 'en') {
  const authorTranslation = await this.prisma.translation.findFirst({
    where: {
      entityType: 'author',
      entityId: localizedCached.authorId as string,
      fieldName: 'name',
      locale: locale.startsWith('zh') ? 'zh' : locale,
    },
  });
  if (authorTranslation) {
    localizedCached.author = authorTranslation.value;
  }
}
```

**3. ä½œè€…ç¿»è¯‘è¡¥å…… (94ä½)**

| ä½œè€… (è‹±æ–‡) | ä¸­æ–‡ç¿»è¯‘ |
|-------------|----------|
| Theodore Dreiser | è¥¿å¥¥å¤šÂ·å¾·è±å¡ |
| Sinclair Lewis | è¾›å…‹è±Â·åˆ˜æ˜“æ–¯ |
| Daniel Defoe | ä¸¹å°¼å°”Â·ç¬›ç¦ |
| Joseph Conrad | çº¦ç‘Ÿå¤«Â·åº·æ‹‰å¾· |
| Thomas Hardy | æ‰˜é©¬æ–¯Â·å“ˆä»£ |
| Herman Melville | èµ«å°”æ›¼Â·éº¦å°”ç»´å°” |
| Nathaniel Hawthorne | çº³æ’’å°¼å°”Â·éœæ¡‘ |
| Edgar Allan Poe | åŸƒå¾·åŠ Â·çˆ±ä¼¦Â·å¡ |
| ... | (å…±94ä½ä½œè€…) |

#### ä¿®å¤ç»“æœ

| æŒ‡æ ‡ | ä¿®å¤å‰ | ä¿®å¤å |
|------|--------|--------|
| ä½œè€…ç¿»è¯‘æ•° | 24 | 94+ |
| book.author æœ¬åœ°åŒ– | âŒ ä¸æ”¯æŒ | âœ… æ”¯æŒ |
| ä¹¦ç±è¯¦æƒ…é¡µæœ¬åœ°åŒ– | âŒ | âœ… |

#### éªŒè¯æ–¹æ³•

```bash
# 1. éªŒè¯ API è¿”å›æœ¬åœ°åŒ–ä½œè€…å
curl -s -H 'Accept-Language: zh-Hans' \
  'https://staging-api.readmigo.app/api/v1/books/836d5b75-7b8e-4461-80b9-baa124c2cf93' | jq '.author'
# é¢„æœŸè¾“å‡º: "è¾›å…‹è±Â·åˆ˜æ˜“æ–¯"

# 2. åˆ·æ–°ç¼“å­˜
curl -X POST https://staging-api.readmigo.app/api/v1/recommendation/cache/refresh

# 3. iOS å®¢æˆ·ç«¯éªŒè¯
# - å®Œå…¨å…³é—­ App åé‡æ–°æ‰“å¼€
# - è¿›å…¥ä¹¦ç±è¯¦æƒ…é¡µæŸ¥çœ‹ä½œè€…å
```
